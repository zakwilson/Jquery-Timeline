/*

 Underscore.js 1.1.4
 (c) 2011 Jeremy Ashkenas, DocumentCloud Inc.
 Underscore is freely distributable under the MIT license.
 Portions of Underscore are inspired or borrowed from Prototype,
 Oliver Steele's Functional, and John Resig's Micro-Templating.
 For all details and documentation:
 http://documentcloud.github.com/underscore
*/
(function(){var i=this,w=i._,q={},h=Array.prototype,s=Object.prototype,c=h.slice,p=h.unshift,n=s.toString,g=s.hasOwnProperty,l=h.forEach,a=h.map,d=h.reduce,e=h.reduceRight,K=h.filter,o=h.every,M=h.some,z=h.indexOf,D=h.lastIndexOf,s=Array.isArray,H=Object.keys,f=function(f){return new j(f)};"undefined"!==typeof module&&module.exports?(module.exports=f,f._=f):i._=f;f.VERSION="1.1.4";var A=f.each=f.forEach=function(a,j,d){if(null!=a)if(l&&a.forEach===l)a.forEach(j,d);else if(f.isNumber(a.length))for(var c=
0,e=a.length;c<e&&!(j.call(d,a[c],c,a)===q);c++);else for(c in a)if(g.call(a,c)&&j.call(d,a[c],c,a)===q)break};f.map=function(f,j,d){var c=[];if(null==f)return c;if(a&&f.map===a)return f.map(j,d);A(f,function(f,a,u){c[c.length]=j.call(d,f,a,u)});return c};f.reduce=f.foldl=f.inject=function(a,j,c,e){var i=void 0!==c;null==a&&(a=[]);if(d&&a.reduce===d)return e&&(j=f.bind(j,e)),i?a.reduce(j,c):a.reduce(j);A(a,function(f,a,u){!i&&0===a?(c=f,i=!0):c=j.call(e,c,f,a,u)});if(!i)throw new TypeError("Reduce of empty array with no initial value");
return c};f.reduceRight=f.foldr=function(a,j,d,c){null==a&&(a=[]);if(e&&a.reduceRight===e)return c&&(j=f.bind(j,c)),void 0!==d?a.reduceRight(j,d):a.reduceRight(j);a=(f.isArray(a)?a.slice():f.toArray(a)).reverse();return f.reduce(a,j,d,c)};f.find=f.detect=function(f,a,j){var d;I(f,function(f,u,c){if(a.call(j,f,u,c))return d=f,!0});return d};f.filter=f.select=function(f,a,j){var d=[];if(null==f)return d;if(K&&f.filter===K)return f.filter(a,j);A(f,function(f,u,c){a.call(j,f,u,c)&&(d[d.length]=f)});return d};
f.reject=function(f,a,j){var d=[];if(null==f)return d;A(f,function(f,u,c){a.call(j,f,u,c)||(d[d.length]=f)});return d};f.every=f.all=function(a,j,d){var j=j||f.identity,c=!0;if(null==a)return c;if(o&&a.every===o)return a.every(j,d);A(a,function(f,a,u){if(!(c=c&&j.call(d,f,a,u)))return q});return c};var I=f.some=f.any=function(a,j,d){var j=j||f.identity,c=!1;if(null==a)return c;if(M&&a.some===M)return a.some(j,d);A(a,function(f,a,u){if(c=j.call(d,f,a,u))return q});return c};f.include=f.contains=function(f,
a){var j=!1;if(null==f)return j;if(z&&f.indexOf===z)return-1!=f.indexOf(a);I(f,function(f){if(j=f===a)return!0});return j};f.invoke=function(a,j){var d=c.call(arguments,2);return f.map(a,function(f){return(j?f[j]:f).apply(f,d)})};f.pluck=function(a,j){return f.map(a,function(f){return f[j]})};f.max=function(a,j,d){if(!j&&f.isArray(a))return Math.max.apply(Math,a);var c={computed:-Infinity};A(a,function(f,a,u){a=j?j.call(d,f,a,u):f;a>=c.computed&&(c={value:f,computed:a})});return c.value};f.min=function(a,
j,d){if(!j&&f.isArray(a))return Math.min.apply(Math,a);var c={computed:Infinity};A(a,function(f,a,u){a=j?j.call(d,f,a,u):f;a<c.computed&&(c={value:f,computed:a})});return c.value};f.sortBy=function(a,j,d){return f.pluck(f.map(a,function(f,a,c){return{value:f,criteria:j.call(d,f,a,c)}}).sort(function(f,a){var j=f.criteria,d=a.criteria;return j<d?-1:j>d?1:0}),"value")};f.sortedIndex=function(a,j,d){for(var d=d||f.identity,c=0,e=a.length;c<e;){var i=c+e>>1;d(a[i])<d(j)?c=i+1:e=i}return c};f.toArray=
function(a){return!a?[]:a.toArray?a.toArray():f.isArray(a)?a:f.isArguments(a)?c.call(a):f.values(a)};f.size=function(a){return f.toArray(a).length};f.first=f.head=function(f,a,j){return a&&!j?c.call(f,0,a):f[0]};f.rest=f.tail=function(a,j,d){return c.call(a,f.isUndefined(j)||d?1:j)};f.last=function(f){return f[f.length-1]};f.compact=function(a){return f.filter(a,function(f){return!!f})};f.flatten=function(a){return f.reduce(a,function(a,j){if(f.isArray(j))return a.concat(f.flatten(j));a[a.length]=
j;return a},[])};f.without=function(a){var j=c.call(arguments,1);return f.filter(a,function(a){return!f.include(j,a)})};f.uniq=f.unique=function(a,j){return f.reduce(a,function(a,d,c){if(0==c||(!0===j?f.last(a)!=d:!f.include(a,d)))a[a.length]=d;return a},[])};f.intersect=function(a){var j=c.call(arguments,1);return f.filter(f.uniq(a),function(a){return f.every(j,function(j){return 0<=f.indexOf(j,a)})})};f.zip=function(){for(var a=c.call(arguments),j=f.max(f.pluck(a,"length")),d=Array(j),e=0;e<j;e++)d[e]=
f.pluck(a,""+e);return d};f.indexOf=function(a,j,d){if(null==a)return-1;if(d)return d=f.sortedIndex(a,j),a[d]===j?d:-1;if(z&&a.indexOf===z)return a.indexOf(j);for(var d=0,c=a.length;d<c;d++)if(a[d]===j)return d;return-1};f.lastIndexOf=function(a,f){if(null==a)return-1;if(D&&a.lastIndexOf===D)return a.lastIndexOf(f);for(var j=a.length;j--;)if(a[j]===f)return j;return-1};f.range=function(a,f,j){for(var d=c.call(arguments),e=1>=d.length,a=e?0:d[0],f=e?d[0]:d[1],j=d[2]||1,d=Math.max(Math.ceil((f-a)/j),
0),e=0,i=Array(d);e<d;)i[e++]=a,a+=j;return i};f.bind=function(a,f){var j=c.call(arguments,2);return function(){return a.apply(f||{},j.concat(c.call(arguments)))}};f.bindAll=function(a){var j=c.call(arguments,1);0==j.length&&(j=f.functions(a));A(j,function(j){a[j]=f.bind(a[j],a)});return a};f.memoize=function(a,j){var d={},j=j||f.identity;return function(){var f=j.apply(this,arguments);return f in d?d[f]:d[f]=a.apply(this,arguments)}};f.delay=function(a,f){var j=c.call(arguments,2);return setTimeout(function(){return a.apply(a,
j)},f)};f.defer=function(a){return f.delay.apply(f,[a,1].concat(c.call(arguments,1)))};var r=function(a,f,j){var d;return function(){var c=this,e=arguments,i=function(){d=null;a.apply(c,e)};j&&clearTimeout(d);if(j||!d)d=setTimeout(i,f)}};f.throttle=function(a,f){return r(a,f,!1)};f.debounce=function(a,f){return r(a,f,!0)};f.wrap=function(a,f){return function(){var j=[a].concat(c.call(arguments));return f.apply(this,j)}};f.compose=function(){var a=c.call(arguments);return function(){for(var f=c.call(arguments),
j=a.length-1;0<=j;j--)f=[a[j].apply(this,f)];return f[0]}};f.keys=H||function(a){if(f.isArray(a))return f.range(0,a.length);var j=[],d;for(d in a)g.call(a,d)&&(j[j.length]=d);return j};f.values=function(a){return f.map(a,f.identity)};f.functions=f.methods=function(a){return f.filter(f.keys(a),function(j){return f.isFunction(a[j])}).sort()};f.extend=function(a){A(c.call(arguments,1),function(f){for(var j in f)a[j]=f[j]});return a};f.clone=function(a){return f.isArray(a)?a.slice():f.extend({},a)};f.tap=
function(a,f){f(a);return a};f.isEqual=function(a,j){if(a===j)return!0;var d=typeof a;if(d!=typeof j)return!1;if(a==j)return!0;if(!a&&j||a&&!j)return!1;if(a._chain)a=a._wrapped;if(j._chain)j=j._wrapped;if(a.isEqual)return a.isEqual(j);if(f.isDate(a)&&f.isDate(j))return a.getTime()===j.getTime();if(f.isNaN(a)&&f.isNaN(j))return!1;if(f.isRegExp(a)&&f.isRegExp(j))return a.source===j.source&&a.global===j.global&&a.ignoreCase===j.ignoreCase&&a.multiline===j.multiline;if("object"!==d||a.length&&a.length!==
j.length)return!1;var d=f.keys(a),c=f.keys(j);if(d.length!=c.length)return!1;for(var e in a)if(!(e in j)||!f.isEqual(a[e],j[e]))return!1;return!0};f.isEmpty=function(a){if(f.isArray(a)||f.isString(a))return 0===a.length;for(var j in a)if(g.call(a,j))return!1;return!0};f.isElement=function(a){return!!(a&&1==a.nodeType)};f.isArray=s||function(a){return"[object Array]"===n.call(a)};f.isArguments=function(a){return!(!a||!g.call(a,"callee"))};f.isFunction=function(a){return!(!a||!a.constructor||!a.call||
!a.apply)};f.isString=function(a){return!!(""===a||a&&a.charCodeAt&&a.substr)};f.isNumber=function(a){return!!(0===a||a&&a.toExponential&&a.toFixed)};f.isNaN=function(a){return a!==a};f.isBoolean=function(a){return!0===a||!1===a};f.isDate=function(a){return!(!a||!a.getTimezoneOffset||!a.setUTCFullYear)};f.isRegExp=function(a){return!(!a||!a.test||!a.exec||!(a.ignoreCase||!1===a.ignoreCase))};f.isNull=function(a){return null===a};f.isUndefined=function(a){return void 0===a};f.noConflict=function(){i._=
w;return this};f.identity=function(a){return a};f.times=function(a,f,j){for(var d=0;d<a;d++)f.call(j,d)};f.mixin=function(a){A(f.functions(a),function(j){B(j,f[j]=a[j])})};var y=0;f.uniqueId=function(a){var f=y++;return a?a+f:f};f.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g};f.template=function(a,j){var d=f.templateSettings,d="var __p=[],print=function(){__p.push.apply(__p,arguments);};with(obj||{}){__p.push('"+a.replace(/\\/g,"\\\\").replace(/'/g,"\\'").replace(d.interpolate,
function(a,f){return"',"+f.replace(/\\'/g,"'")+",'"}).replace(d.evaluate||null,function(a,f){return"');"+f.replace(/\\'/g,"'").replace(/[\r\n\t]/g," ")+"__p.push('"}).replace(/\r/g,"\\r").replace(/\n/g,"\\n").replace(/\t/g,"\\t")+"');}return __p.join('');",d=new Function("obj",d);return j?d(j):d};var j=function(a){this._wrapped=a};f.prototype=j.prototype;var C=function(a,j){return j?f(a).chain():a},B=function(a,d){j.prototype[a]=function(){var a=c.call(arguments);p.call(a,this._wrapped);return C(d.apply(f,
a),this._chain)}};f.mixin(f);A("pop,push,reverse,shift,sort,splice,unshift".split(","),function(a){var f=h[a];j.prototype[a]=function(){f.apply(this._wrapped,arguments);return C(this._wrapped,this._chain)}});A(["concat","join","slice"],function(a){var f=h[a];j.prototype[a]=function(){return C(f.apply(this._wrapped,arguments),this._chain)}});j.prototype.chain=function(){this._chain=!0;return this};j.prototype.value=function(){return this._wrapped}})();(function(){var i=this,w=i.Backbone,q;q="undefined"!==typeof exports?exports:i.Backbone={};q.VERSION="0.5.1";var h=i._;if(!h&&"undefined"!==typeof require)h=require("underscore")._;var s=i.jQuery||i.Zepto;q.noConflict=function(){i.Backbone=w;return this};q.emulateHTTP=!1;q.emulateJSON=!1;q.Events={bind:function(a,d){var c=this._callbacks||(this._callbacks={});(c[a]||(c[a]=[])).push(d);return this},unbind:function(a,d){var c;if(a){if(c=this._callbacks)if(d){c=c[a];if(!c)return this;for(var e=0,i=c.length;e<
i;e++)if(d===c[e]){c[e]=null;break}}else c[a]=[]}else this._callbacks={};return this},trigger:function(a){var d,c,e,i,j=2;if(!(c=this._callbacks))return this;for(;j--;)if(d=j?a:"all",d=c[d])for(var g=0,B=d.length;g<B;g++)(e=d[g])?(i=j?Array.prototype.slice.call(arguments,1):arguments,e.apply(this,i)):(d.splice(g,1),g--,B--);return this}};q.Model=function(a,d){var c;a||(a={});if(c=this.defaults)h.isFunction(c)&&(c=c()),a=h.extend({},c,a);this.attributes={};this._escapedAttributes={};this.cid=h.uniqueId("c");
this.set(a,{silent:!0});this._changed=!1;this._previousAttributes=h.clone(this.attributes);if(d&&d.collection)this.collection=d.collection;this.initialize(a,d)};h.extend(q.Model.prototype,q.Events,{_previousAttributes:null,_changed:!1,idAttribute:"id",initialize:function(){},toJSON:function(){return h.clone(this.attributes)},get:function(a){return this.attributes[a]},escape:function(a){var d;if(d=this._escapedAttributes[a])return d;d=this.attributes[a];return this._escapedAttributes[a]=(null==d?"":
""+d).replace(/&(?!\w+;|#\d+;|#x[\da-f]+;)/gi,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27").replace(/\//g,"&#x2F;")},has:function(a){return null!=this.attributes[a]},set:function(a,d){d||(d={});if(!a)return this;if(a.attributes)a=a.attributes;var c=this.attributes,e=this._escapedAttributes;if(!d.silent&&this.validate&&!this._performValidation(a,d))return!1;if(this.idAttribute in a)this.id=a[this.idAttribute];var i=this._changing;this._changing=!0;
for(var j in a){var g=a[j];if(!h.isEqual(c[j],g))c[j]=g,delete e[j],this._changed=!0,d.silent||this.trigger("change:"+j,this,g,d)}!i&&!d.silent&&this._changed&&this.change(d);this._changing=!1;return this},unset:function(a,d){if(!(a in this.attributes))return this;d||(d={});var c={};c[a]=void 0;if(!d.silent&&this.validate&&!this._performValidation(c,d))return!1;delete this.attributes[a];delete this._escapedAttributes[a];a==this.idAttribute&&delete this.id;this._changed=!0;d.silent||(this.trigger("change:"+
a,this,void 0,d),this.change(d));return this},clear:function(a){a||(a={});var d,c=this.attributes,e={};for(d in c)e[d]=void 0;if(!a.silent&&this.validate&&!this._performValidation(e,a))return!1;this.attributes={};this._escapedAttributes={};this._changed=!0;if(!a.silent){for(d in c)this.trigger("change:"+d,this,void 0,a);this.change(a)}return this},fetch:function(a){a||(a={});var d=this,c=a.success;a.success=function(e,i,j){if(!d.set(d.parse(e,j),a))return!1;c&&c(d,e)};a.error=H(a.error,d,a);return(this.sync||
q.sync).call(this,"read",this,a)},save:function(a,d){d||(d={});if(a&&!this.set(a,d))return!1;var c=this,e=d.success;d.success=function(a,f,i){if(!c.set(c.parse(a,i),d))return!1;e&&e(c,a,i)};d.error=H(d.error,c,d);var i=this.isNew()?"create":"update";return(this.sync||q.sync).call(this,i,this,d)},destroy:function(a){a||(a={});if(this.isNew())return this.trigger("destroy",this,this.collection,a);var d=this,c=a.success;a.success=function(e){d.trigger("destroy",d,d.collection,a);c&&c(d,e)};a.error=H(a.error,
d,a);return(this.sync||q.sync).call(this,"delete",this,a)},url:function(){var a=z(this.collection)||this.urlRoot||D();return this.isNew()?a:a+("/"==a.charAt(a.length-1)?"":"/")+encodeURIComponent(this.id)},parse:function(a){return a},clone:function(){return new this.constructor(this)},isNew:function(){return null==this.id},change:function(a){this.trigger("change",this,a);this._previousAttributes=h.clone(this.attributes);this._changed=!1},hasChanged:function(a){return a?this._previousAttributes[a]!=
this.attributes[a]:this._changed},changedAttributes:function(a){a||(a=this.attributes);var d=this._previousAttributes,c=!1,e;for(e in a)h.isEqual(d[e],a[e])||(c=c||{},c[e]=a[e]);return c},previous:function(a){return!a||!this._previousAttributes?null:this._previousAttributes[a]},previousAttributes:function(){return h.clone(this._previousAttributes)},_performValidation:function(a,d){var c=this.validate(a);return c?(d.error?d.error(this,c,d):this.trigger("error",this,c,d),!1):!0}});q.Collection=function(a,
d){d||(d={});if(d.comparator)this.comparator=d.comparator;h.bindAll(this,"_onModelEvent","_removeReference");this._reset();a&&this.reset(a,{silent:!0});this.initialize.apply(this,arguments)};h.extend(q.Collection.prototype,q.Events,{model:q.Model,initialize:function(){},toJSON:function(){return this.map(function(a){return a.toJSON()})},add:function(a,d){if(h.isArray(a))for(var c=0,e=a.length;c<e;c++)this._add(a[c],d);else this._add(a,d);return this},remove:function(a,d){if(h.isArray(a))for(var c=
0,e=a.length;c<e;c++)this._remove(a[c],d);else this._remove(a,d);return this},get:function(a){return null==a?null:this._byId[null!=a.id?a.id:a]},getByCid:function(a){return a&&this._byCid[a.cid||a]},at:function(a){return this.models[a]},sort:function(a){a||(a={});if(!this.comparator)throw Error("Cannot sort a set without a comparator");this.models=this.sortBy(this.comparator);a.silent||this.trigger("reset",this,a);return this},pluck:function(a){return h.map(this.models,function(d){return d.get(a)})},
reset:function(a,d){a||(a=[]);d||(d={});this.each(this._removeReference);this._reset();this.add(a,{silent:!0});d.silent||this.trigger("reset",this,d);return this},fetch:function(a){a||(a={});var d=this,c=a.success;a.success=function(e,i,j){d[a.add?"add":"reset"](d.parse(e,j),a);c&&c(d,e)};a.error=H(a.error,d,a);return(this.sync||q.sync).call(this,"read",this,a)},create:function(a,d){var c=this;d||(d={});a=this._prepareModel(a,d);if(!a)return!1;var e=d.success;d.success=function(a,j,f){c.add(a,d);
e&&e(a,j,f)};a.save(null,d);return a},parse:function(a){return a},chain:function(){return h(this.models).chain()},_reset:function(){this.length=0;this.models=[];this._byId={};this._byCid={}},_prepareModel:function(a,d){if(a instanceof q.Model){if(!a.collection)a.collection=this}else{var c=a,a=new this.model(c,{collection:this});a.validate&&!a._performValidation(c,d)&&(a=!1)}return a},_add:function(a,d){d||(d={});a=this._prepareModel(a,d);if(!a)return!1;var c=this.getByCid(a)||this.get(a);if(c)throw Error(["Can't add the same model to a set twice",
c.id]);this._byId[a.id]=a;this._byCid[a.cid]=a;this.models.splice(null!=d.at?d.at:this.comparator?this.sortedIndex(a,this.comparator):this.length,0,a);a.bind("all",this._onModelEvent);this.length++;d.silent||a.trigger("add",a,this,d);return a},_remove:function(a,d){d||(d={});a=this.getByCid(a)||this.get(a);if(!a)return null;delete this._byId[a.id];delete this._byCid[a.cid];this.models.splice(this.indexOf(a),1);this.length--;d.silent||a.trigger("remove",a,this,d);this._removeReference(a);return a},
_removeReference:function(a){this==a.collection&&delete a.collection;a.unbind("all",this._onModelEvent)},_onModelEvent:function(a,d,c,e){("add"==a||"remove"==a)&&c!=this||("destroy"==a&&this._remove(d,e),d&&a==="change:"+d.idAttribute&&(delete this._byId[d.previous(d.idAttribute)],this._byId[d.id]=d),this.trigger.apply(this,arguments))}});h.each("forEach,each,map,reduce,reduceRight,find,detect,filter,select,reject,every,all,some,any,include,contains,invoke,max,min,sortBy,sortedIndex,toArray,size,first,rest,last,without,indexOf,lastIndexOf,isEmpty".split(","),
function(a){q.Collection.prototype[a]=function(){return h[a].apply(h,[this.models].concat(h.toArray(arguments)))}});q.Router=function(a){a||(a={});if(a.routes)this.routes=a.routes;this._bindRoutes();this.initialize.apply(this,arguments)};var c=/:([\w\d]+)/g,p=/\*([\w\d]+)/g,n=/[-[\]{}()+?.,\\^$|#\s]/g;h.extend(q.Router.prototype,q.Events,{initialize:function(){},route:function(a,d,c){q.history||(q.history=new q.History);h.isRegExp(a)||(a=this._routeToRegExp(a));q.history.route(a,h.bind(function(e){e=
this._extractParameters(a,e);c.apply(this,e);this.trigger.apply(this,["route:"+d].concat(e))},this))},navigate:function(a,d){q.history.navigate(a,d)},_bindRoutes:function(){if(this.routes){var a=[],d;for(d in this.routes)a.unshift([d,this.routes[d]]);d=0;for(var c=a.length;d<c;d++)this.route(a[d][0],a[d][1],this[a[d][1]])}},_routeToRegExp:function(a){a=a.replace(n,"\\$&").replace(c,"([^/]*)").replace(p,"(.*?)");return RegExp("^"+a+"$")},_extractParameters:function(a,d){return a.exec(d).slice(1)}});
q.History=function(){this.handlers=[];h.bindAll(this,"checkUrl")};var g=/^#*/,l=/msie [\w.]+/,a=!1;h.extend(q.History.prototype,{interval:50,getFragment:function(a,d){if(null==a)if(this._hasPushState||d){var a=window.location.pathname,c=window.location.search;c&&(a+=c);0==a.indexOf(this.options.root)&&(a=a.substr(this.options.root.length))}else a=window.location.hash;return a.replace(g,"")},start:function(d){if(a)throw Error("Backbone.history has already been started");this.options=h.extend({},{root:"/"},
this.options,d);this._wantsPushState=!!this.options.pushState;this._hasPushState=!(!this.options.pushState||!window.history||!window.history.pushState);var d=this.getFragment(),c=document.documentMode;if(c=l.exec(navigator.userAgent.toLowerCase())&&(!c||7>=c))this.iframe=s('<iframe src="javascript:0" tabindex="-1" />').hide().appendTo("body")[0].contentWindow,this.navigate(d);this._hasPushState?s(window).bind("popstate",this.checkUrl):"onhashchange"in window&&!c?s(window).bind("hashchange",this.checkUrl):
setInterval(this.checkUrl,this.interval);this.fragment=d;a=!0;d=window.location;c=d.pathname==this.options.root;if(this._wantsPushState&&!this._hasPushState&&!c)this.fragment=this.getFragment(null,!0),window.location.replace(this.options.root+"#"+this.fragment);else if(this._wantsPushState&&this._hasPushState&&c&&d.hash)this.fragment=d.hash.replace(g,""),window.history.replaceState({},document.title,d.protocol+"//"+d.host+this.options.root+this.fragment);return this.loadUrl()},route:function(a,d){this.handlers.unshift({route:a,
callback:d})},checkUrl:function(){var a=this.getFragment();a==this.fragment&&this.iframe&&(a=this.getFragment(this.iframe.location.hash));if(a==this.fragment||a==decodeURIComponent(this.fragment))return!1;this.iframe&&this.navigate(a);this.loadUrl()||this.loadUrl(window.location.hash)},loadUrl:function(a){var d=this.fragment=this.getFragment(a);return h.any(this.handlers,function(a){if(a.route.test(d))return a.callback(d),!0})},navigate:function(a,d){var c=(a||"").replace(g,"");if(!(this.fragment==
c||this.fragment==decodeURIComponent(c))){if(this._hasPushState){var e=window.location;0!=c.indexOf(this.options.root)&&(c=this.options.root+c);this.fragment=c;window.history.pushState({},document.title,e.protocol+"//"+e.host+c)}else if(window.location.hash=this.fragment=c,this.iframe&&c!=this.getFragment(this.iframe.location.hash))this.iframe.document.open().close(),this.iframe.location.hash=c;d&&this.loadUrl(a)}}});q.View=function(a){this.cid=h.uniqueId("view");this._configure(a||{});this._ensureElement();
this.delegateEvents();this.initialize.apply(this,arguments)};var d=/^(\S+)\s*(.*)$/,e="model,collection,el,id,attributes,className,tagName".split(",");h.extend(q.View.prototype,q.Events,{tagName:"div",$:function(a){return s(a,this.el)},initialize:function(){},render:function(){return this},remove:function(){s(this.el).remove();return this},make:function(a,d,c){a=document.createElement(a);d&&s(a).attr(d);c&&s(a).html(c);return a},delegateEvents:function(a){if(a||(a=this.events))for(var c in s(this.el).unbind(".delegateEvents"+
this.cid),a){var e=this[a[c]];if(!e)throw Error('Event "'+a[c]+'" does not exist');var i=c.match(d),g=i[1],i=i[2],e=h.bind(e,this),g=g+(".delegateEvents"+this.cid);""===i?s(this.el).bind(g,e):s(this.el).delegate(i,g,e)}},_configure:function(a){this.options&&(a=h.extend({},this.options,a));for(var d=0,c=e.length;d<c;d++){var i=e[d];a[i]&&(this[i]=a[i])}this.options=a},_ensureElement:function(){if(this.el){if(h.isString(this.el))this.el=s(this.el).get(0)}else{var a=this.attributes||{};if(this.id)a.id=
this.id;if(this.className)a["class"]=this.className;this.el=this.make(this.tagName,a)}}});q.Model.extend=q.Collection.extend=q.Router.extend=q.View.extend=function(a,d){var c=M(this,a,d);c.extend=this.extend;return c};var K={create:"POST",update:"PUT","delete":"DELETE",read:"GET"};q.sync=function(a,d,c){var e=K[a],c=h.extend({type:e,dataType:"json",processData:!1},c);if(!c.url)c.url=z(d)||D();if(!c.data&&d&&("create"==a||"update"==a))c.contentType="application/json",c.data=JSON.stringify(d.toJSON());
if(q.emulateJSON)c.contentType="application/x-www-form-urlencoded",c.processData=!0,c.data=c.data?{model:c.data}:{};if(q.emulateHTTP&&("PUT"===e||"DELETE"===e)){if(q.emulateJSON)c.data._method=e;c.type="POST";c.beforeSend=function(a){a.setRequestHeader("X-HTTP-Method-Override",e)}}return s.ajax(c)};var o=function(){},M=function(a,d,c){var e;e=d&&d.hasOwnProperty("constructor")?d.constructor:function(){return a.apply(this,arguments)};h.extend(e,a);o.prototype=a.prototype;e.prototype=new o;d&&h.extend(e.prototype,
d);c&&h.extend(e,c);e.prototype.constructor=e;e.__super__=a.prototype;return e},z=function(a){return!a||!a.url?null:h.isFunction(a.url)?a.url():a.url},D=function(){throw Error('A "url" property or function must be specified');},H=function(a,d,c){return function(e){a?a(d,e,c):d.trigger("error",d,e,c)}}}).call(this);/*
 
 JavaScript Debug - v0.4 - 6/22/2010
 http://benalman.com/projects/javascript-debug-console-log/

 Copyright (c) 2010 "Cowboy" Ben Alman
 Dual licensed under the MIT and GPL licenses.
 http://benalman.com/about/license/

 With lots of help from Paul Irish!
 http://paulirish.com/
*/
window.debug=function(){function i(a){c&&(p||!h||!h.log)&&c.apply(w,a)}for(var w=this,q=Array.prototype.slice,h=w.console,s={},c,p,n=9,g=["error","warn","info","debug","log"],l="assert clear count dir dirxml exception group groupCollapsed groupEnd profile profileEnd table time timeEnd trace".split(" "),a=l.length,d=[];0<=--a;)(function(a){s[a]=function(){0!==n&&h&&h[a]&&h[a].apply(h,arguments)}})(l[a]);for(a=g.length;0<=--a;)(function(a,c){s[c]=function(){var p=q.call(arguments),l=[c].concat(p);d.push(l);
i(l);if(h&&(0<n?n>a:g.length+n<=a))h.firebug?h[c].apply(w,p):h[c]?h[c](p):h.log(p)}})(a,g[a]);s.setLevel=function(a){n="number"===typeof a?a:9};s.setCallback=function(){var a=q.call(arguments),g=d.length,h=g;c=a.shift()||null;p="boolean"===typeof a[0]?a.shift():!1;for(h-="number"===typeof a[0]?a.shift():g;h<g;)i(d[h++])};return s}();/*

 jQuery Templates Plugin 1.0.0pre
 http://github.com/jquery/jquery-tmpl
 Requires jQuery 1.4.2

 Copyright Software Freedom Conservancy, Inc.
 Dual licensed under the MIT or GPL Version 2 licenses.
 http://jquery.org/license
*/
(function(i){function w(c,j,f,h){h={data:h||0===h||!1===h?h:j?j.data:{},_wrap:j?j._wrap:null,tmpl:null,parent:j||null,nodes:[],calls:g,nest:l,wrap:a,html:d,update:e};c&&i.extend(h,c,{nodes:[],parent:j});if(f)h.tmpl=f,h._ctnt=h._ctnt||h.tmpl(i,h),h.key=++A,(r.length?D:z)[A]=h;return h}function q(a,d,c){var e,c=c?i.map(c,function(d){return"string"===typeof d?a.key?d.replace(/(<\w+)(?=[\s>])(?![^>]*_tmplitem)([^>]*)/g,"$1 "+o+'="'+a.key+'" $2'):d:q(d,a,d._ctnt)}):a;if(d)return c;c=c.join("");c.replace(/^\s*([^<\s][^<]*)?(<[\w\W]+>)([^>]*[^>\s])?\s*$/,
function(a,d,j,c){e=i(j).get();n(e);d&&(e=h(d).concat(e));c&&(e=e.concat(h(c)))});return e?e:h(c)}function h(a){var d=document.createElement("div");d.innerHTML=a;return i.makeArray(d.childNodes)}function s(a){return new Function("jQuery","$item","var $=jQuery,call,__=[],$data=$item.data;with($data){__.push('"+i.trim(a).replace(/([\\'])/g,"\\$1").replace(/[\r\t\n]/g," ").replace(/\$\{([^\}]*)\}/g,"{{= $1}}").replace(/\{\{(\/?)(\w+|.)(?:\(((?:[^\}]|\}(?!\}))*?)?\))?(?:\s+(.*?)?)?(\(((?:[^\}]|\}(?!\}))*?)\))?\s*\}\}/g,
function(a,d,c,e,f,g,y){a=i.tmpl.tag[c];if(!a)throw"Unknown template tag: "+c;c=a._default||[];g&&!/\w$/.test(f)&&(f+=g,g="");f?(f=p(f),y=y?","+p(y)+")":g?")":"",y=g?-1<f.indexOf(".")?f+p(g):"("+f+").call($item"+y:f,g=g?y:"(typeof("+f+")==='function'?("+f+").call($item):("+f+"))"):g=y=c.$1||"null";e=p(e);return"');"+a[d?"close":"open"].split("$notnull_1").join(f?"typeof("+f+")!=='undefined' && ("+f+")!=null":"true").split("$1a").join(g).split("$1").join(y).split("$2").join(e||c.$2||"")+"__.push('"})+
"');}return __;")}function c(a,d){a._wrap=q(a,!0,i.isArray(d)?d:[M.test(d)?d:i(d).html()]).join("")}function p(a){return a?a.replace(/\\'/g,"'").replace(/\\\\/g,"\\"):null}function n(a){function d(a){function j(a){var k;a+=c;k=g[a]=g[a]||w(y,z[y.parent.key+c]||y.parent),y=k}var e,f=a,y,h;if(h=a.getAttribute(o)){for(;f.parentNode&&1===(f=f.parentNode).nodeType&&!(e=f.getAttribute(o)););if(e!==h){f=f.parentNode?11===f.nodeType?0:f.getAttribute(o)||0:0;if(!(y=z[h]))y=D[h],y=w(y,z[f]||D[f]),y.key=++A,
z[A]=y;I&&j(h)}a.removeAttribute(o)}else if(I&&(y=i.data(a,"tmplItem")))j(y.key),z[y.key]=y,f=(f=i.data(a.parentNode,"tmplItem"))?f.key:0;if(y){for(e=y;e&&e.key!=f;)e.nodes.push(a),e=e.parent;delete y._ctnt;delete y._wrap;i.data(a,"tmplItem",y)}}var c="_"+I,e,f,g={},h,p,r;for(h=0,p=a.length;h<p;h++)if(1===(e=a[h]).nodeType){f=e.getElementsByTagName("*");for(r=f.length-1;0<=r;r--)d(f[r]);d(e)}}function g(a,d,c,e){if(!a)return r.pop();r.push({_:a,tmpl:d,item:this,data:c,options:e})}function l(a,d,c){return i.tmpl(i.template(a),
d,c,this)}function a(a,d){var c=a.options||{};c.wrapped=d;return i.tmpl(i.template(a.tmpl),a.data,c,a.item)}function d(a,d){var c=this._wrap;return i.map(i(i.isArray(c)?c.join(""):c).filter(a||"*"),function(a){if(d)a=a.innerText||a.textContent;else{var c;if(!(c=a.outerHTML))c=document.createElement("div"),c.appendChild(a.cloneNode(!0)),c=c.innerHTML;a=c}return a})}function e(){var a=this.nodes;i.tmpl(null,null,null,this).insertBefore(a[0]);i(a).remove()}var K=i.fn.domManip,o="_tmplitem",M=/^[^<]*(<[\w\W]+>)[^>]*$|\{\{\! /,
z={},D={},H,f={key:0,data:{}},A=0,I=0,r=[];i.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(a,d){i.fn[a]=function(c){var e=[],c=i(c),f,g,h;f=1===this.length&&this[0].parentNode;H=z||{};if(f&&11===f.nodeType&&1===f.childNodes.length&&1===c.length)c[d](this[0]),e=this;else{for(g=0,h=c.length;g<h;g++)I=g,f=(0<g?this.clone(!0):this).get(),i(c[g])[d](f),e=e.concat(f);I=0;e=this.pushStack(e,a,c.selector)}c=H;H=null;i.tmpl.complete(c);
return e}});i.fn.extend({tmpl:function(a,d,c){return i.tmpl(this[0],a,d,c)},tmplItem:function(){return i.tmplItem(this[0])},template:function(a){return i.template(a,this[0])},domManip:function(a,d,c,e){if(a[0]&&i.isArray(a[0])){for(var f=i.makeArray(arguments),g=a[0],h=g.length,r=0,p;r<h&&!(p=i.data(g[r++],"tmplItem")););p&&I&&(f[2]=function(a){i.tmpl.afterManip(this,a,c)});K.apply(this,f)}else K.apply(this,arguments);I=0;H||i.tmpl.complete(z);return this}});i.extend({tmpl:function(a,d,e,g){var h=
!g;if(h)g=f,a=i.template[a]||i.template(null,a),D={};else if(!a)return a=g.tmpl,z[g.key]=g,g.nodes=[],g.wrapped&&c(g,g.wrapped),i(q(g,null,g.tmpl(i,g)));if(!a)return[];"function"===typeof d&&(d=d.call(g||{}));e&&e.wrapped&&c(e,e.wrapped);d=i.isArray(d)?i.map(d,function(d){return d?w(e,g,a,d):null}):[w(e,g,a,d)];return h?i(q(g,null,d)):d},tmplItem:function(a){var d;for(a instanceof i&&(a=a[0]);a&&1===a.nodeType&&!(d=i.data(a,"tmplItem"))&&(a=a.parentNode););return d||f},template:function(a,d){return d?
("string"===typeof d?d=s(d):d instanceof i&&(d=d[0]||{}),d.nodeType&&(d=i.data(d,"tmpl")||i.data(d,"tmpl",s(d.innerHTML))),"string"===typeof a?i.template[a]=d:d):a?"string"!==typeof a?i.template(null,a):i.template[a]||i.template(null,M.test(a)?a:i(a)):null},encode:function(a){return(""+a).split("<").join("&lt;").split(">").join("&gt;").split('"').join("&#34;").split("'").join("&#39;")}});i.extend(i.tmpl,{tag:{tmpl:{_default:{$2:"null"},open:"if($notnull_1){__=__.concat($item.nest($1,$2));}"},wrap:{_default:{$2:"null"},
open:"$item.calls(__,$1,$2);__=[];",close:"call=$item.calls();__=call._.concat($item.wrap(call,__));"},each:{_default:{$2:"$index, $value"},open:"if($notnull_1){$.each($1a,function($2){with(this){",close:"}});}"},"if":{open:"if(($notnull_1) && $1a){",close:"}"},"else":{_default:{$1:"true"},open:"}else if(($notnull_1) && $1a){"},html:{open:"if($notnull_1){__.push($1a);}"},"=":{_default:{$1:"$data"},open:"if($notnull_1){__.push($.encode($1a));}"},"!":{open:""}},complete:function(){z={}},afterManip:function(a,
d,c){var e=11===d.nodeType?i.makeArray(d.childNodes):1===d.nodeType?[d]:[];c.call(a,d);n(e);I++}})})(jQuery);/*

 Copyright (c) 2010 Brandon Aaron (http://brandonaaron.net)
 Licensed under the MIT License (LICENSE.txt).

 Thanks to: http://adomas.org/javascript-mouse-wheel/ for some pointers.
 Thanks to: Mathias Bank(http://www.mathias-bank.de) for a scope bug fix.
 Thanks to: Seamus Leahy for adding deltaX and deltaY

 Version: 3.0.4

 Requires: 1.2.2+
*/
(function(i){function w(h){var q=h||window.event,c=[].slice.call(arguments,1),p=0,n=0,g=0,h=i.event.fix(q);h.type="mousewheel";h.wheelDelta&&(p=h.wheelDelta/120);h.detail&&(p=-h.detail/3);g=p;void 0!==q.axis&&q.axis===q.HORIZONTAL_AXIS&&(g=0,n=-1*p);void 0!==q.wheelDeltaY&&(g=q.wheelDeltaY/120);void 0!==q.wheelDeltaX&&(n=-1*q.wheelDeltaX/120);c.unshift(h,p,n,g);return i.event.handle.apply(this,c)}var q=["DOMMouseScroll","mousewheel"];i.event.special.mousewheel={setup:function(){if(this.addEventListener)for(var i=
q.length;i;)this.addEventListener(q[--i],w,!1);else this.onmousewheel=w},teardown:function(){if(this.removeEventListener)for(var i=q.length;i;)this.removeEventListener(q[--i],w,!1);else this.onmousewheel=null}};i.fn.extend({mousewheel:function(i){return i?this.bind("mousewheel",i):this.trigger("mousewheel")},unmousewheel:function(i){return this.unbind("mousewheel",i)}})})(jQuery);/*

 jQuery.UI.iPad plugin
 Copyright (c) 2010 Stephen von Takach
 licensed under MIT.
 Date: 27/8/2010

 Project Home: 
 http://code.google.com/p/jquery-ui-for-ipad-and-iphone/
*/
(function(i){function w(){g&&(window.clearTimeout(a),g=!1,l=null)}function q(c){g||(g=!0,l=c.changedTouches[0],a=window.setTimeout(function(){g=!1;var a=l,c=document.createEvent("MouseEvent");c.initMouseEvent("mouseup",!0,!0,window,1,a.screenX,a.screenY,a.clientX,a.clientY,!1,!1,!1,!1,0,null);a.target.dispatchEvent(c);c=document.createEvent("MouseEvent");c.initMouseEvent("mousedown",!0,!0,window,1,a.screenX,a.screenY,a.clientX,a.clientY,!1,!1,!1,!1,2,null);a.target.dispatchEvent(c);c=document.createEvent("MouseEvent");
c.initMouseEvent("contextmenu",!0,!0,window,1,a.screenX+50,a.screenY+5,a.clientX+50,a.clientY+5,!1,!1,!1,!1,2,null);a.target.dispatchEvent(c);d=!0;l=null},800))}function h(a){var d=a.changedTouches[0],g="mouseover",i=document.createEvent("MouseEvent");i.initMouseEvent(g,!0,!0,window,1,d.screenX,d.screenY,d.clientX,d.clientY,!1,!1,!1,!1,0,null);d.target.dispatchEvent(i);g="mousedown";i=document.createEvent("MouseEvent");i.initMouseEvent(g,!0,!0,window,1,d.screenX,d.screenY,d.clientX,d.clientY,!1,!1,
!1,!1,0,null);d.target.dispatchEvent(i);p?(window.clearTimeout(n),d.target==c?(c=null,p=!1,g="click",i=document.createEvent("MouseEvent"),i.initMouseEvent(g,!0,!0,window,1,d.screenX,d.screenY,d.clientX,d.clientY,!1,!1,!1,!1,0,null),d.target.dispatchEvent(i),g="dblclick",i=document.createEvent("MouseEvent"),i.initMouseEvent(g,!0,!0,window,1,d.screenX,d.screenY,d.clientX,d.clientY,!1,!1,!1,!1,0,null),d.target.dispatchEvent(i)):(c=d.target,p=!0,n=window.setTimeout(function(){p=!1},600),q(a))):(c=d.target,
p=!0,n=window.setTimeout(function(){p=!1},600),q(a))}function s(a){var g="";if(!(1<a.touches.length)){switch(a.type){case "gesturestart":alert("gesturestart");a.preventDefault();break;case "touchstart":if(i(a.changedTouches[0].target).is("select"))return;h(a);a.preventDefault();return!1;case "touchmove":w();g="mousemove";a.preventDefault();break;case "touchend":if(d)return d=!1,a.preventDefault(),!1;w();g="mouseup";break;default:return}var a=a.changedTouches[0],l=document.createEvent("MouseEvent");
l.initMouseEvent(g,!0,!0,window,1,a.screenX,a.screenY,a.clientX,a.clientY,!1,!1,!1,!1,0,null);a.target.dispatchEvent(l);"mouseup"==g&&p&&a.target==c&&(l=document.createEvent("MouseEvent"),l.initMouseEvent("click",!0,!0,window,1,a.screenX,a.screenY,a.clientX,a.clientY,!1,!1,!1,!1,0,null),a.target.dispatchEvent(l))}}i.extend(i.support,{touch:"object"==typeof Touch});i.fn.addTouch=function(){i.support.touch&&this.each(function(a,d){d.addEventListener("touchstart",s,!1);d.addEventListener("touchmove",
s,!1);d.addEventListener("touchend",s,!1);d.addEventListener("touchcancel",s,!1)})};var c=null,p=!1,n=null,g=!1,l=null,a=null,d=!1})(jQuery);/*

 Raphael 1.5.2 - JavaScript Vector Library

 Copyright (c) 2010 Dmitry Baranovskiy (http://raphaeljs.com)
 Licensed under the MIT (http://raphaeljs.com/license.html) license.
*/
(function(){function i(){if(i.is(arguments[0],Y)){for(var x=arguments[0],d=wa[D](i,x.splice(0,3+i.is(x[0],U))),v=d.set(),c=0,ka=x[j];c<ka;c++){var k=x[c]||{};n[a](k.type)&&v[F](d[k.type]().attr(k))}return v}return wa[D](i,arguments)}function w(){for(var a=[],d=0;32>d;d++)a[d]=(~~(16*B.random()))[da](16);a[12]=4;a[16]=(a[16]&3|8)[da](16);return"r-"+a[y]("")}function q(x,d,v){function c(){var ka=Array[l].slice.call(arguments,0),k=ka[y]("\u25ba"),e=c.cache=c.cache||{},f=c.count=c.count||[];if(e[a](k))return v?
v(e[k]):e[k];1E3<=f[j]&&delete e[f.shift()];f[F](k);e[k]=x[D](d,ka);return v?v(e[k]):e[k]}return c}function h(){return this.x+f+this.y}function s(a){return function(d,v,c,j){var k={back:a};i.is(c,"function")?j=c:k.rot=c;d&&d.constructor==S&&(d=d.attrs.path);d&&(k.along=d);return this.animate(k,v,j)}}function c(a,d,v,c,j,k){function e(a,x){var d,W,v,c;for(v=a,W=0;8>W;W++){c=((i*v+g)*v+f)*v-a;if(T(c)<x)return v;d=(3*i*v+2*g)*v+f;if(1.0E-6>T(d))break;v-=c/d}d=0;W=1;v=a;if(v<d)return d;if(v>W)return W;
for(;d<W;){c=((i*v+g)*v+f)*v;if(T(c-a)<x)break;a>c?d=v:W=v;v=(W-d)/2+d}return v}var f=3*d,g=3*(c-d)-f,i=1-f-g,h=3*v,r=3*(j-v)-h,p=1-h-r;return function(a,x){var d=e(a,x);return((p*d+r)*d+h)*d}(a,1/(200*k))}i.version="1.5.2";var p=/[, ]+/,n={circle:1,rect:1,path:1,ellipse:1,text:1,image:1},g=/\{(\d+)\}/g,l="prototype",a="hasOwnProperty",d=document,e=window,K=Object[l][a].call(e,"Raphael"),o=e.Raphael,M=function(){this.customAttributes={}},z,D="apply",H="createTouch"in d,f=" ",A=String,I="click dblclick mousedown mousemove mouseout mouseover mouseup touchstart touchmove touchend orientationchange touchcancel gesturestart gesturechange gestureend".split(f),
r={mousedown:"touchstart",mousemove:"touchmove",mouseup:"touchend"},y="join",j="length",C=A[l].toLowerCase,B=Math,u=B.max,O=B.min,T=B.abs,P=B.pow,V=B.PI,U="number",Y="array",da="toString",jb=Object[l][da],F="push",La=/^url\(['"]?([^\)]+?)['"]?\)$/i,R=/^\s*((#[a-f\d]{6})|(#[a-f\d]{3})|rgba?\(\s*([\d\.]+%?\s*,\s*[\d\.]+%?\s*,\s*[\d\.]+(?:%?\s*,\s*[\d\.]+)?)%?\s*\)|hsba?\(\s*([\d\.]+(?:deg|\xb0|%)?\s*,\s*[\d\.]+%?\s*,\s*[\d\.]+(?:%?\s*,\s*[\d\.]+)?)%?\s*\)|hsla?\(\s*([\d\.]+(?:deg|\xb0|%)?\s*,\s*[\d\.]+%?\s*,\s*[\d\.]+(?:%?\s*,\s*[\d\.]+)?)%?\s*\))\s*$/i,
Z={NaN:1,Infinity:1,"-Infinity":1},L=/^(?:cubic-)?bezier\(([^,]+),([^,]+),([^,]+),([^\)]+)\)/,G=B.round,J=parseFloat,$=parseInt,la=A[l].toUpperCase,ma={blur:0,"clip-rect":"0 0 1e9 1e9",cursor:"default",cx:0,cy:0,fill:"#fff","fill-opacity":1,font:'10px "Arial"',"font-family":'"Arial"',"font-size":"10","font-style":"normal","font-weight":400,gradient:0,height:0,href:"http://raphaeljs.com/",opacity:1,path:"M0,0",r:0,rotation:0,rx:0,ry:0,scale:"1 1",src:"",stroke:"#000","stroke-dasharray":"","stroke-linecap":"butt",
"stroke-linejoin":"butt","stroke-miterlimit":0,"stroke-opacity":1,"stroke-width":1,target:"_blank","text-anchor":"middle",title:"Raphael",translation:"0 0",width:0,x:0,y:0},ya={along:"along",blur:U,"clip-rect":"csv",cx:U,cy:U,fill:"colour","fill-opacity":U,"font-size":U,height:U,opacity:U,path:"path",r:U,rotation:"csv",rx:U,ry:U,scale:"csv",stroke:"colour","stroke-opacity":U,"stroke-width":U,translation:"csv",width:U,x:U,y:U},kb=/^(from|to|\d+%?)$/,za=/\s*,\s*/,lb={hs:1,rg:1},mb=/,?([achlmqrstvxz]),?/gi,
nb=/([achlmqstvz])[\s,]*((-?\d*\.?\d*(?:e[-+]?\d+)?\s*,?\s*)+)/ig,ob=/(-?\d*\.?\d*(?:e[-+]?\d+)?)\s*,?\s*/ig,Ma=/^r(?:\(([^,]+?)\s*,\s*([^\)]+?)\))?/,pb=function(a,d){return a.key-d.key};i.type=e.SVGAngle||d.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#BasicStructure","1.1")?"SVG":"VML";if("VML"==i.type){var Aa=d.createElement("div"),na;Aa.innerHTML='<v:shape adj="1"/>';na=Aa.firstChild;na.style.behavior="url(#default#VML)";if(!(na&&"object"==typeof na.adj))return i.type=null;Aa=
null}i.svg=!(i.vml="VML"==i.type);M[l]=i[l];z=M[l];i._id=0;i._oid=0;i.fn={};i.is=function(x,d){d=C.call(d);return"finite"==d?!Z[a](+x):"null"==d&&null===x||d==typeof x||"object"==d&&x===Object(x)||"array"==d&&Array.isArray&&Array.isArray(x)||jb.call(x).slice(8,-1).toLowerCase()==d};i.angle=function(a,d,v,c,j,k){return null==j?(a-=v,d-=c,!a&&!d?0:(180*(0>a)+180*B.atan(-d/-a)/V+360)%360):i.angle(a,d,j,k)-i.angle(v,c,j,k)};i.rad=function(a){return a%360*V/180};i.deg=function(a){return 180*a/V%360};i.snapTo=
function(a,d,v){v=i.is(v,"finite")?v:10;if(i.is(a,Y))for(var c=a.length;c--;){if(T(a[c]-d)<=v)return a[c]}else{a=+a;c=d%a;if(c<v)return d-c;if(c>a-v)return d-c+a}return d};i.setWindow=function(a){e=a;d=e.document};var oa=function(a){if(i.vml){var W=/^\s+|\s+$/g,v;try{var c=new ActiveXObject("htmlfile");c.write("<body>");c.close();v=c.body}catch(j){v=createPopup().document.body}var k=v.createTextRange();oa=q(function(a){try{v.style.color=A(a).replace(W,"");var x=k.queryCommandValue("ForeColor");return"#"+
("000000"+((x&255)<<16|x&65280|(x&16711680)>>>16)[da](16)).slice(-6)}catch(d){return"none"}})}else{var e=d.createElement("i");e.title="Rapha\u00ebl Colour Picker";e.style.display="none";d.body.appendChild(e);oa=q(function(a){e.style.color=a;return d.defaultView.getComputedStyle(e,"").getPropertyValue("color")})}return oa(a)},Na=function(){return"hsb("+[this.h,this.s,this.b]+")"},qb=function(){return"hsl("+[this.h,this.s,this.l]+")"},rb=function(){return this.hex};i.hsb2rgb=function(a,d,v,c){if(i.is(a,
"object")&&"h"in a&&"s"in a&&"b"in a)v=a.b,d=a.s,a=a.h,c=a.o;return i.hsl2rgb(a,d,v/2,c)};i.hsl2rgb=function(a,d,v,c){if(i.is(a,"object")&&"h"in a&&"s"in a&&"l"in a)v=a.l,d=a.s,a=a.h;if(1<a||1<d||1<v)a/=360,d/=100,v/=100;var j={},k=["r","g","b"],e;if(d){0.5>v?e=v*(1+d):e=v+d-v*d;for(var d=2*v-e,f=0;3>f;f++)v=a+1/3*-(f-1),0>v&&v++,1<v&&v--,1>6*v?j[k[f]]=d+6*(e-d)*v:1>2*v?j[k[f]]=e:2>3*v?j[k[f]]=d+6*(e-d)*(2/3-v):j[k[f]]=d}else j={r:v,g:v,b:v};j.r*=255;j.g*=255;j.b*=255;j.hex="#"+(16777216|j.b|j.g<<
8|j.r<<16).toString(16).slice(1);i.is(c,"finite")&&(j.opacity=c);j.toString=rb;return j};i.rgb2hsb=function(a,d,v){if(null==d&&i.is(a,"object")&&"r"in a&&"g"in a&&"b"in a)v=a.b,d=a.g,a=a.r;if(null==d&&i.is(a,"string"))v=i.getRGB(a),a=v.r,d=v.g,v=v.b;if(1<a||1<d||1<v)a/=255,d/=255,v/=255;var c=u(a,d,v),j=O(a,d,v),k;if(j==c)return{h:0,s:0,b:c,toString:Na};j=c-j;a==c?k=(d-v)/j:d==c?k=2+(v-a)/j:k=4+(a-d)/j;k/=6;0>k&&k++;1<k&&k--;return{h:k,s:j/c,b:c,toString:Na}};i.rgb2hsl=function(a,d,v){if(null==d&&
i.is(a,"object")&&"r"in a&&"g"in a&&"b"in a)v=a.b,d=a.g,a=a.r;if(null==d&&i.is(a,"string"))v=i.getRGB(a),a=v.r,d=v.g,v=v.b;if(1<a||1<d||1<v)a/=255,d/=255,v/=255;var c=u(a,d,v),j=O(a,d,v),k,e=(c+j)/2;if(j==c)a={h:0,s:0,l:e};else{var f=c-j;a==c?k=(d-v)/f:d==c?k=2+(v-a)/f:k=4+(a-d)/f;k/=6;0>k&&k++;1<k&&k--;a={h:k,s:0.5>e?f/(c+j):f/(2-c-j),l:e}}a.toString=qb;return a};i._path2string=function(){return this.join(",").replace(mb,"$1")};i.getRGB=q(function(x){if(!x||(x=A(x)).indexOf("-")+1)return{r:-1,g:-1,
b:-1,hex:"none",error:1};if("none"==x)return{r:-1,g:-1,b:-1,hex:"none"};!(lb[a](x.toLowerCase().substring(0,2))||"#"==x.charAt())&&(x=oa(x));var d,c,j,e,k;if(x=x.match(R)){x[2]&&(j=$(x[2].substring(5),16),c=$(x[2].substring(3,5),16),d=$(x[2].substring(1,3),16));x[3]&&(j=$((k=x[3].charAt(3))+k,16),c=$((k=x[3].charAt(2))+k,16),d=$((k=x[3].charAt(1))+k,16));x[4]&&(k=x[4].split(za),d=J(k[0]),"%"==k[0].slice(-1)&&(d*=2.55),c=J(k[1]),"%"==k[1].slice(-1)&&(c*=2.55),j=J(k[2]),"%"==k[2].slice(-1)&&(j*=2.55),
"rgba"==x[1].toLowerCase().slice(0,4)&&(e=J(k[3])),k[3]&&"%"==k[3].slice(-1)&&(e/=100));if(x[5])return k=x[5].split(za),d=J(k[0]),"%"==k[0].slice(-1)&&(d*=2.55),c=J(k[1]),"%"==k[1].slice(-1)&&(c*=2.55),j=J(k[2]),"%"==k[2].slice(-1)&&(j*=2.55),("deg"==k[0].slice(-3)||"\u00b0"==k[0].slice(-1))&&(d/=360),"hsba"==x[1].toLowerCase().slice(0,4)&&(e=J(k[3])),k[3]&&"%"==k[3].slice(-1)&&(e/=100),i.hsb2rgb(d,c,j,e);if(x[6])return k=x[6].split(za),d=J(k[0]),"%"==k[0].slice(-1)&&(d*=2.55),c=J(k[1]),"%"==k[1].slice(-1)&&
(c*=2.55),j=J(k[2]),"%"==k[2].slice(-1)&&(j*=2.55),("deg"==k[0].slice(-3)||"\u00b0"==k[0].slice(-1))&&(d/=360),"hsla"==x[1].toLowerCase().slice(0,4)&&(e=J(k[3])),k[3]&&"%"==k[3].slice(-1)&&(e/=100),i.hsl2rgb(d,c,j,e);x={r:d,g:c,b:j};x.hex="#"+(16777216|j|c<<8|d<<16).toString(16).slice(1);i.is(e,"finite")&&(x.opacity=e);return x}return{r:-1,g:-1,b:-1,hex:"none",error:1}},i);i.getColor=function(a){var a=this.getColor.start=this.getColor.start||{h:0,s:1,b:a||0.75},d=this.hsb2rgb(a.h,a.s,a.b);a.h+=0.075;
if(1<a.h)a.h=0,a.s-=0.2,0>=a.s&&(this.getColor.start={h:0,s:1,b:a.b});return d.hex};i.getColor.reset=function(){delete this.start};i.parsePathString=q(function(a){if(!a)return null;var d={a:7,c:6,h:1,l:2,m:2,q:4,s:4,t:2,v:1,z:0},c=[];i.is(a,Y)&&i.is(a[0],Y)&&(c=pa(a));c[j]||A(a).replace(nb,function(a,x,k){var e=[],a=C.call(x);k.replace(ob,function(a,d){d&&e[F](+d)});"m"==a&&2<e[j]&&(c[F]([x].concat(e.splice(0,2))),a="l",x="m"==x?"l":"L");for(;e[j]>=d[a]&&!(c[F]([x].concat(e.splice(0,d[a]))),!d[a]););
});c[da]=i._path2string;return c});i.findDotsAtSegment=function(a,d,c,j,e,k,f,g,i){var m=1-i,h=P(m,3)*a+3*P(m,2)*i*c+3*m*i*i*e+P(i,3)*f,m=P(m,3)*d+3*P(m,2)*i*j+3*m*i*i*k+P(i,3)*g,r=a+2*i*(c-a)+i*i*(e-2*c+a),p=d+2*i*(j-d)+i*i*(k-2*j+d),y=c+2*i*(e-c)+i*i*(f-2*e+c),l=j+2*i*(k-j)+i*i*(g-2*k+j),a=(1-i)*a+i*c,d=(1-i)*d+i*j,e=(1-i)*e+i*f,k=(1-i)*k+i*g,g=90-180*B.atan((r-y)/(p-l))/V;(r>y||p<l)&&(g+=180);return{x:h,y:m,m:{x:r,y:p},n:{x:y,y:l},start:{x:a,y:d},end:{x:e,y:k},alpha:g}};var ra=q(function(a){if(!a)return{x:0,
y:0,width:0,height:0};for(var a=qa(a),d=0,c=0,e=[],f=[],k,i=0,g=a[j];i<g;i++)k=a[i],"M"==k[0]?(d=k[1],c=k[2],e[F](d),f[F](c)):(d=sb(d,c,k[1],k[2],k[3],k[4],k[5],k[6]),e=e.concat(d.min.x,d.max.x),f=f.concat(d.min.y,d.max.y),d=k[5],c=k[6]);a=O[D](0,e);k=O[D](0,f);return{x:a,y:k,width:u[D](0,e)-a,height:u[D](0,f)-k}}),pa=function(a){var d=[];if(!i.is(a,Y)||!i.is(a&&a[0],Y))a=i.parsePathString(a);for(var c=0,e=a[j];c<e;c++){d[c]=[];for(var f=0,k=a[c][j];f<k;f++)d[c][f]=a[c][f]}d[da]=i._path2string;return d},
Ba=q(function(a){if(!i.is(a,Y)||!i.is(a&&a[0],Y))a=i.parsePathString(a);var d=[],c=0,e=0,f=0,k=0,g=0;"M"==a[0][0]&&(c=a[0][1],e=a[0][2],f=c,k=e,g++,d[F](["M",c,e]));for(var xa=a[j];g<xa;g++){var Q=d[g]=[],m=a[g];if(m[0]!=C.call(m[0]))switch(Q[0]=C.call(m[0]),Q[0]){case "a":Q[1]=m[1];Q[2]=m[2];Q[3]=m[3];Q[4]=m[4];Q[5]=m[5];Q[6]=+(m[6]-c).toFixed(3);Q[7]=+(m[7]-e).toFixed(3);break;case "v":Q[1]=+(m[1]-e).toFixed(3);break;case "m":f=m[1],k=m[2];default:for(var h=1,r=m[j];h<r;h++)Q[h]=+(m[h]-(h%2?c:e)).toFixed(3)}else{d[g]=
[];"m"==m[0]&&(f=m[1]+c,k=m[2]+e);Q=0;for(h=m[j];Q<h;Q++)d[g][Q]=m[Q]}m=d[g][j];switch(d[g][0]){case "z":c=f;e=k;break;case "h":c+=+d[g][m-1];break;case "v":e+=+d[g][m-1];break;default:c+=+d[g][m-2],e+=+d[g][m-1]}}d[da]=i._path2string;return d},0,pa),ga=q(function(a){if(!i.is(a,Y)||!i.is(a&&a[0],Y))a=i.parsePathString(a);var d=[],c=0,e=0,f=0,k=0,g=0;"M"==a[0][0]&&(c=+a[0][1],e=+a[0][2],f=c,k=e,g++,d[0]=["M",c,e]);for(var xa=a[j];g<xa;g++){var Q=d[g]=[],m=a[g];if(m[0]!=la.call(m[0]))switch(Q[0]=la.call(m[0]),
Q[0]){case "A":Q[1]=m[1];Q[2]=m[2];Q[3]=m[3];Q[4]=m[4];Q[5]=m[5];Q[6]=+(m[6]+c);Q[7]=+(m[7]+e);break;case "V":Q[1]=+m[1]+e;break;case "H":Q[1]=+m[1]+c;break;case "M":f=+m[1]+c,k=+m[2]+e;default:for(var h=1,r=m[j];h<r;h++)Q[h]=+m[h]+(h%2?c:e)}else{h=0;for(r=m[j];h<r;h++)d[g][h]=m[h]}switch(Q[0]){case "Z":c=f;e=k;break;case "H":c=Q[1];break;case "V":e=Q[1];break;case "M":f=d[g][d[g][j]-2],k=d[g][d[g][j]-1];default:c=d[g][d[g][j]-2],e=d[g][d[g][j]-1]}}d[da]=i._path2string;return d},null,pa),Oa=function(a,
d,c,j,e,k){var f=1/3,g=2/3;return[f*a+g*c,f*d+g*j,f*e+g*c,f*k+g*j,e,k]},Pa=function(a,d,c,e,f,k,g,i,h,m){var r=120*V/180,p=V/180*(+f||0),l=[],o,n=q(function(a,d,x){var c=a*B.cos(x)-d*B.sin(x),a=a*B.sin(x)+d*B.cos(x);return{x:c,y:a}});if(m)u=m[0],o=m[1],k=m[2],C=m[3];else{o=n(a,d,-p);a=o.x;d=o.y;o=n(i,h,-p);i=o.x;h=o.y;B.cos(V/180*f);B.sin(V/180*f);o=(a-i)/2;u=(d-h)/2;C=o*o/(c*c)+u*u/(e*e);1<C&&(C=B.sqrt(C),c*=C,e*=C);var C=c*c,K=e*e,C=(k==g?-1:1)*B.sqrt(T((C*K-C*u*u-K*o*o)/(C*u*u+K*o*o))),k=C*c*u/
e+(a+i)/2,C=C*-e*o/c+(d+h)/2,u=B.asin(((d-C)/e).toFixed(9));o=B.asin(((h-C)/e).toFixed(9));u=a<k?V-u:u;o=i<k?V-o:o;0>u&&(u=2*V+u);0>o&&(o=2*V+o);g&&u>o&&(u-=2*V);!g&&o>u&&(o-=2*V)}if(T(o-u)>r){var l=o,K=i,z=h;o=u+r*(g&&o>u?1:-1);i=k+c*B.cos(o);h=C+e*B.sin(o);l=Pa(i,h,c,e,f,0,g,K,z,[o,l,k,C])}k=o-u;f=B.cos(u);r=B.sin(u);g=B.cos(o);o=B.sin(o);k=B.tan(k/4);c=4/3*c*k;k*=4/3*e;e=[a,d];a=[a+c*r,d-k*f];d=[i+c*o,h-k*g];i=[i,h];a[0]=2*e[0]-a[0];a[1]=2*e[1]-a[1];if(m)return[a,d,i].concat(l);l=[a,d,i].concat(l)[y]().split(",");
m=[];i=0;for(h=l[j];i<h;i++)m[i]=i%2?n(l[i-1],l[i],p).y:n(l[i],l[i+1],p).x;return m},sa=function(a,d,c,j,e,k,f,g,i){var m=1-i;return{x:P(m,3)*a+3*P(m,2)*i*c+3*m*i*i*e+P(i,3)*f,y:P(m,3)*d+3*P(m,2)*i*j+3*m*i*i*k+P(i,3)*g}},sb=q(function(a,d,c,j,e,k,f,i){var g=e-2*c+a-(f-2*e+c),m=2*(c-a)-2*(e-c),h=a-c,r=(-m+B.sqrt(m*m-4*g*h))/2/g,g=(-m-B.sqrt(m*m-4*g*h))/2/g,p=[d,i],l=[a,f];"1e12"<T(r)&&(r=0.5);"1e12"<T(g)&&(g=0.5);0<r&&1>r&&(r=sa(a,d,c,j,e,k,f,i,r),l[F](r.x),p[F](r.y));0<g&&1>g&&(r=sa(a,d,c,j,e,k,f,
i,g),l[F](r.x),p[F](r.y));g=k-2*j+d-(i-2*k+j);m=2*(j-d)-2*(k-j);h=d-j;r=(-m+B.sqrt(m*m-4*g*h))/2/g;g=(-m-B.sqrt(m*m-4*g*h))/2/g;"1e12"<T(r)&&(r=0.5);"1e12"<T(g)&&(g=0.5);0<r&&1>r&&(r=sa(a,d,c,j,e,k,f,i,r),l[F](r.x),p[F](r.y));0<g&&1>g&&(r=sa(a,d,c,j,e,k,f,i,g),l[F](r.x),p[F](r.y));return{min:{x:O[D](0,l),y:O[D](0,p)},max:{x:u[D](0,l),y:u[D](0,p)}}}),qa=q(function(a,d){var c=ga(a),e=d&&ga(d),f={x:0,y:0,bx:0,by:0,X:0,Y:0,qx:null,qy:null},k={x:0,y:0,bx:0,by:0,X:0,Y:0,qx:null,qy:null},g=function(a,d){var x,
c;if(!a)return["C",d.x,d.y,d.x,d.y,d.x,d.y];!(a[0]in{T:1,Q:1})&&(d.qx=d.qy=null);switch(a[0]){case "M":d.X=a[1];d.Y=a[2];break;case "A":a=["C"].concat(Pa[D](0,[d.x,d.y].concat(a.slice(1))));break;case "S":x=d.x+(d.x-(d.bx||d.x));c=d.y+(d.y-(d.by||d.y));a=["C",x,c].concat(a.slice(1));break;case "T":d.qx=d.x+(d.x-(d.qx||d.x));d.qy=d.y+(d.y-(d.qy||d.y));a=["C"].concat(Oa(d.x,d.y,d.qx,d.qy,a[1],a[2]));break;case "Q":d.qx=a[1];d.qy=a[2];a=["C"].concat(Oa(d.x,d.y,a[1],a[2],a[3],a[4]));break;case "L":a=
["C"].concat([d.x,d.y,a[1],a[2],a[1],a[2]]);break;case "H":a=["C"].concat([d.x,d.y,a[1],d.y,a[1],d.y]);break;case "V":a=["C"].concat([d.x,d.y,d.x,a[1],d.x,a[1]]);break;case "Z":a=["C"].concat([d.x,d.y,d.X,d.Y,d.X,d.Y])}return a},i=function(a,d){if(7<a[d][j]){a[d].shift();for(var x=a[d];x[j];)a.splice(d++,0,["C"].concat(x.splice(0,6)));a.splice(d,1);r=u(c[j],e&&e[j]||0)}},h=function(a,d,x,k,W){if(a&&d&&"M"==a[W][0]&&"M"!=d[W][0])d.splice(W,0,["M",k.x,k.y]),x.bx=0,x.by=0,x.x=a[W][1],x.y=a[W][2],r=u(c[j],
e&&e[j]||0)},m=0,r=u(c[j],e&&e[j]||0);for(;m<r;m++){c[m]=g(c[m],f);i(c,m);e&&(e[m]=g(e[m],k));e&&i(e,m);h(c,e,f,k,m);h(e,c,k,f,m);var p=c[m],l=e&&e[m],y=p[j],o=e&&l[j];f.x=p[y-2];f.y=p[y-1];f.bx=J(p[y-4])||f.x;f.by=J(p[y-3])||f.y;k.bx=e&&(J(l[o-4])||k.x);k.by=e&&(J(l[o-3])||k.y);k.x=e&&l[o-2];k.y=e&&l[o-1]}return e?[c,e]:c},null,pa),Qa=q(function(a){for(var d=[],c=0,e=a[j];c<e;c++){var f={},k=a[c].match(/^([^:]*):?([\d\.]*)/);f.color=i.getRGB(k[1]);if(f.color.error)return null;f.color=f.color.hex;
k[2]&&(f.offset=k[2]+"%");d[F](f)}for(c=1,e=d[j]-1;c<e;c++)if(!d[c].offset){a=J(d[c-1].offset||0);k=0;for(f=c+1;f<e;f++)if(d[f].offset){k=d[f].offset;break}k||(k=100,f=e);k=J(k);for(k=(k-a)/(f-c+1);c<f;c++)a+=k,d[c].offset=a+"%"}return d}),Ra=function(a,c,j,e){if(i.is(a,"string")||i.is(a,"object")){if(a=i.is(a,"string")?d.getElementById(a):a,a.tagName)return null==c?{container:a,width:a.style.pixelWidth||a.offsetWidth,height:a.style.pixelHeight||a.offsetHeight}:{container:a,width:c,height:j}}else return{container:1,
x:a,y:c,width:j,height:e}},Ca=function(d,c){var j=this,e;for(e in c)if(c[a](e)&&!(e in d))switch(typeof c[e]){case "function":(function(a){d[e]=d===j?a:function(){return a[D](j,arguments)}})(c[e]);break;case "object":d[e]=d[e]||{};Ca.call(this,d[e],c[e]);break;default:d[e]=c[e]}},fa=function(a,d){a==d.top&&(d.top=a.prev);a==d.bottom&&(d.bottom=a.next);a.next&&(a.next.prev=a.prev);a.prev&&(a.prev.next=a.next)},Sa=function(a,d){if(d.top!==a)fa(a,d),a.next=null,a.prev=d.top,d.top.next=a,d.top=a},Ta=
function(a,d){if(d.bottom!==a)fa(a,d),a.next=d.bottom,a.prev=null,d.bottom.prev=a,d.bottom=a},Ua=function(a,d,c){fa(a,c);d==c.top&&(c.top=a);d.next&&(d.next.prev=a);a.next=d.next;a.prev=d;d.next=a},Va=function(a,d,c){fa(a,c);d==c.bottom&&(c.bottom=a);d.prev&&(d.prev.next=a);a.prev=d.prev;d.prev=a;a.next=d},Wa=function(a){return function(){throw Error("Rapha\u00ebl: you are calling to method \u201c"+a+"\u201d of removed object");}};i.pathToRelative=Ba;if(i.svg){z.svgns="http://www.w3.org/2000/svg";
z.xlink="http://www.w3.org/1999/xlink";var G=function(a){return+a+0.5*(~~a===a)},E=function(c,e){if(e)for(var j in e)e[a](j)&&c.setAttribute(j,A(e[j]));else return c=d.createElementNS(z.svgns,c),c.style.webkitTapHighlightColor="rgba(0,0,0,0)",c};i[da]=function(){return"Your browser supports SVG.\nYou are running Rapha\u00ebl "+this.version};var Xa=function(a,d){var c=E("path");d.canvas&&d.canvas.appendChild(c);c=new S(c,d);c.type="path";ea(c,{fill:"none",stroke:"#000",path:a});return c},ha=function(a,
c,e){var f="linear",g=0.5,k=0.5,i=a.style,c=A(c).replace(Ma,function(a,d,c){f="radial";d&&c&&(g=J(d),k=J(c),a=2*(0.5<k)-1,0.25<P(g-0.5,2)+P(k-0.5,2)&&(k=B.sqrt(0.25-P(g-0.5,2))*a+0.5)&&0.5!=k&&(k=k.toFixed(5)-1.0E-5*a));return""}),c=c.split(/\s*\-\s*/);if("linear"==f){var h=c.shift(),h=-J(h);if(isNaN(h))return null;var h=[0,0,B.cos(h*V/180),B.sin(h*V/180)],r=1/(u(T(h[2]),T(h[3]))||1);h[2]*=r;h[3]*=r;0>h[2]&&(h[0]=-h[2],h[2]=0);0>h[3]&&(h[1]=-h[3],h[3]=0)}c=Qa(c);if(!c)return null;r=a.getAttribute("fill");
(r=r.match(/^url\(#(.*)\)$/))&&e.defs.removeChild(d.getElementById(r[1]));r=E(f+"Gradient");r.id=w();E(r,"radial"==f?{fx:g,fy:k}:{x1:h[0],y1:h[1],x2:h[2],y2:h[3]});e.defs.appendChild(r);e=0;for(h=c[j];e<h;e++){var m=E("stop");E(m,{offset:c[e].offset?c[e].offset:e?"100%":"0%","stop-color":c[e].color||"#fff"});r.appendChild(m)}E(a,{fill:"url(#"+r.id+")",opacity:1,"fill-opacity":1});i.fill="";i.opacity=1;return i.fillOpacity=1},Da=function(a){var d=a.getBBox();E(a.pattern,{patternTransform:i.format("translate({0},{1})",
d.x,d.y)})},ea=function(c,e){var v={"":[0],none:[0],"-":[3,1],".":[1,1],"-.":[3,1,1,1],"-..":[3,1,1,1,1,1],". ":[1,3],"- ":[4,3],"--":[8,3],"- .":[4,3,1,3],"--.":[8,3,1,3],"--..":[8,3,1,3,1,3]},g=c.node,h=c.attrs,k=c.rotate(),r=function(a,d){if(d=v[C.call(d)]){for(var c=a.attrs["stroke-width"]||"1",x={round:c,square:c,butt:0}[a.attrs["stroke-linecap"]||e["stroke-linecap"]]||0,k=[],f=d[j];f--;)k[f]=d[f]*c+(f%2?1:-1)*x;E(g,{"stroke-dasharray":k[y](",")})}};e[a]("rotation")&&(k=e.rotation);var l=A(k).split(p);
l.length-1?(l[1]=+l[1],l[2]=+l[2]):l=null;J(k)&&c.rotate(0,!0);for(var o in e)if(e[a](o)&&ma[a](o)){var m=e[o];h[o]=m;switch(o){case "blur":c.blur(m);break;case "rotation":c.rotate(m,!0);break;case "href":case "title":case "target":var n=g.parentNode;if("a"!=C.call(n.tagName)){var u=E("a");n.insertBefore(u,g);u.appendChild(g);n=u}"target"==o&&"blank"==m?n.setAttributeNS(c.paper.xlink,"show","new"):n.setAttributeNS(c.paper.xlink,o,m);break;case "cursor":g.style.cursor=m;break;case "clip-rect":n=A(m).split(p);
if(4==n[j]){c.clip&&c.clip.parentNode.parentNode.removeChild(c.clip.parentNode);var q=E("clipPath"),u=E("rect");q.id=w();E(u,{x:n[0],y:n[1],width:n[2],height:n[3]});q.appendChild(u);c.paper.defs.appendChild(q);E(g,{"clip-path":"url(#"+q.id+")"});c.clip=u}m||((m=d.getElementById(g.getAttribute("clip-path").replace(/(^url\(#|\)$)/g,"")))&&m.parentNode.removeChild(m),E(g,{"clip-path":""}),delete c.clip);break;case "path":"path"==c.type&&E(g,{d:m?h.path=ga(m):"M0,0"});break;case "width":if(g.setAttribute(o,
m),h.fx)o="x",m=h.x;else break;case "x":h.fx&&(m=-h.x-(h.width||0));case "rx":if("rx"==o&&"rect"==c.type)break;case "cx":l&&("x"==o||"cx"==o)&&(l[1]+=m-h[o]);g.setAttribute(o,m);c.pattern&&Da(c);break;case "height":if(g.setAttribute(o,m),h.fy)o="y",m=h.y;else break;case "y":h.fy&&(m=-h.y-(h.height||0));case "ry":if("ry"==o&&"rect"==c.type)break;case "cy":l&&("y"==o||"cy"==o)&&(l[2]+=m-h[o]);g.setAttribute(o,m);c.pattern&&Da(c);break;case "r":"rect"==c.type?E(g,{rx:m,ry:m}):g.setAttribute(o,m);break;
case "src":"image"==c.type&&g.setAttributeNS(c.paper.xlink,"href",m);break;case "stroke-width":g.style.strokeWidth=m;g.setAttribute(o,m);h["stroke-dasharray"]&&r(c,h["stroke-dasharray"]);break;case "stroke-dasharray":r(c,m);break;case "translation":m=A(m).split(p);m[0]=+m[0]||0;m[1]=+m[1]||0;l&&(l[1]+=m[0],l[2]+=m[1]);ta.call(c,m[0],m[1]);break;case "scale":m=A(m).split(p);c.scale(+m[0]||1,+m[1]||+m[0]||1,isNaN(J(m[2]))?null:+m[2],isNaN(J(m[3]))?null:+m[3]);break;case "fill":if(n=A(m).match(La)){var q=
E("pattern"),B=E("image");q.id=w();E(q,{x:0,y:0,patternUnits:"userSpaceOnUse",height:1,width:1});E(B,{x:0,y:0});B.setAttributeNS(c.paper.xlink,"href",n[1]);q.appendChild(B);m=d.createElement("img");m.style.cssText="position:absolute;left:-9999em;top-9999em";m.onload=function(){E(q,{width:this.offsetWidth,height:this.offsetHeight});E(B,{width:this.offsetWidth,height:this.offsetHeight});d.body.removeChild(this);c.paper.safari()};d.body.appendChild(m);m.src=n[1];c.paper.defs.appendChild(q);g.style.fill=
"url(#"+q.id+")";E(g,{fill:"url(#"+q.id+")"});c.pattern=q;c.pattern&&Da(c);break}n=i.getRGB(m);if(n.error)if(({circle:1,ellipse:1}[a](c.type)||"r"!=A(m).charAt())&&ha(g,m,c.paper)){h.gradient=m;h.fill="none";break}else delete e.gradient,delete h.gradient,!i.is(h.opacity,"undefined")&&i.is(e.opacity,"undefined")&&E(g,{opacity:h.opacity}),!i.is(h["fill-opacity"],"undefined")&&i.is(e["fill-opacity"],"undefined")&&E(g,{"fill-opacity":h["fill-opacity"]});n[a]("opacity")&&E(g,{"fill-opacity":1<n.opacity?
n.opacity/100:n.opacity});case "stroke":n=i.getRGB(m);g.setAttribute(o,n.hex);"stroke"==o&&n[a]("opacity")&&E(g,{"stroke-opacity":1<n.opacity?n.opacity/100:n.opacity});break;case "gradient":(({circle:1,ellipse:1})[a](c.type)||"r"!=A(m).charAt())&&ha(g,m,c.paper);break;case "opacity":h.gradient&&!h[a]("stroke-opacity")&&E(g,{"stroke-opacity":1<m?m/100:m});case "fill-opacity":if(h.gradient){if(n=d.getElementById(g.getAttribute("fill").replace(/^url\(#|\)$/g,"")))n=n.getElementsByTagName("stop"),n[n[j]-
1].setAttribute("stop-opacity",m);break}default:"font-size"==o&&(m=$(m,10)+"px"),n=o.replace(/(\-.)/g,function(a){return la.call(a.substring(1))}),g.style[n]=m,g.setAttribute(o,m)}}tb(c,e);l?c.rotate(l.join(f)):J(k)&&c.rotate(k,!0)},tb=function(c,e){if(!("text"!=c.type||!e[a]("text")&&!e[a]("font")&&!e[a]("font-size")&&!e[a]("x")&&!e[a]("y"))){var v=c.attrs,g=c.node,f=g.firstChild?$(d.defaultView.getComputedStyle(g.firstChild,"").getPropertyValue("font-size"),10):10;if(e[a]("text")){for(v.text=e.text;g.firstChild;)g.removeChild(g.firstChild);
for(var k=A(e.text).split("\n"),h=0,r=k[j];h<r;h++)if(k[h]){var l=E("tspan");h&&E(l,{dy:1.2*f,x:v.x});l.appendChild(d.createTextNode(k[h]));g.appendChild(l)}}else{k=g.getElementsByTagName("tspan");for(h=0,r=k[j];h<r;h++)h&&E(k[h],{dy:1.2*f,x:v.x})}E(g,{y:v.y});f=c.getBBox();(f=v.y-(f.y+f.height/2))&&i.is(f,"finite")&&E(g,{y:v.y+f})}},S=function(a,d){this[0]=a;this.id=i._oid++;this.node=a;a.raphael=this;this.paper=d;this.attrs=this.attrs||{};this.transformations=[];this._={tx:0,ty:0,rt:{deg:0,cx:0,
cy:0},sx:1,sy:1};!d.bottom&&(d.bottom=this);(this.prev=d.top)&&(d.top.next=this);d.top=this;this.next=null},N=S[l];S[l].rotate=function(a,d,c){if(this.removed)return this;if(null==a)return this._.rt.cx?[this._.rt.deg,this._.rt.cx,this._.rt.cy][y](f):this._.rt.deg;var e=this.getBBox(),a=A(a).split(p);a[j]-1&&(d=J(a[1]),c=J(a[2]));a=J(a[0]);null!=d&&!1!==d?this._.rt.deg=a:this._.rt.deg+=a;null==c&&(d=null);this._.rt.cx=d;this._.rt.cy=c;d=null==d?e.x+e.width/2:d;c=null==c?e.y+e.height/2:c;this._.rt.deg?
(this.transformations[0]=i.format("rotate({0} {1} {2})",this._.rt.deg,d,c),this.clip&&E(this.clip,{transform:i.format("rotate({0} {1} {2})",-this._.rt.deg,d,c)})):(this.transformations[0]="",this.clip&&E(this.clip,{transform:""}));E(this.node,{transform:this.transformations[y](f)});return this};S[l].hide=function(){!this.removed&&(this.node.style.display="none");return this};S[l].show=function(){!this.removed&&(this.node.style.display="");return this};S[l].remove=function(){if(!this.removed){fa(this,
this.paper);this.node.parentNode.removeChild(this.node);for(var a in this)delete this[a];this.removed=!0}};S[l].getBBox=function(){if(this.removed)return this;if("path"==this.type)return ra(this.attrs.path);if("none"==this.node.style.display){this.show();var a=!0}var d={};try{d=this.node.getBBox()}catch(c){}finally{d=d||{}}if("text"==this.type)for(var d={x:d.x,y:Infinity,width:0,height:0},e=0,j=this.node.getNumberOfChars();e<j;e++){var k=this.node.getExtentOfChar(e);k.y<d.y&&(d.y=k.y);k.y+k.height-
d.y>d.height&&(d.height=k.y+k.height-d.y);k.x+k.width-d.x>d.width&&(d.width=k.x+k.width-d.x)}a&&this.hide();return d};S[l].attr=function(d,c){if(this.removed)return this;if(null==d){var e={},j;for(j in this.attrs)this.attrs[a](j)&&(e[j]=this.attrs[j]);this._.rt.deg&&(e.rotation=this.rotate());(1!=this._.sx||1!=this._.sy)&&(e.scale=this.scale());e.gradient&&"none"==e.fill&&(e.fill=e.gradient)&&delete e.gradient;return e}if(null==c&&i.is(d,"string"))return"translation"==d?ta.call(this):"rotation"==
d?this.rotate():"scale"==d?this.scale():"fill"==d&&"none"==this.attrs.fill&&this.attrs.gradient?this.attrs.gradient:this.attrs[d];if(null==c&&i.is(d,Y)){j={};for(var e=0,g=d.length;e<g;e++)j[d[e]]=this.attr(d[e]);return j}null!=c?(e={},e[d]=c):null!=d&&i.is(d,"object")&&(e=d);for(g in this.paper.customAttributes)if(this.paper.customAttributes[a](g)&&e[a](g)&&i.is(this.paper.customAttributes[g],"function")){j=this.paper.customAttributes[g].apply(this,[].concat(e[g]));this.attrs[g]=e[g];for(var k in j)j[a](k)&&
(e[k]=j[k])}ea(this,e);return this};S[l].toFront=function(){if(this.removed)return this;this.node.parentNode.appendChild(this.node);var a=this.paper;a.top!=this&&Sa(this,a);return this};S[l].toBack=function(){if(this.removed)return this;this.node.parentNode.firstChild!=this.node&&(this.node.parentNode.insertBefore(this.node,this.node.parentNode.firstChild),Ta(this,this.paper));return this};S[l].insertAfter=function(a){if(this.removed)return this;var d=a.node||a[a.length-1].node;d.nextSibling?d.parentNode.insertBefore(this.node,
d.nextSibling):d.parentNode.appendChild(this.node);Ua(this,a,this.paper);return this};S[l].insertBefore=function(a){if(this.removed)return this;var d=a.node||a[0].node;d.parentNode.insertBefore(this.node,d);Va(this,a,this.paper);return this};S[l].blur=function(a){if(0!==+a){var d=E("filter"),c=E("feGaussianBlur");this.attrs.blur=a;d.id=w();E(c,{stdDeviation:+a||1.5});d.appendChild(c);this.paper.defs.appendChild(d);this._blur=d;E(this.node,{filter:"url(#"+d.id+")"})}else this._blur&&(this._blur.parentNode.removeChild(this._blur),
delete this._blur,delete this.attrs.blur),this.node.removeAttribute("filter")};var Ya=function(a,d,c,e){var j=E("circle");a.canvas&&a.canvas.appendChild(j);a=new S(j,a);a.attrs={cx:d,cy:c,r:e,fill:"none",stroke:"#000"};a.type="circle";E(j,a.attrs);return a},Za=function(a,d,c,e,j,k){var g=E("rect");a.canvas&&a.canvas.appendChild(g);a=new S(g,a);a.attrs={x:d,y:c,width:e,height:j,r:k||0,rx:k||0,ry:k||0,fill:"none",stroke:"#000"};a.type="rect";E(g,a.attrs);return a},$a=function(a,d,c,e,j){var k=E("ellipse");
a.canvas&&a.canvas.appendChild(k);a=new S(k,a);a.attrs={cx:d,cy:c,rx:e,ry:j,fill:"none",stroke:"#000"};a.type="ellipse";E(k,a.attrs);return a},ab=function(a,d,c,e,j,k){var g=E("image");E(g,{x:c,y:e,width:j,height:k,preserveAspectRatio:"none"});g.setAttributeNS(a.xlink,"href",d);a.canvas&&a.canvas.appendChild(g);a=new S(g,a);a.attrs={x:c,y:e,width:j,height:k,src:d};a.type="image";return a},bb=function(a,d,c,e){var j=E("text");E(j,{x:d,y:c,"text-anchor":"middle"});a.canvas&&a.canvas.appendChild(j);
a=new S(j,a);a.attrs={x:d,y:c,"text-anchor":"middle",text:e,font:ma.font,stroke:"none",fill:"#000"};a.type="text";ea(a,a.attrs);return a},cb=function(a,d){this.width=a||this.width;this.height=d||this.height;this.canvas.setAttribute("width",this.width);this.canvas.setAttribute("height",this.height);return this},wa=function(){var a=Ra[D](0,arguments),c=a&&a.container,e=a.x,j=a.y,g=a.width,a=a.height;if(!c)throw Error("SVG container not found.");var k=E("svg"),e=e||0,j=j||0,g=g||512,a=a||342;E(k,{xmlns:"http://www.w3.org/2000/svg",
version:1.1,width:g,height:a});1==c?(k.style.cssText="position:absolute;left:"+e+"px;top:"+j+"px",d.body.appendChild(k)):c.firstChild?c.insertBefore(k,c.firstChild):c.appendChild(k);c=new M;c.width=g;c.height=a;c.canvas=k;Ca.call(c,c,i.fn);c.clear();return c};z.clear=function(){for(var a=this.canvas;a.firstChild;)a.removeChild(a.firstChild);this.bottom=this.top=null;(this.desc=E("desc")).appendChild(d.createTextNode("Created with Rapha\u00ebl"));a.appendChild(this.desc);a.appendChild(this.defs=E("defs"))};
z.remove=function(){this.canvas.parentNode&&this.canvas.parentNode.removeChild(this.canvas);for(var a in this)this[a]=Wa(a)}}if(i.vml){var db={M:"m",L:"l",C:"c",Z:"x",m:"t",l:"r",c:"v",z:"x"},ub=/([clmz]),?([^clmz]*)/gi,vb=/ progid:\S+Blur\([^\)]+\)/g,wb=/-?[^,\s-]+/g,ia=1E3+f+1E3,ja={path:1,rect:1},xb=function(a){var d=/[ahqstv]/ig,c=ga;A(a).match(d)&&(c=qa);d=/[clmz]/g;if(c==ga&&!A(a).match(d))return a=A(a).replace(ub,function(a,d,c){var e=[],k="m"==C.call(d),x=db[d];c.replace(wb,function(a){k&&
2==e[j]&&(x+=e+db["m"==d?"l":"L"],e=[]);e[F](G(10*a))});return x+e});for(var d=c(a),e,a=[],g=0,k=d[j];g<k;g++){c=d[g];e=C.call(d[g][0]);"z"==e&&(e="x");for(var i=1,h=c[j];i<h;i++)e+=G(10*c[i])+(i!=h-1?",":"");a[F](e)}return a[y](f)};i[da]=function(){return"Your browser doesn\u2019t support SVG. Falling down to VML.\nYou are running Rapha\u00ebl "+this.version};Xa=function(a,d){var c=X("group");c.style.cssText="position:absolute;left:0;top:0;width:"+d.width+"px;height:"+d.height+"px";c.coordsize=d.coordsize;
c.coordorigin=d.coordorigin;var e=X("shape"),j=e.style;j.width=d.width+"px";j.height=d.height+"px";e.coordsize=ia;e.coordorigin=d.coordorigin;c.appendChild(e);e=new S(e,c,d);j={fill:"none",stroke:"#000"};a&&(j.path=a);e.type="path";e.path=[];e.Path="";ea(e,j);d.canvas.appendChild(c);return e};ea=function(c,e){c.attrs=c.attrs||{};var g=c.node,f=c.attrs,h=g.style,k;k=(e.x!=f.x||e.y!=f.y||e.width!=f.width||e.height!=f.height||e.r!=f.r)&&"rect"==c.type;for(var r in e)e[a](r)&&(f[r]=e[r]);if(k)f.path=
eb(f.x,f.y,f.width,f.height,f.r),c.X=f.x,c.Y=f.y,c.W=f.width,c.H=f.height;e.href&&(g.href=e.href);e.title&&(g.title=e.title);e.target&&(g.target=e.target);e.cursor&&(h.cursor=e.cursor);"blur"in e&&c.blur(e.blur);if(e.path&&"path"==c.type||k)g.path=xb(f.path);null!=e.rotation&&c.rotate(e.rotation,!0);e.translation&&(k=A(e.translation).split(p),ta.call(c,k[0],k[1]),null!=c._.rt.cx&&(c._.rt.cx+=+k[0],c._.rt.cy+=+k[1],c.setBox(c.attrs,k[0],k[1])));e.scale&&(k=A(e.scale).split(p),c.scale(+k[0]||1,+k[1]||
+k[0]||1,+k[2]||null,+k[3]||null));if("clip-rect"in e){k=A(e["clip-rect"]).split(p);if(4==k[j]){k[2]=+k[2]+ +k[0];k[3]=+k[3]+ +k[1];r=g.clipRect||d.createElement("div");var l=r.style,o=g.parentNode;l.clip=i.format("rect({1}px {2}px {3}px {0}px)",k);if(!g.clipRect)l.position="absolute",l.top=0,l.left=0,l.width=c.paper.width+"px",l.height=c.paper.height+"px",o.parentNode.insertBefore(r,o),r.appendChild(o),g.clipRect=r}e["clip-rect"]||g.clipRect&&(g.clipRect.style.clip="")}"image"==c.type&&e.src&&(g.src=
e.src);if("image"==c.type&&e.opacity)g.filterOpacity=" progid:DXImageTransform.Microsoft.Alpha(opacity="+100*e.opacity+")",h.filter=(g.filterMatrix||"")+(g.filterOpacity||"");e.font&&(h.font=e.font);e["font-family"]&&(h.fontFamily='"'+e["font-family"].split(",")[0].replace(/^['"]+|['"]+$/g,"")+'"');e["font-size"]&&(h.fontSize=e["font-size"]);e["font-weight"]&&(h.fontWeight=e["font-weight"]);e["font-style"]&&(h.fontStyle=e["font-style"]);if(null!=e.opacity||null!=e["stroke-width"]||null!=e.fill||null!=
e.stroke||null!=e["stroke-width"]||null!=e["stroke-opacity"]||null!=e["fill-opacity"]||null!=e["stroke-dasharray"]||null!=e["stroke-miterlimit"]||null!=e["stroke-linejoin"]||null!=e["stroke-linecap"]){g=c.shape||g;k=g.getElementsByTagName("fill")&&g.getElementsByTagName("fill")[0];r=!1;!k&&(r=k=X("fill"));if("fill-opacity"in e||"opacity"in e)h=((+f["fill-opacity"]+1||2)-1)*((+f.opacity+1||2)-1)*((+i.getRGB(e.fill).o+1||2)-1),h=O(u(h,0),1),k.opacity=h;e.fill&&(k.on=!0);if(null==k.on||"none"==e.fill)k.on=
!1;if(k.on&&e.fill)if(h=e.fill.match(La))k.src=h[1],k.type="tile";else if(k.color=i.getRGB(e.fill).hex,k.src="",k.type="solid",i.getRGB(e.fill).error&&(c.type in{circle:1,ellipse:1}||"r"!=A(e.fill).charAt())&&ha(c,e.fill))f.fill="none",f.gradient=e.fill;r&&g.appendChild(k);k=g.getElementsByTagName("stroke")&&g.getElementsByTagName("stroke")[0];r=!1;!k&&(r=k=X("stroke"));if(e.stroke&&"none"!=e.stroke||e["stroke-width"]||null!=e["stroke-opacity"]||e["stroke-dasharray"]||e["stroke-miterlimit"]||e["stroke-linejoin"]||
e["stroke-linecap"])k.on=!0;("none"==e.stroke||null==k.on||0==e.stroke||0==e["stroke-width"])&&(k.on=!1);h=i.getRGB(e.stroke);k.on&&e.stroke&&(k.color=h.hex);h=((+f["stroke-opacity"]+1||2)-1)*((+f.opacity+1||2)-1)*((+h.o+1||2)-1);l=0.75*(J(e["stroke-width"])||1);h=O(u(h,0),1);null==e["stroke-width"]&&(l=f["stroke-width"]);e["stroke-width"]&&(k.weight=l);l&&1>l&&(h*=l)&&(k.weight=1);k.opacity=h;e["stroke-linejoin"]&&(k.joinstyle=e["stroke-linejoin"]||"miter");k.miterlimit=e["stroke-miterlimit"]||8;
e["stroke-linecap"]&&(k.endcap="butt"==e["stroke-linecap"]?"flat":"square"==e["stroke-linecap"]?"square":"round");if(e["stroke-dasharray"])h={"-":"shortdash",".":"shortdot","-.":"shortdashdot","-..":"shortdashdotdot",". ":"dot","- ":"dash","--":"longdash","- .":"dashdot","--.":"longdashdot","--..":"longdashdotdot"},k.dashstyle=h[a](e["stroke-dasharray"])?h[e["stroke-dasharray"]]:"";r&&g.appendChild(k)}if("text"==c.type)switch(h=c.paper.span.style,f.font&&(h.font=f.font),f["font-family"]&&(h.fontFamily=
f["font-family"]),f["font-size"]&&(h.fontSize=f["font-size"]),f["font-weight"]&&(h.fontWeight=f["font-weight"]),f["font-style"]&&(h.fontStyle=f["font-style"]),c.node.string&&(c.paper.span.innerHTML=A(c.node.string).replace(/</g,"&#60;").replace(/&/g,"&#38;").replace(/\n/g,"<br>")),c.W=f.w=c.paper.span.offsetWidth,c.H=f.h=c.paper.span.offsetHeight,c.X=f.x,c.Y=f.y+G(c.H/2),f["text-anchor"]){case "start":c.node.style["v-text-align"]="left";c.bbx=G(c.W/2);break;case "end":c.node.style["v-text-align"]=
"right";c.bbx=-G(c.W/2);break;default:c.node.style["v-text-align"]="center"}};ha=function(a,d){a.attrs=a.attrs||{};var c,e="linear",g=".5 .5";a.attrs.gradient=d;d=A(d).replace(Ma,function(a,d,c){e="radial";d&&c&&(d=J(d),c=J(c),0.25<P(d-0.5,2)+P(c-0.5,2)&&(c=B.sqrt(0.25-P(d-0.5,2))*(2*(0.5<c)-1)+0.5),g=d+f+c);return""});d=d.split(/\s*\-\s*/);if("linear"==e){var k=d.shift(),k=-J(k);if(isNaN(k))return null}var i=Qa(d);if(!i)return null;a=a.shape||a.node;c=a.getElementsByTagName("fill")[0]||X("fill");
!c.parentNode&&a.appendChild(c);if(i[j]){c.on=!0;c.method="none";c.color=i[0].color;c.color2=i[i[j]-1].color;for(var h=[],r=0,m=i[j];r<m;r++)i[r].offset&&h[F](i[r].offset+f+i[r].color);c.colors&&(c.colors.value=h[j]?h[y]():"0% "+c.color);"radial"==e?(c.type="gradientradial",c.focus="100%",c.focussize=g,c.focusposition=g):(c.type="gradient",c.angle=(270-k)%360)}return 1};S=function(a,d,c){this[0]=a;this.id=i._oid++;this.node=a;a.raphael=this;this.Y=this.X=0;this.attrs={};this.Group=d;this.paper=c;
this._={tx:0,ty:0,rt:{deg:0},sx:1,sy:1};!c.bottom&&(c.bottom=this);(this.prev=c.top)&&(c.top.next=this);c.top=this;this.next=null};N=S[l];N.rotate=function(a,d,c){if(this.removed)return this;if(null==a)return this._.rt.cx?[this._.rt.deg,this._.rt.cx,this._.rt.cy][y](f):this._.rt.deg;a=A(a).split(p);a[j]-1&&(d=J(a[1]),c=J(a[2]));a=J(a[0]);null!=d?this._.rt.deg=a:this._.rt.deg+=a;null==c&&(d=null);this._.rt.cx=d;this._.rt.cy=c;this.setBox(this.attrs,d,c);this.Group.style.rotation=this._.rt.deg;return this};
N.setBox=function(d,c,e){if(this.removed)return this;var j=this.Group.style,g=this.shape&&this.shape.style||this.node.style,d=d||{},k;for(k in d)d[a](k)&&(this.attrs[k]=d[k]);var c=c||this._.rt.cx,e=e||this._.rt.cy,f=this.attrs,i;switch(this.type){case "circle":d=f.cx-f.r;k=f.cy-f.r;i=f=2*f.r;break;case "ellipse":d=f.cx-f.rx;k=f.cy-f.ry;i=2*f.rx;f=2*f.ry;break;case "image":d=+f.x;k=+f.y;i=f.width||0;f=f.height||0;break;case "text":this.textpath.v=["m",G(f.x),", ",G(f.y-2),"l",G(f.x)+1,", ",G(f.y-
2)][y]("");d=f.x-G(this.W/2);k=f.y-this.H/2;i=this.W;f=this.H;break;case "rect":case "path":this.attrs.path?(f=ra(this.attrs.path),d=f.x,k=f.y,i=f.width,f=f.height):(k=d=0,i=this.paper.width,f=this.paper.height);break;default:k=d=0,i=this.paper.width,f=this.paper.height}var c=(null==c?d+i/2:c)-this.paper.width/2,e=(null==e?k+f/2:e)-this.paper.height/2,h;j.left!=(h=c+"px")&&(j.left=h);j.top!=(h=e+"px")&&(j.top=h);this.X=ja[a](this.type)?-c:d;this.Y=ja[a](this.type)?-e:k;this.W=i;this.H=f;ja[a](this.type)?
(g.left!=(h=10*-c+"px")&&(g.left=h),g.top!=(h=10*-e+"px")&&(g.top=h)):"text"==this.type?(g.left!=(h=-c+"px")&&(g.left=h),g.top!=(h=-e+"px")&&(g.top=h)):(j.width!=(h=this.paper.width+"px")&&(j.width=h),j.height!=(h=this.paper.height+"px")&&(j.height=h),g.left!=(h=d-c+"px")&&(g.left=h),g.top!=(h=k-e+"px")&&(g.top=h),g.width!=(h=i+"px")&&(g.width=h),g.height!=(h=f+"px")&&(g.height=h))};N.hide=function(){!this.removed&&(this.Group.style.display="none");return this};N.show=function(){!this.removed&&(this.Group.style.display=
"block");return this};N.getBBox=function(){return this.removed?this:ja[a](this.type)?ra(this.attrs.path):{x:this.X+(this.bbx||0),y:this.Y,width:this.W,height:this.H}};N.remove=function(){if(!this.removed){fa(this,this.paper);this.node.parentNode.removeChild(this.node);this.Group.parentNode.removeChild(this.Group);this.shape&&this.shape.parentNode.removeChild(this.shape);for(var a in this)delete this[a];this.removed=!0}};N.attr=function(d,c){if(this.removed)return this;if(null==d){var e={},g;for(g in this.attrs)this.attrs[a](g)&&
(e[g]=this.attrs[g]);this._.rt.deg&&(e.rotation=this.rotate());(1!=this._.sx||1!=this._.sy)&&(e.scale=this.scale());e.gradient&&"none"==e.fill&&(e.fill=e.gradient)&&delete e.gradient;return e}if(null==c&&i.is(d,"string"))return"translation"==d?ta.call(this):"rotation"==d?this.rotate():"scale"==d?this.scale():"fill"==d&&"none"==this.attrs.fill&&this.attrs.gradient?this.attrs.gradient:this.attrs[d];if(this.attrs&&null==c&&i.is(d,Y)){var f={};for(g=0,e=d[j];g<e;g++)f[d[g]]=this.attr(d[g]);return f}null!=
c&&(e={},e[d]=c);null==c&&i.is(d,"object")&&(e=d);if(e){for(f in this.paper.customAttributes)if(this.paper.customAttributes[a](f)&&e[a](f)&&i.is(this.paper.customAttributes[f],"function")){g=this.paper.customAttributes[f].apply(this,[].concat(e[f]));this.attrs[f]=e[f];for(var k in g)g[a](k)&&(e[k]=g[k])}e.text&&"text"==this.type&&(this.node.string=e.text);ea(this,e);e.gradient&&({circle:1,ellipse:1}[a](this.type)||"r"!=A(e.gradient).charAt())&&ha(this,e.gradient);(!ja[a](this.type)||this._.rt.deg)&&
this.setBox(this.attrs)}return this};N.toFront=function(){!this.removed&&this.Group.parentNode.appendChild(this.Group);this.paper.top!=this&&Sa(this,this.paper);return this};N.toBack=function(){if(this.removed)return this;this.Group.parentNode.firstChild!=this.Group&&(this.Group.parentNode.insertBefore(this.Group,this.Group.parentNode.firstChild),Ta(this,this.paper));return this};N.insertAfter=function(a){if(this.removed)return this;a.constructor==aa&&(a=a[a.length-1]);a.Group.nextSibling?a.Group.parentNode.insertBefore(this.Group,
a.Group.nextSibling):a.Group.parentNode.appendChild(this.Group);Ua(this,a,this.paper);return this};N.insertBefore=function(a){if(this.removed)return this;a.constructor==aa&&(a=a[0]);a.Group.parentNode.insertBefore(this.Group,a.Group);Va(this,a,this.paper);return this};N.blur=function(a){var d=this.node.runtimeStyle,c=d.filter,c=c.replace(vb,"");0!==+a?(this.attrs.blur=a,d.filter=c+f+" progid:DXImageTransform.Microsoft.Blur(pixelradius="+(+a||1.5)+")",d.margin=i.format("-{0}px 0 0 -{0}px",G(+a||1.5))):
(d.filter=c,d.margin=0,delete this.attrs.blur)};var Ya=function(a,d,c,e){var j=X("group"),g=X("oval");j.style.cssText="position:absolute;left:0;top:0;width:"+a.width+"px;height:"+a.height+"px";j.coordsize=ia;j.coordorigin=a.coordorigin;j.appendChild(g);g=new S(g,j,a);g.type="circle";ea(g,{stroke:"#000",fill:"none"});g.attrs.cx=d;g.attrs.cy=c;g.attrs.r=e;g.setBox({x:d-e,y:c-e,width:2*e,height:2*e});a.canvas.appendChild(j);return g},eb=function(a,d,c,e,j){return j?i.format("M{0},{1}l{2},0a{3},{3},0,0,1,{3},{3}l0,{5}a{3},{3},0,0,1,{4},{3}l{6},0a{3},{3},0,0,1,{4},{4}l0,{7}a{3},{3},0,0,1,{3},{4}z",
a+j,d,c-2*j,j,-j,e-2*j,2*j-c,2*j-e):i.format("M{0},{1}l{2},0,0,{3},{4},0z",a,d,c,e,-c)},Za=function(a,d,c,e,j,g){var f=eb(d,c,e,j,g),a=a.path(f),i=a.attrs;a.X=i.x=d;a.Y=i.y=c;a.W=i.width=e;a.H=i.height=j;i.r=g;i.path=f;a.type="rect";return a},$a=function(a,d,c,e,j){var g=X("group"),f=X("oval");g.style.cssText="position:absolute;left:0;top:0;width:"+a.width+"px;height:"+a.height+"px";g.coordsize=ia;g.coordorigin=a.coordorigin;g.appendChild(f);f=new S(f,g,a);f.type="ellipse";ea(f,{stroke:"#000"});f.attrs.cx=
d;f.attrs.cy=c;f.attrs.rx=e;f.attrs.ry=j;f.setBox({x:d-e,y:c-j,width:2*e,height:2*j});a.canvas.appendChild(g);return f},ab=function(a,d,c,e,j,g){var f=X("group"),i=X("image");f.style.cssText="position:absolute;left:0;top:0;width:"+a.width+"px;height:"+a.height+"px";f.coordsize=ia;f.coordorigin=a.coordorigin;i.src=d;f.appendChild(i);i=new S(i,f,a);i.type="image";i.attrs.src=d;i.attrs.x=c;i.attrs.y=e;i.attrs.w=j;i.attrs.h=g;i.setBox({x:c,y:e,width:j,height:g});a.canvas.appendChild(f);return i},bb=function(a,
d,c,e){var j=X("group"),g=X("shape"),f=g.style,h=X("path"),r=X("textpath");j.style.cssText="position:absolute;left:0;top:0;width:"+a.width+"px;height:"+a.height+"px";j.coordsize=ia;j.coordorigin=a.coordorigin;h.v=i.format("m{0},{1}l{2},{1}",G(10*d),G(10*c),G(10*d)+1);h.textpathok=!0;f.width=a.width;f.height=a.height;r.string=A(e);r.on=!0;g.appendChild(r);g.appendChild(h);j.appendChild(g);f=new S(r,j,a);f.shape=g;f.textpath=h;f.type="text";f.attrs.text=e;f.attrs.x=d;f.attrs.y=c;f.attrs.w=1;f.attrs.h=
1;ea(f,{font:ma.font,stroke:"none",fill:"#000"});f.setBox();a.canvas.appendChild(j);return f},cb=function(a,d){var c=this.canvas.style;a==+a&&(a+="px");d==+d&&(d+="px");c.width=a;c.height=d;c.clip="rect(0 "+a+" "+d+" 0)";return this},X;d.createStyleSheet().addRule(".rvml","behavior:url(#default#VML)");try{!d.namespaces.rvml&&d.namespaces.add("rvml","urn:schemas-microsoft-com:vml"),X=function(a){return d.createElement("<rvml:"+a+' class="rvml">')}}catch(Eb){X=function(a){return d.createElement("<"+
a+' xmlns="urn:schemas-microsoft.com:vml" class="rvml">')}}wa=function(){var a=Ra[D](0,arguments),c=a.container,e=a.height,j=a.width,g=a.x,a=a.y;if(!c)throw Error("VML container not found.");var k=new M,h=k.canvas=d.createElement("div"),r=h.style,g=g||0,a=a||0,j=j||512,e=e||342;j==+j&&(j+="px");e==+e&&(e+="px");k.width=1E3;k.height=1E3;k.coordsize=1E4+f+1E4;k.coordorigin="0 0";k.span=d.createElement("span");k.span.style.cssText="position:absolute;left:-9999em;top:-9999em;padding:0;margin:0;line-height:1;display:inline;";
h.appendChild(k.span);r.cssText=i.format("top:0;left:0;width:{0};height:{1};display:inline-block;position:relative;clip:rect(0 {0} {1} 0);overflow:hidden",j,e);1==c?(d.body.appendChild(h),r.left=g+"px",r.top=a+"px",r.position="absolute"):c.firstChild?c.insertBefore(h,c.firstChild):c.appendChild(h);Ca.call(k,k,i.fn);return k};z.clear=function(){this.canvas.innerHTML="";this.span=d.createElement("span");this.span.style.cssText="position:absolute;left:-9999em;top:-9999em;padding:0;margin:0;line-height:1;display:inline;";
this.canvas.appendChild(this.span);this.bottom=this.top=null};z.remove=function(){this.canvas.parentNode.removeChild(this.canvas);for(var a in this)this[a]=Wa(a);return!0}}var fb=navigator.userAgent.match(/Version\\x2f(.*?)\s/);"Apple Computer, Inc."==navigator.vendor&&(fb&&4>fb[1]||"iP"==navigator.platform.slice(0,2))?z.safari=function(){var a=this.rect(-99,-99,this.width+99,this.height+99).attr({stroke:"none"});e.setTimeout(function(){a.remove()})}:z.safari=function(){};for(var yb=function(){this.returnValue=
!1},zb=function(){return this.originalEvent.preventDefault()},Ab=function(){this.cancelBubble=!0},Bb=function(){return this.originalEvent.stopPropagation()},Cb=function(){if(d.addEventListener)return function(d,c,e,j){var g=H&&r[c]?r[c]:c,f=function(g){if(H&&r[a](c))for(var f=0,k=g.targetTouches&&g.targetTouches.length;f<k;f++)if(g.targetTouches[f].target==d){k=g;g=g.targetTouches[f];g.originalEvent=k;g.preventDefault=zb;g.stopPropagation=Bb;break}return e.call(j,g)};d.addEventListener(g,f,!1);return function(){d.removeEventListener(g,
f,!1);return!0}};if(d.attachEvent)return function(a,d,c,j){var g=function(a){a=a||e.event;a.preventDefault=a.preventDefault||yb;a.stopPropagation=a.stopPropagation||Ab;return c.call(j,a)};a.attachEvent("on"+d,g);return function(){a.detachEvent("on"+d,g);return!0}}}(),ba=[],Ea=function(a){for(var c=a.clientX,e=a.clientY,j=d.documentElement.scrollTop||d.body.scrollTop,g=d.documentElement.scrollLeft||d.body.scrollLeft,f,i=ba.length;i--;){f=ba[i];if(H)for(var h=a.touches.length,r;h--;){if(r=a.touches[h],
r.identifier==f.el._drag.id){c=r.clientX;e=r.clientY;(a.originalEvent?a.originalEvent:a).preventDefault();break}}else a.preventDefault();c+=g;e+=j;f.move&&f.move.call(f.move_scope||f.el,c-f.el._drag.x,e-f.el._drag.y,c,e,a)}},Fa=function(a){i.unmousemove(Ea).unmouseup(Fa);for(var d=ba.length,c;d--;)c=ba[d],c.el._drag={},c.end&&c.end.call(c.end_scope||c.start_scope||c.move_scope||c.el,a);ba=[]},gb=I[j];gb--;)(function(a){i[a]=S[l][a]=function(c,e){if(i.is(c,"function"))this.events=this.events||[],this.events.push({name:a,
f:c,unbind:Cb(this.shape||this.node||d,a,c,e||this)});return this};i["un"+a]=S[l]["un"+a]=function(d){for(var c=this.events,e=c[j];e--;)if(c[e].name==a&&c[e].f==d){c[e].unbind();c.splice(e,1);!c.length&&delete this.events;break}return this}})(I[gb]);N.hover=function(a,d,c,e){return this.mouseover(a,c).mouseout(d,e||c)};N.unhover=function(a,d){return this.unmouseover(a).unmouseout(d)};N.drag=function(a,c,e,j,g,f){this._drag={};this.mousedown(function(h){(h.originalEvent||h).preventDefault();var r=
d.documentElement.scrollTop||d.body.scrollTop,l=d.documentElement.scrollLeft||d.body.scrollLeft;this._drag.x=h.clientX+l;this._drag.y=h.clientY+r;this._drag.id=h.identifier;c&&c.call(g||j||this,h.clientX+l,h.clientY+r,h);!ba.length&&i.mousemove(Ea).mouseup(Fa);ba.push({el:this,move:a,end:e,move_scope:j,start_scope:g,end_scope:f})});return this};N.undrag=function(a,d,c){for(d=ba.length;d--;)ba[d].el==this&&ba[d].move==a&&ba[d].end==c&&ba.splice(d++,1);!ba.length&&i.unmousemove(Ea).unmouseup(Fa)};z.circle=
function(a,d,c){return Ya(this,a||0,d||0,c||0)};z.rect=function(a,d,c,e,j){return Za(this,a||0,d||0,c||0,e||0,j||0)};z.ellipse=function(a,d,c,e){return $a(this,a||0,d||0,c||0,e||0)};z.path=function(a){a&&!i.is(a,"string")&&!i.is(a[0],Y)&&(a+="");return Xa(i.format[D](i,arguments),this)};z.image=function(a,d,c,e,j){return ab(this,a||"about:blank",d||0,c||0,e||0,j||0)};z.text=function(a,d,c){return bb(this,a||0,d||0,A(c))};z.set=function(a){1<arguments[j]&&(a=Array[l].splice.call(arguments,0,arguments[j]));
return new aa(a)};z.setSize=cb;z.top=z.bottom=null;z.raphael=i;N.resetScale=function(){if(this.removed)return this;this._.sx=1;this._.sy=1;this.attrs.scale="1 1"};N.scale=function(a,d,c,e){if(this.removed)return this;if(null==a&&null==d)return{x:this._.sx,y:this._.sy,toString:h};d=d||a;!+d&&(d=a);var g,k,i=this.attrs;if(0!=a){var r=this.getBBox(),l=r.x+r.width/2,m=r.y+r.height/2;g=T(a/this._.sx);k=T(d/this._.sy);var c=+c||0==c?c:l,e=+e||0==e?e:m,o=0<this._.sx,p=0<this._.sy,r=~~(a/T(a)),n=~~(d/T(d)),
C=g*r,u=k*n,q=this.node.style,l=c+T(l-c)*C*(l>c==o?1:-1),m=e+T(m-e)*u*(m>e==p?1:-1),B=a*r>d*n?k:g;switch(this.type){case "rect":case "image":var K=i.width*g,z=i.height*k;this.attr({height:z,r:i.r*B,width:K,x:l-K/2,y:m-z/2});break;case "circle":case "ellipse":this.attr({rx:i.rx*g,ry:i.ry*k,r:i.r*B,cx:l,cy:m});break;case "text":this.attr({x:l,y:m});break;case "path":for(var B=Ba(i.path),M=!0,o=o?C:g,p=p?u:k,u=0,C=B[j];u<C;u++){var s=B[u],O=la.call(s[0]);if(!("M"==O&&M))if(M=!1,"A"==O)s[B[u][j]-2]*=
o,s[B[u][j]-1]*=p,s[1]*=g,s[2]*=k,s[5]=+(r+n?!!+s[5]:!+s[5]);else if("H"==O)for(var O=1,P=s[j];O<P;O++)s[O]*=o;else if("V"==O)for(O=1,P=s[j];O<P;O++)s[O]*=p;else for(O=1,P=s[j];O<P;O++)s[O]*=O%2?o:p}k=ra(B);g=l-k.x-k.width/2;k=m-k.y-k.height/2;B[0][1]+=g;B[0][2]+=k;this.attr({path:B})}this.type in{text:1,image:1}&&(1!=r||1!=n)?this.transformations?(this.transformations[2]="scale(".concat(r,",",n,")"),this.node.setAttribute("transform",this.transformations[y](f)),g=-1==r?-i.x-(K||0):i.x,k=-1==n?-i.y-
(z||0):i.y,this.attr({x:g,y:k}),i.fx=r-1,i.fy=n-1):(this.node.filterMatrix=" progid:DXImageTransform.Microsoft"+".Matrix(M11=".concat(r,", M12=0, M21=0, M22=",n,", Dx=0, Dy=0, sizingmethod='auto expand', filtertype='bilinear')"),q.filter=(this.node.filterMatrix||"")+(this.node.filterOpacity||"")):this.transformations?(this.transformations[2]="",this.node.setAttribute("transform",this.transformations[y](f)),i.fx=0,i.fy=0):(this.node.filterMatrix="",q.filter=(this.node.filterMatrix||"")+(this.node.filterOpacity||
""));i.scale=[a,d,c,e][y](f);this._.sx=a;this._.sy=d}return this};N.clone=function(){if(this.removed)return null;var a=this.attr();delete a.scale;delete a.translation;return this.paper[this.type]().attr(a)};var Ga={},ua=function(a,d,c,e,j,g,f,h,r){var m=0,l=100,o=[a,d,c,e,j,g,f,h].join(),p=Ga[o],y,n;!p&&(Ga[o]=p={data:[]});p.timer&&clearTimeout(p.timer);p.timer=setTimeout(function(){delete Ga[o]},2E3);null!=r&&(l=10*~~ua(a,d,c,e,j,g,f,h));for(var u=0;u<l+1;u++){p.data[r]>u?n=p.data[u*l]:(n=i.findDotsAtSegment(a,
d,c,e,j,g,f,h,u/l),p.data[u]=n);u&&(m+=P(P(y.x-n.x,2)+P(y.y-n.y,2),0.5));if(null!=r&&m>=r)return n;y=n}if(null==r)return m},Ha=function(a,d){return function(c,e,j){for(var c=qa(c),g,f,h,r,m="",l={},p=0,o=0,n=c.length;o<n;o++){h=c[o];if("M"==h[0])g=+h[1],f=+h[2];else{r=ua(g,f,h[1],h[2],h[3],h[4],h[5],h[6]);if(p+r>e){if(d&&!l.start){g=ua(g,f,h[1],h[2],h[3],h[4],h[5],h[6],e-p);m+=["C",g.start.x,g.start.y,g.m.x,g.m.y,g.x,g.y];if(j)return m;l.start=m;m=["M",g.x,g.y+"C",g.n.x,g.n.y,g.end.x,g.end.y,h[5],
h[6]][y]();p+=r;g=+h[5];f=+h[6];continue}if(!a&&!d)return g=ua(g,f,h[1],h[2],h[3],h[4],h[5],h[6],e-p),{x:g.x,y:g.y,alpha:g.alpha}}p+=r;g=+h[5];f=+h[6]}m+=h}l.end=m;g=a?p:d?l:i.findDotsAtSegment(g,f,h[1],h[2],h[3],h[4],h[5],h[6],1);g.alpha&&(g={x:g.x,y:g.y,alpha:g.alpha});return g}},hb=Ha(1),va=Ha(),Ia=Ha(0,1);N.getTotalLength=function(){if("path"==this.type)return this.node.getTotalLength?this.node.getTotalLength():hb(this.attrs.path)};N.getPointAtLength=function(a){return"path"!=this.type?void 0:
va(this.attrs.path,a)};N.getSubpath=function(a,d){if("path"==this.type){if("1e-6">T(this.getTotalLength()-d))return Ia(this.attrs.path,a).end;var c=Ia(this.attrs.path,d,1);return a?Ia(c,a).end:c}};i.easing_formulas={linear:function(a){return a},"<":function(a){return P(a,3)},">":function(a){return P(a-1,3)+1},"<>":function(a){a*=2;return 1>a?P(a,3)/2:(P(a-2,3)+2)/2},backIn:function(a){return a*a*(2.70158*a-1.70158)},backOut:function(a){a-=1;return a*a*(2.70158*a+1.70158)+1},elastic:function(a){return 0==
a||1==a?a:P(2,-10*a)*B.sin((a-0.075)*2*V/0.3)+1},bounce:function(a){a<1/2.75?a*=7.5625*a:a<2/2.75?(a-=1.5/2.75,a=7.5625*a*a+0.75):a<2.5/2.75?(a-=2.25/2.75,a=7.5625*a*a+0.9375):(a-=2.625/2.75,a=7.5625*a*a+0.984375);return a}};var ca=[],ib=function(){for(var d=+new Date,c=0;c<ca[j];c++){var e=ca[c];if(!e.stop&&!e.el.removed){var g=d-e.start,h=e.ms,k=e.easing,r=e.from,l=e.diff,p=e.to,m=e.t,o=e.el,e={},n;if(g<h){var g=k(g/h),u;for(u in r)if(r[a](u)){switch(ya[u]){case "along":n=g*h*l[u];p.back&&(n=p.len-
n);k=va(p[u],n);o.translate(l.sx-l.x||0,l.sy-l.y||0);l.x=k.x;l.y=k.y;o.translate(k.x-l.sx,k.y-l.sy);p.rot&&o.rotate(l.r+k.alpha,k.x,k.y);break;case U:n=+r[u]+g*h*l[u];break;case "colour":n="rgb("+[Ja(G(r[u].r+g*h*l[u].r)),Ja(G(r[u].g+g*h*l[u].g)),Ja(G(r[u].b+g*h*l[u].b))][y](",")+")";break;case "path":n=[];for(var k=0,C=r[u][j];k<C;k++){n[k]=[r[u][k][0]];for(var B=1,q=r[u][k][j];B<q;B++)n[k][B]=+r[u][k][B]+g*h*l[u][k][B];n[k]=n[k][y](f)}n=n[y](f);break;case "csv":switch(u){case "translation":n=g*
h*l[u][0]-m.x;k=g*h*l[u][1]-m.y;m.x+=n;m.y+=k;n=n+f+k;break;case "rotation":n=+r[u][0]+g*h*l[u][0];r[u][1]&&(n+=","+r[u][1]+","+r[u][2]);break;case "scale":n=[+r[u][0]+g*h*l[u][0],+r[u][1]+g*h*l[u][1],2 in p[u]?p[u][2]:"",3 in p[u]?p[u][3]:""][y](f);break;case "clip-rect":n=[];for(k=4;k--;)n[k]=+r[u][k]+g*h*l[u][k]}break;default:C=[].concat(r[u]);n=[];for(k=o.paper.customAttributes[u].length;k--;)n[k]=+C[k]+g*h*l[u][k]}e[u]=n}o.attr(e);o._run&&o._run.call(o)}else p.along&&(k=va(p.along,p.len*!p.back),
o.translate(l.sx-(l.x||0)+k.x-l.sx,l.sy-(l.y||0)+k.y-l.sy),p.rot&&o.rotate(l.r+k.alpha,k.x,k.y)),(m.x||m.y)&&o.translate(-m.x,-m.y),p.scale&&(p.scale+=""),o.attr(p),ca.splice(c--,1)}}i.svg&&o&&o.paper&&o.paper.safari();ca[j]&&setTimeout(ib)},Db=function(a,d,c,e,g){var j=c-e;d.timeouts.push(setTimeout(function(){i.is(g,"function")&&g.call(d);d.animate(a,j,a.easing)},e))},Ja=function(a){return u(O(a,255),0)},ta=function(a,d){if(null==a)return{x:this._.tx,y:this._.ty,toString:h};this._.tx+=+a;this._.ty+=
+d;switch(this.type){case "circle":case "ellipse":this.attr({cx:+a+this.attrs.cx,cy:+d+this.attrs.cy});break;case "rect":case "image":case "text":this.attr({x:+a+this.attrs.x,y:+d+this.attrs.y});break;case "path":var c=Ba(this.attrs.path);c[0][1]+=+a;c[0][2]+=+d;this.attr({path:c})}return this};N.animateWith=function(a,d,c,e,g){for(var j=0,f=ca.length;j<f;j++)ca[j].el.id==a.id&&(d.start=ca[j].start);return this.animate(d,c,e,g)};N.animateAlong=s();N.animateAlongBack=s(1);N.onAnimation=function(a){this._run=
a||0;return this};N.animate=function(d,e,g,f){var h=this;h.timeouts=h.timeouts||[];if(i.is(g,"function")||!g)f=g||null;if(h.removed)return f&&f.call(h),h;var k={},r={},l=!1,o={},m;for(m in d)if(d[a](m)&&(ya[a](m)||h.paper.customAttributes[a](m)))switch(l=!0,k[m]=h.attr(m),null==k[m]&&(k[m]=ma[m]),r[m]=d[m],ya[m]){case "along":var n=hb(d[m]),u=va(d[m],n*!!d.back),y=h.getBBox();o[m]=n/e;o.tx=y.x;o.ty=y.y;o.sx=u.x;o.sy=u.y;r.rot=d.rot;r.back=d.back;r.len=n;d.rot&&(o.r=J(h.rotate())||0);break;case U:o[m]=
(r[m]-k[m])/e;break;case "colour":k[m]=i.getRGB(k[m]);n=i.getRGB(r[m]);o[m]={r:(n.r-k[m].r)/e,g:(n.g-k[m].g)/e,b:(n.b-k[m].b)/e};break;case "path":n=qa(k[m],r[m]);k[m]=n[0];y=n[1];o[m]=[];n=0;for(u=k[m][j];n<u;n++){o[m][n]=[0];for(var C=1,B=k[m][n][j];C<B;C++)o[m][n][C]=(y[n][C]-k[m][n][C])/e}break;case "csv":u=A(d[m]).split(p);y=A(k[m]).split(p);switch(m){case "translation":k[m]=[0,0];o[m]=[u[0]/e,u[1]/e];break;case "rotation":k[m]=y[1]==u[1]&&y[2]==u[2]?y:[0,u[1],u[2]];o[m]=[(u[0]-k[m][0])/e,0,
0];break;case "scale":d[m]=u;k[m]=A(k[m]).split(p);o[m]=[(u[0]-k[m][0])/e,(u[1]-k[m][1])/e,0,0];break;case "clip-rect":k[m]=A(k[m]).split(p);o[m]=[];for(n=4;n--;)o[m][n]=(u[n]-k[m][n])/e}r[m]=u;break;default:u=[].concat(d[m]);y=[].concat(k[m]);o[m]=[];for(n=h.paper.customAttributes[m][j];n--;)o[m][n]=((u[n]||0)-(y[n]||0))/e}if(l){m=i.easing_formulas[g];if(!m)if((m=A(g).match(L))&&5==m[j]){var q=m;m=function(a){return c(a,+q[1],+q[2],+q[3],+q[4],e)}}else m=function(a){return a};ca.push({start:d.start||
+new Date,ms:e,easing:m,from:k,diff:o,to:r,el:h,t:{x:0,y:0}});i.is(f,"function")&&(h._ac=setTimeout(function(){f.call(h)},e));1==ca[j]&&setTimeout(ib)}else{var g=[],K,z;for(z in d)if(d[a](z)&&kb.test(z))m={value:d[z]},"from"==z&&(z=0),"to"==z&&(z=100),m.key=$(z,10),g.push(m);g.sort(pb);g[0].key&&g.unshift({key:0,value:h.attrs});for(n=0,u=g[j];n<u;n++)Db(g[n].value,h,e/100*g[n].key,e/100*(g[n-1]&&g[n-1].key||0),g[n-1]&&g[n-1].value.callback);(K=g[g[j]-1].value.callback)&&h.timeouts.push(setTimeout(function(){K.call(h)},
e))}return this};N.stop=function(){for(var a=0;a<ca.length;a++)ca[a].el.id==this.id&&ca.splice(a--,1);for(a=0,ii=this.timeouts&&this.timeouts.length;a<ii;a++)clearTimeout(this.timeouts[a]);this.timeouts=[];clearTimeout(this._ac);delete this._ac;return this};N.translate=function(a,d){return this.attr({translation:a+" "+d})};N[da]=function(){return"Rapha\u00ebl\u2019s object"};i.ae=ca;var aa=function(a){this.items=[];this[j]=0;this.type="set";if(a)for(var d=0,c=a[j];d<c;d++)if(a[d]&&(a[d].constructor==
S||a[d].constructor==aa))this[this.items[j]]=this.items[this.items[j]]=a[d],this[j]++};aa[l][F]=function(){for(var a,d,c=0,e=arguments[j];c<e;c++)if((a=arguments[c])&&(a.constructor==S||a.constructor==aa))d=this.items[j],this[d]=this.items[d]=a,this[j]++;return this};aa[l].pop=function(){delete this[this[j]--];return this.items.pop()};for(var Ka in N)N[a](Ka)&&(aa[l][Ka]=function(a){return function(){for(var d=0,c=this.items[j];d<c;d++)this.items[d][a][D](this.items[d],arguments);return this}}(Ka));
aa[l].attr=function(a,d){if(a&&i.is(a,Y)&&i.is(a[0],"object"))for(var c=0,e=a[j];c<e;c++)this.items[c].attr(a[c]);else{c=0;for(e=this.items[j];c<e;c++)this.items[c].attr(a,d)}return this};aa[l].animate=function(a,d,c,e){(i.is(c,"function")||!c)&&(e=c||null);var g=this.items[j],f=g,h,r=this,l;e&&(l=function(){!--g&&e.call(r)});c=i.is(c,"string")?c:l;for(h=this.items[--f].animate(a,d,c,l);f--;)this.items[f]&&!this.items[f].removed&&this.items[f].animateWith(h,a,d,c,l);return this};aa[l].insertAfter=
function(a){for(var d=this.items[j];d--;)this.items[d].insertAfter(a);return this};aa[l].getBBox=function(){for(var a=[],d=[],c=[],e=[],g=this.items[j];g--;){var f=this.items[g].getBBox();a[F](f.x);d[F](f.y);c[F](f.x+f.width);e[F](f.y+f.height)}a=O[D](0,a);d=O[D](0,d);return{x:a,y:d,width:u[D](0,c)-a,height:u[D](0,e)-d}};aa[l].clone=function(a){for(var a=new aa,d=0,c=this.items[j];d<c;d++)a[F](this.items[d].clone());return a};i.registerFont=function(d){if(!d.face)return d;this.fonts=this.fonts||{};
var c={w:d.w,face:{},glyphs:{}},e=d.face["font-family"],g;for(g in d.face)d.face[a](g)&&(c.face[g]=d.face[g]);this.fonts[e]?this.fonts[e][F](c):this.fonts[e]=[c];if(!d.svg){c.face["units-per-em"]=$(d.face["units-per-em"],10);for(var j in d.glyphs)if(d.glyphs[a](j)&&(e=d.glyphs[j],c.glyphs[j]={w:e.w,k:{},d:e.d&&"M"+e.d.replace(/[mlcxtrv]/g,function(a){return{l:"L",c:"C",x:"z",t:"m",r:"l",v:"c"}[a]||"M"})+"z"},e.k))for(var f in e.k)e[a](f)&&(c.glyphs[j].k[f]=e.k[f])}return d};z.getFont=function(d,c,
e,g){g=g||"normal";e=e||"normal";c=+c||{normal:400,bold:700,lighter:300,bolder:800}[c]||400;if(i.fonts){var f=i.fonts[d];if(!f){var d=RegExp("(^|\\s)"+d.replace(/[^\w\d\s+!~.:_-]/g,"")+"(\\s|$)","i"),h;for(h in i.fonts)if(i.fonts[a](h)&&d.test(h)){f=i.fonts[h];break}}var r;if(f){h=0;for(d=f[j];h<d&&!(r=f[h],r.face["font-weight"]==c&&(r.face["font-style"]==e||!r.face["font-style"])&&r.face["font-stretch"]==g);h++);}return r}};z.print=function(a,d,c,e,g,f,h){var f=f||"middle",h=u(O(h||0,1),-1),r=this.set(),
l=A(c).split(""),m=0;i.is(e,c)&&(e=this.getFont(e));if(e){for(var c=(g||16)/e.face["units-per-em"],o=e.face.bbox.split(p),g=+o[0],f=+o[1]+("baseline"==f?o[3]-o[1]+ +e.face.descent:(o[3]-o[1])/2),o=0,n=l[j];o<n;o++){var y=o&&e.glyphs[l[o-1]]||{},C=e.glyphs[l[o]],m=m+(o?(y.w||e.w)+(y.k&&y.k[l[o]]||0)+e.w*h:0);C&&C.d&&r[F](this.path(C.d).attr({fill:"#000",stroke:"none",translation:[m,0]}))}r.scale(c,c,g,f).translate(a-g,d-f)}return r};i.format=function(a,d){var c=i.is(d,Y)?[0].concat(d):arguments;a&&
i.is(a,"string")&&c[j]-1&&(a=a.replace(g,function(a,d){return null==c[++d]?"":c[d]}));return a||""};i.ninja=function(){K?e.Raphael=o:delete Raphael;return i};i.el=N;i.st=aa[l];K?e.Raphael=i:Raphael=i})();(function(){function i(a){return(a+"").replace(D,"")}function w(a,d,c){for(var e=a.length;e<d;e++)a=c?"0"+a:a+"0";return a}function q(a){return"[object Array]"===I.call(a)}function h(a,d){if(a.indexOf)return a.indexOf(d);for(var c=0,e=a.length;c<e;c++)if(a[c]===d)return c;return-1}function s(a,d,c){var e=d["-"],d=d["+"],g;switch(c){case "n -":e=" "+e,d=" "+d;case "n-":a.substr(a.length-e.length)===e?g=["-",a.substr(0,a.length-e.length)]:a.substr(a.length-d.length)===d&&(g=["+",a.substr(0,a.length-
d.length)]);break;case "- n":e+=" ",d+=" ";case "-n":0===a.indexOf(e)?g=["-",a.substr(e.length)]:0===a.indexOf(d)&&(g=["+",a.substr(d.length)]);break;case "(n)":0===a.indexOf("(")&&")"===a.substr(a.length-1)&&(g=["-",a.substr(1,a.length-2)])}return g||["",a]}function c(a,d){if(!d)return 0;for(var c,e=a.getTime(),g=0,f=d.length;g<f;g++)if(c=d[g].start,null===c||e>=c)return g;return 0}function p(a){return a.split("\u00a0").join(" ").toUpperCase()}function n(a){for(var d=[],c=0,e=a.length;c<e;c++)d[c]=
p(a[c]);return d}function g(a,d,c,e){a=a.getFullYear();!e&&d.eras&&(a-=d.eras[c].offset);return a}function l(a,d){for(var c=0,e=!1,g=0,f=a.length;g<f;g++){var h=a.charAt(g);switch(h){case "'":e?d.push("'"):c++;e=!1;break;case "\\":e&&d.push("\\");e=!e;break;default:d.push(h),e=!1}}return c}function a(a,d){var d=d||"F",c;c=a.patterns;var e=d.length;if(1===e){c=c[d];if(!c)throw"Invalid date format string '"+d+"'.";d=c}else 2===e&&"%"===d.charAt(0)&&(d=d.charAt(1));return d}function d(){return/\/|dddd|ddd|dd|d|MMMM|MMM|MM|M|yyyy|yy|y|hh|h|HH|H|mm|m|ss|s|tt|t|fff|ff|f|zzz|zz|z|gg|g/g}
function e(e,f,j){e=i(e);j=j.calendar;a:{var o=j._parseRegExp;if(o){var q=o[f];if(q){f=q;break a}}else j._parseRegExp=o={};for(var q=a(j,f).replace(/([\^\$\.\*\+\?\|\[\]\(\)\{\}])/g,"\\\\$1"),u=["^"],K=[],z=0,s=0,M=d(),D;null!==(D=M.exec(q));){var H=q.slice(z,D.index),z=M.lastIndex,s=s+l(H,u);if(s%2)u.push(D[0]);else{var H=D[0],A=H.length;switch(H){case "dddd":case "ddd":case "MMMM":case "MMM":case "gg":case "g":H="(\\D+)";break;case "tt":case "t":H="(\\D*)";break;case "yyyy":case "fff":case "ff":case "f":H=
"(\\d{"+A+"})";break;case "dd":case "d":case "MM":case "M":case "yy":case "y":case "HH":case "H":case "hh":case "h":case "mm":case "m":case "ss":case "s":H="(\\d\\d?)";break;case "zzz":H="([+-]?\\d\\d?:\\d{2})";break;case "zz":case "z":H="([+-]?\\d\\d?)";break;case "/":H="(\\"+j["/"]+")";break;default:throw"Invalid date format pattern '"+H+"'.";}H&&u.push(H);K.push(D[0])}}l(q.slice(z),u);u.push("$");q={regExp:u.join("").replace(/\s+/g,"\\s+"),groups:K};f=o[f]=q}s=RegExp(f.regExp).exec(e);if(null===
s)return null;var M=f.groups,w=e=null,F=null,I=f=null,K=u=q=o=0;D=null;z=!1;H=0;for(A=M.length;H<A;H++){var R=s[H+1];if(R){var Z=M[H],L=Z.length,G=parseInt(R,10);switch(Z){case "dd":case "d":f=G;if(1>f||31<f)return null;break;case "MMM":case "MMMM":var F=j,L=3===L,Z=F.months,J=F.monthsGenitive||F.months,$=F._upperMonths,G=F._upperMonthsGen;if(!$)F._upperMonths=$=[n(Z.names),n(Z.namesAbbr)],F._upperMonthsGen=G=[n(J.names),n(J.namesAbbr)];R=p(R);F=h(L?$[1]:$[0],R);0>F&&(F=h(L?G[1]:G[0],R));if(0>F||
11<F)return null;break;case "M":case "MM":F=G-1;if(0>F||11<F)return null;break;case "y":case "yy":case "yyyy":if(4>L){w=j;R=G;G=new Date;Z=c(G);if(100>R)L=w.twoDigitYearMax,L="string"===typeof L?(new Date).getFullYear()%100+parseInt(L,10):L,w=g(G,w,Z),R+=w-w%100,R>L&&(R-=100);w=R}else w=G;if(0>w||9999<w)return null;break;case "h":case "hh":o=G;12===o&&(o=0);if(0>o||11<o)return null;break;case "H":case "HH":o=G;if(0>o||23<o)return null;break;case "m":case "mm":q=G;if(0>q||59<q)return null;break;case "s":case "ss":u=
G;if(0>u||59<u)return null;break;case "tt":case "t":z=j.PM&&(R===j.PM[0]||R===j.PM[1]||R===j.PM[2]);if(!z&&(!j.AM||R!==j.AM[0]&&R!==j.AM[1]&&R!==j.AM[2]))return null;break;case "f":case "ff":case "fff":K=G*Math.pow(10,3-L);if(0>K||999<K)return null;break;case "ddd":case "dddd":I=R;R=3===L;G=void 0;G=j.days;L=j._upperDays;if(!L)j._upperDays=L=[n(G.names),n(G.namesAbbr),n(G.namesShort)];I=p(I);R?(G=h(L[1],I),-1===G&&(G=h(L[2],I))):G=h(L[0],I);I=G;if(0>I||6<I)return null;break;case "zzz":L=R.split(/:/);
if(2!==L.length)return null;D=parseInt(L[0],10);if(-12>D||13<D)return null;L=parseInt(L[1],10);if(0>L||59<L)return null;D=60*D+(0===R.indexOf("-")?-L:L);break;case "z":case "zz":D=G;if(-12>D||13<D)return null;D*=60;break;case "g":case "gg":if(!R||!j.eras)return null;R=i(R.toLowerCase());L=0;for(G=j.eras.length;L<G;L++)if(R===j.eras[L].name.toLowerCase()){e=L;break}if(null===e)return null}}}s=new Date;M=(H=j.convert)?H.fromGregorian(s)[0]:s.getFullYear();null===w?w=M:j.eras&&(w+=j.eras[e||0].offset);
null===F&&(F=0);null===f&&(f=1);if(H){if(s=H.toGregorian(w,F,f),null===s)return null}else if(s.setFullYear(w,F,f),s.getDate()!==f||null!==I&&s.getDay()!==I)return null;z&&12>o&&(o+=12);s.setHours(o,q,u,K);null!==D&&(j=s.getMinutes()-(D+s.getTimezoneOffset()),s.setHours(s.getHours()+parseInt(j/60,10),j%60));return s}function K(e,f,j){function h(a,d){var c;c=a+"";return 1<d&&c.length<d?(c=M[d-2]+c,c.substr(c.length-d,d)):c}function i(){if(H||D)return H;H=w.test(f);D=!0;return H}function o(a,d){if(Z)return Z[d];
switch(d){case 0:return a.getFullYear();case 1:return a.getMonth();case 2:return a.getDate()}}var p=j.calendar,n=p.convert;if(!f||!f.length||"i"===f){if(j&&j.name.length)if(n)j=K(e,p.patterns.F,j);else{var j=new Date(e.getTime()),q=c(e,p.eras);j.setFullYear(g(e,p,q));j=j.toLocaleString()}else j=e.toString();return j}var q=p.eras,z="s"===f,f=a(p,f),j=[],s,M=["0","00","000"],H,D,w=/([^d]|^)(d|dd)([^d]|$)/g,A=0,I=d(),Z;for(!z&&n&&(Z=n.fromGregorian(e));;){s=I.lastIndex;n=I.exec(f);s=f.slice(s,n?n.index:
f.length);A+=l(s,j);if(!n)break;if(A%2)j.push(n[0]);else switch(s=n[0],n=s.length,s){case "ddd":case "dddd":j.push((3===n?p.days.namesAbbr:p.days.names)[e.getDay()]);break;case "d":case "dd":H=!0;j.push(h(o(e,2),n));break;case "MMM":case "MMMM":s=o(e,1);j.push(p.monthsGenitive&&i()?p.monthsGenitive[3===n?"namesAbbr":"names"][s]:p.months[3===n?"namesAbbr":"names"][s]);break;case "M":case "MM":j.push(h(o(e,1)+1,n));break;case "y":case "yy":case "yyyy":s=Z?Z[0]:g(e,p,c(e,q),z);4>n&&(s%=100);j.push(h(s,
n));break;case "h":case "hh":s=e.getHours()%12;0===s&&(s=12);j.push(h(s,n));break;case "H":case "HH":j.push(h(e.getHours(),n));break;case "m":case "mm":j.push(h(e.getMinutes(),n));break;case "s":case "ss":j.push(h(e.getSeconds(),n));break;case "t":case "tt":s=12>e.getHours()?p.AM?p.AM[0]:" ":p.PM?p.PM[0]:" ";j.push(1===n?s.charAt(0):s);break;case "f":case "ff":case "fff":j.push(h(e.getMilliseconds(),3).substr(0,n));break;case "z":case "zz":s=e.getTimezoneOffset()/60;j.push((0>=s?"+":"-")+h(Math.floor(Math.abs(s)),
n));break;case "zzz":s=e.getTimezoneOffset()/60;j.push((0>=s?"+":"-")+h(Math.floor(Math.abs(s)),2)+":"+h(Math.abs(e.getTimezoneOffset()%60),2));break;case "g":case "gg":p.eras&&j.push(p.eras[c(e,q)].name);break;case "/":j.push(p["/"]);break;default:throw"Invalid date format pattern '"+s+"'.";}}return j.join("")}var o={},M={en:{}};M["default"]=M.en;o.extend=function(a){for(var d=arguments[1]||{},c=2,e=arguments.length;c<e;c++){var g=arguments[c];if(g)for(var f in g){var h=g[f];if("undefined"!==typeof h)if(a&&
("[object Object]"===I.call(h)||q(h))){var i=d[f],i=i&&("[object Object]"===I.call(i)||q(i))?i:q(h)?[]:{};d[f]=this.extend(!0,i,h)}else d[f]=h}}return d};o.findClosestCulture=function(a){var d;if(!a)return this.culture||this.cultures["default"];"[object String]"===I.call(a)&&(a=a.split(","));if(q(a)){var c,e=this.cultures,g=a,f,h=g.length,l=[];for(f=0;f<h;f++)a=i(g[f]),a=a.split(";"),c=i(a[0]),1===a.length?a=1:(a=i(a[1]),0===a.indexOf("q=")?(a=a.substr(2),a=parseFloat(a,10),a=isNaN(a)?0:a):a=1),l.push({lang:c,
pri:a});l.sort(function(a,d){return a.pri<d.pri?1:-1});for(f=0;f<h;f++)if(c=l[f].lang,d=e[c])return d;for(f=0;f<h;f++){c=l[f].lang;do{g=c.lastIndexOf("-");if(-1===g)break;c=c.substr(0,g);if(d=e[c])return d}while(1)}for(f=0;f<h;f++){c=l[f].lang;for(var o in e)if(g=e[o],g.language==c)return g}}else if("object"===typeof a)return a;return d||null};o.preferCulture=function(a){this.culture=this.findClosestCulture(a)||this.cultures["default"]};o.localize=function(a,d,c){"string"!==typeof d&&(d=this.culture.name||
this.culture||"default");var d=this.cultures[d]||{name:d},e=M[d.name];3===arguments.length?(e||(e=M[d.name]={}),e[a]=c):(e&&(c=e[a]),"undefined"===typeof c&&((e=M[d.language])&&(c=e[a]),"undefined"===typeof c&&(c=M["default"][a])));return"undefined"===typeof c?null:c};o.format=function(a,d,c){c=this.findClosestCulture(c);if("number"===typeof a){var e=a;if(!d||"i"===d)a=c.name.length?e.toLocaleString():e.toString();else{var d=d||"D",c=c.numberFormat,a=Math.abs(e),g=-1;1<d.length&&(g=parseInt(d.slice(1),
10));var f=d.charAt(0).toUpperCase(),h;switch(f){case "D":d="n";-1!==g&&(a=w(""+a,g,!0));0>e&&(a=-a);break;case "N":h=c;case "C":h=h||c.currency;case "P":h=h||c.percent;d=0>e?h.pattern[0]:h.pattern[1]||"n";if(-1===g)g=h.decimals;b:{var i=a*("P"===f?100:1),f=h;h=f.groupSizes;var a=h[0],e=1,l=Math.pow(10,g),o=Math.round(i*l)/l;isFinite(o)||(o=i);l="";l=(o+"").split(/e/i);o=1<l.length?parseInt(l[1],10):0;i=l[0];l=i.split(".");i=l[0];l=1<l.length?l[1]:"";0<o?(l=w(l,o,!1),i+=l.slice(0,o),l=l.substr(o)):
0>o&&(o=-o,i=w(i,o+1),l=i.slice(-o,i.length)+l,i=i.slice(0,-o));l=0<g?f["."]+(l.length>g?l.slice(0,g):w(l,g)):"";g=i.length-1;f=f[","];for(o="";0<=g;){if(0===a||a>g){a=i.slice(0,g+1)+(o.length?f+o+l:l);break b}o=i.slice(g-a+1,g+1)+(o.length?f+o:"");g-=a;e<h.length&&(a=h[e],e++)}a=i.slice(0,g+1)+f+o+l}break;default:throw"Bad number format specifier: "+f;}h=/n|\$|-|%/g;for(e="";;){g=h.lastIndex;f=h.exec(d);e+=d.slice(g,f?f.index:d.length);if(!f)break;switch(f[0]){case "n":e+=a;break;case "$":e+=c.currency.symbol;
break;case "-":/[1-9]/.test(a)&&(e+=c["-"]);break;case "%":e+=c.percent.symbol}}a=e}}else a instanceof Date&&(a=K(a,d,c));return a};o.parseInt=function(a,d,c){return Math.floor(this.parseFloat(a,d,c))};o.parseFloat=function(a,d,c){"string"===typeof d&&(c=d,d=10);var c=this.findClosestCulture(c),e=NaN,g=c.numberFormat;-1<a.indexOf(c.numberFormat.currency.symbol)&&(a=a.replace(c.numberFormat.currency.symbol,""),a=a.replace(c.numberFormat.currency["."],c.numberFormat["."]));a=i(a);if(H.test(a))e=parseFloat(a,
d);else if(!d&&f.test(a))e=parseInt(a,16);else{c=s(a,g,g.pattern[0]);d=c[0];c=c[1];""===d&&"-n"!==g.pattern[0]&&(c=s(a,g,"-n"),d=c[0],c=c[1]);var d=d||"+",h,a=c.indexOf("e");0>a&&(a=c.indexOf("E"));0>a?(h=c,a=null):(h=c.substr(0,a),a=c.substr(a+1));var l=g["."],o=h.indexOf(l);0>o?(c=h,h=null):(c=h.substr(0,o),h=h.substr(o+l.length));l=g[","];c=c.split(l).join("");o=l.replace(/\u00A0/g," ");l!==o&&(c=c.split(o).join(""));d+=c;null!==h&&(d+="."+h);null!==a&&(g=s(a,g,"-n"),d+="e"+(g[0]||"+")+g[1]);A.test(d)&&
(e=parseFloat(d))}return e};o.parseDate=function(a,d,c){var c=this.findClosestCulture(c),g,f;if(d){if("string"===typeof d&&(d=[d]),d.length){f=0;for(var h=d.length;f<h;f++){var i=d[f];if(i&&(g=e(a,i,c)))break}}}else for(f in d=c.calendar.patterns,d)if(g=e(a,d[f],c))break;return g||null};var z=o.cultures=o.cultures||{},z=z["default"]=z.en=o.extend(!0,{name:"en",englishName:"English",nativeName:"English",isRTL:!1,language:"en",numberFormat:{pattern:["-n"],decimals:2,",":",",".":".",groupSizes:[3],"+":"+",
"-":"-",percent:{pattern:["-n %","n %"],decimals:2,groupSizes:[3],",":",",".":".",symbol:"%"},currency:{pattern:["($n)","$n"],decimals:2,groupSizes:[3],",":",",".":".",symbol:"$"}},calendars:{standard:{name:"Gregorian_USEnglish","/":"/",":":":",firstDay:0,days:{names:"Sunday,Monday,Tuesday,Wednesday,Thursday,Friday,Saturday".split(","),namesAbbr:"Sun,Mon,Tue,Wed,Thu,Fri,Sat".split(","),namesShort:"Su,Mo,Tu,We,Th,Fr,Sa".split(",")},months:{names:"January,February,March,April,May,June,July,August,September,October,November,December,".split(","),
namesAbbr:"Jan,Feb,Mar,Apr,May,Jun,Jul,Aug,Sep,Oct,Nov,Dec,".split(",")},AM:["AM","am","AM"],PM:["PM","pm","PM"],eras:[{name:"A.D.",start:null,offset:0}],twoDigitYearMax:2029,patterns:{d:"M/d/yyyy",D:"dddd, MMMM dd, yyyy",t:"h:mm tt",T:"h:mm:ss tt",f:"dddd, MMMM dd, yyyy h:mm tt",F:"dddd, MMMM dd, yyyy h:mm:ss tt",M:"MMMM dd",Y:"yyyy MMMM",S:"yyyy'-'MM'-'dd'T'HH':'mm':'ss"}}}},z.en);z.calendar=z.calendar||z.calendars.standard;var D=/^\s+|\s+$/g,H=/^[+-]?infinity$/i,f=/^0x[a-f0-9]+$/i,A=/^[+-]?\d*\.?\d*(e[+-]?\d+)?$/,
I=Object.prototype.toString;jQuery.global=o})();/*

 jQuery Tiny Pub/Sub - v0.3pre - 11/4/2010
 http://benalman.com/

 Copyright (c) 2010 "Cowboy" Ben Alman
 Dual licensed under the MIT and GPL licenses.
 http://benalman.com/about/license/
*/
(function(i){var w=i({});i.subscribe=function(){w.bind.apply(w,arguments)};i.unsubscribe=function(){w.unbind.apply(w,arguments)};i.publish=function(){w.trigger.apply(w,arguments)}})(jQuery);/*
 
 copyright 2011, Mnemograph LLC
 Timeglider for Javascript / jQuery 
 http://timeglider.com/jquery

 Licensed under the MIT open source license
 http://timeglider.com/jquery/?p=license

*/
var timeglider=window.timeglider={version:"0.1.0"};
(function(i){var i=timeglider,w=jQuery,q={},h={},s={},c={},p={};i.TG_Date=function(c,h){function a(a){var d=86400*Math.abs(a.rd),c=3600*a.ho,e=60*(a.mi-1),g=1;0>a.rd&&(g=-1);return g*(d+c+e)}var d,e,i;"number"==typeof c?(d=e=n.getDateFromSec(c),i=c):("today"==c&&(c=n.getToday()),d=e=c);if(!1===function(a){a=jQuery.trim(a);reg=RegExp(/[T0-9-: ]/);return reg.test(a)?a:!1}(d))return{error:"Invalid date"};d=d.replace(",","");"-"==d.substr(0,1)?(this.bce=1,d=d.substr(1)):this.bce=0;d=d.replace(/[^0-9]/g,
"-");d=d.split("-");this.ye=0===this.bce?parseInt(d[0],10):-1*parseInt(d[0],10);this.mo=parseInt(d[1],10);this.mo_num=0<this.ye?12*(this.ye-1)+this.mo:-1*(12*(Math.abs(this.ye)-1)+(12-(this.mo-1)));this.da=parseInt(d[2],10);this.ho=parseInt(d[3],10)||0;this.mi=parseInt(d[4],10)||0;this.se=parseInt(d[5],10)||0;this.rd=n.getRataDie(this);this.sec=i||a(this);this.date_display=h?h.toLowerCase().substr(0,2):"";this.jsDate=new Date(this.ye,this.mo-1,this.da,this.ho,this.mi,this.se,0);this.dateStr=e};var n=
i.TG_Date;n.getTimeUnitSerial=function(c,h){var a=0;switch(h){case "ye":a=c.ye;break;case "mo":a=c.mo_num;break;case "da":a=c.rd;break;case "de":a=Math.floor(c.ye/10);break;case "ce":a=Math.floor(c.ye/100);break;case "thou":a=Math.floor(c.ye/1E3);break;case "tenthou":a=Math.floor(c.ye/1E4);break;case "hundredthou":a=Math.floor(c.ye/1E5);break;case "mill":a=Math.floor(c.ye/1E6);break;case "tenmill":a=Math.floor(c.ye/1E7);break;case "hundredmill":a=Math.floor(c.ye/1E8);break;case "bill":a=Math.floor(c.ye/
1E9)}return a};n.getMonthDays=function(c,h){return!0==n.isLeapYear(h)&&2==c?29:n.monthsDayNums[c]};n.twentyFourToTwelve=function(c){var h={};h.ye=c.ye;h.mo=c.mo;h.da=c.da;h.ho=c.ho;h.mi=c.mi;h.ampm="am";c.ho?12<=c.ho?(h.ampm="pm",h.ho=12<c.ho?c.ho-12:12):0==c.ho?(h.ho=12,h.ampm="am"):h.ho=c.ho:(h.ho=12,h.mi=0,h.ampm="am");return h};n.getMonthAdj=function(c,h){var a=n.getDateFromMonthNum(c);switch(a.mo){case 1:case 3:case 5:case 7:case 8:case 10:case 12:return a=Math.floor(h+3*(h/28)),{width:a,days:31};
case 2:return!0==n.isLeapYear(a.ye)?(a=Math.floor(h+h/28),{width:a,days:29}):{width:h,days:28};default:return a=Math.floor(h+2*(h/28)),{width:a,days:30}}};n.getDateFromMonthNum=function(c){var h=0;0<c?(h=c%12,0==h&&(h=12),c=Math.ceil(c/12)):(h=Math.abs(c)%12,h=12-h+1,13==h&&(h=1),c=-1*Math.ceil(Math.abs(c)/12));return{ye:c,mo:h}};n.getMonthWidth=function(c,h,a){var h=t/28,d;switch(c){case 1:case 3:case 5:case 7:case 8:case 10:case 12:d=3;break;case 4:case 6:case 9:case 11:d=2;break;case 2:d=!0==n.isLeapYear(yr)?
1:0}return{width:Math.floor(a+h*d),numDays:28+d}};n.getToday=function(){var c=new Date;return c.getFullYear()+"-"+(c.getMonth()+1)+"-"+c.getDate()+" "+c.getHours()+":"+c.getMinutes()+":00"};n.getMonthFromRemDays=function(c,h){var a=0,d=a=0,a=n.isLeapYear(h)?1:0;31>=c?(d=1,a=c):31<c&&c<=59+a?(d=2,a=c-(31+a)):c>59+a&&c<=90+a?(d=3,a=c-(59+a)):c>90+a&&c<=120+a?(d=4,a=c-(90+a)):c>120+a&&c<=151+a?(d=5,a=c-(120+a)):c>151+a&&c<=181+a?(d=6,a=c-(151+a)):c>181+a&&c<=212+a?(d=7,a=c-(181+a)):c>212+a&&c<=243+a?
(d=8,a=c-(212+a)):c>243+a&&c<=273+a?(d=9,a=c-(243+a)):c>273+a&&c<=304+a?(d=10,a=c-(273+a)):c>304+a&&c<=334+a?(d=11,a=c-(304+a)):(d=12,a=c-(334+a));return{mo:d,da:a}};n.getDateFromRD=function(g){if(c[g])return c[g];for(var h=Math.floor(g),a=400*Math.floor(h/146097),d=h-146097*Math.floor(h/146097),e=1,i=a+1,o=i+400;i<=o;i++)365<d?(d-=365,n.isLeapYear(i)&&(d-=1),e++):i=o;a+=e;0==d&&(d=1);d=n.getMonthFromRemDays(d,a);e=1440*(g-h);h=Math.floor(e%60);e=Math.floor(e/60);n.isLeapYear(a)&&2==d.mo&&(d.da+=
1);h=a+"-"+d.mo+"-"+d.da+" "+e+":"+h+":00";return c[g]=h};n.getDateFromSec=function(c){if(p[c])return p[c];var h=n.getDateFromRD(c/86400);return p[c]=h};n.isLeapYear=function(c){return 0==c%400?!0:0==c%100?!1:0==c%4?!0:!1};n.getRataDie=function(c){function i(a,d){if(h[a+"-"+d])return h[a+"-"+d];for(var c=0,e=a;e<d;e++)c=n.isLeapYear(e)?c+366:c+365;return h[a+"-"+d]=c}function a(a,d){var c;switch(a){case 1:c=0;break;case 2:c=31;break;case 3:c=59;break;case 4:c=90;break;case 5:c=120;break;case 6:c=
151;break;case 7:c=181;break;case 8:c=212;break;case 9:c=243;break;case 10:c=273;break;case 11:c=304;break;case 12:c=334}2<a&&n.isLeapYear(d)&&(c+=1);return c}var d=c.ye,e=c.mo,c=c.da,p=0;if(q[d+"-"+e+"-"+c])return q[d+"-"+e+"-"+c];if(0<=d){0==d&&(d=1);var p=146097*Math.floor(d/400),o=parseInt(i(d-d%400,d)),s=parseInt(a(e,d)),p=p+o+s+c-366}else 0>d&&(p=n.getBCRataDie({ye:d,mo:e,da:c}));return q[d+"-"+e+"-"+c]=p};n.getBCRataDie=function(c){var h=c.ye,a=c.mo,c=c.da;if(s[h+"-"+a+"-"+c])return s[h+"-"+
a+"-"+c];0==a&&(a=1);0==c&&(c=1);var d=-1*(366*(Math.abs(h)-1)+[0,335,306,275,245,214,184,153,122,92,61,31,0][a]+(n.monthsDayNums[a]-c+1));return s[h+"-"+a+"-"+c]=d};n.setCulture=function(c){jQuery.global.culture=jQuery.global.cultures[c];n.monthNames=w.merge([""],jQuery.global.culture.calendar.months.names);n.monthNamesAbbr=w.merge([""],jQuery.global.culture.calendar.months.namesAbbr);n.monthNamesLet=",J,F,M,A,M,J,J,A,S,O,N,D".split(",");n.monthsDayNums=[0,31,28,31,30,31,30,31,31,30,31,30,31,29];
n.dayNames=jQuery.global.culture.calendar.days.names;n.dayNamesAbbr=jQuery.global.culture.calendar.days.namesAbbr;n.dayNamesShort=jQuery.global.culture.calendar.days.namesShort;n.units="da,mo,ye,de,ce,thou,tenthou,hundredthou,mill,tenmill,hundredmill,bill".split(",");n.patterns=jQuery.global.culture.calendar.patterns};n.prototype={format:function(c,h){if(!0==h)switch(this.date_display.substr(0,2)){case "no":return"";case "ye":c="yyyy";break;case "mo":c="Y";break;case "da":c="D";break;case "ho":c=
"f";break;default:c="f"}return w.global.format(this.jsDate,c)}}})(timeglider);(function(i){var w=i.levelHeight=10,q=jQuery;i.TG_Org=function(){this.blocks=[];this.ids=[];this.vis=[];this.tree=[];var h=this;this.addBlock=function(c,i){c.right=c.left+c.width;c.bottom=c.top+c.height;c.tickScope=i;h.blocks.push(c)};this.getBorg=function(){return this};this.getBlocks=function(){return this.blocks};this.getHTML=function(p,n){if("sweep"==p){h.tree=[];for(var g=0;300>g;g++)h.tree[g]=[];this.vis=[]}this.blocks.sort(i);var l,a="",d="";html="";b_htm="";b={};blength=this.blocks.length;
title_adj=0;for(var e=0;e<blength;e++)if(b=this.blocks[e],b.tickScope==p&&-1==q.inArray(b.id,this.vis))if(this.vis.push(b.id),title_adj=0,b.html&&"<div"==b.html.substr(0,4))b_htm="<div style='left:"+b.left+"px' id='ev_"+b.id+"'"+b.html.substr(4),html+=b_htm;else{b.image?("layout"==b.image.display_class&&(title_adj=b.image.height+4),a="<div class='timeglider-event-image-"+b.image.display_class+"'><img src='"+b.image.src+"'></div>"):a="";c(b,0);if(0<b.y_position)b.top=-1*b.y_position;10>b.fontsize?
b.opacity=b.fontsize/10:b.opacity=1;!0==b.span?(g="timeglider-event-spanning",l="<div class='timeglider-event-spanner' style='top:"+title_adj+"px;height:"+b.fontsize+"px;width:"+b.spanwidth+"px'></div>"):l=g="";d=b.icon?"<img class='timeglider-event-icon' src='"+b.icon+"' style='height:"+b.fontsize+"px;left:-"+(b.fontsize+2)+"px; top:"+title_adj+"px'>":"";html=Math.abs(b.top)>n-16?html+("<div class='timeglider-more-plus' style='left:"+b.left+"px; top:-"+(n-Math.floor(16/3))+"px'>+</div>"):html+("<div class='timeglider-timeline-event "+
g+"' id='ev_"+b.id+"' style='width:"+b.width+"px;height:"+b.height+"px;left:"+b.left+"px;opacity:"+b.opacity+";top:"+b.top+"px;font-size:"+b.fontsize+"px;'>"+d+a+l+"<div class='timeglider-event-title' style='top:"+title_adj+"px'>"+b.title+"</div></div>")}return html};var i=function(c,h){var g=h.importance,i=c.importance;return g<i?-1:g>i?1:0},c=function(i,n){var g=!1,l=h.tree,a=l[n],d=n+1,e=!1,q=2;bump_ht=w;if(void 0!=a){for(q=0;q<a.length;q++){a:{g=a[q];if(!(i.left>g.right||i.right<g.left))if(i.left>=
g.left&&i.left<=g.right||i.right>=g.left&&i.right<=g.right||i.right>=g.right&&i.left<=g.left||i.right<=g.right&&i.left>=g.left)if(i.bottom<=g.bottom&&i.bottom>=g.top||i.top<=g.bottom&&i.top>=g.top||i.top==g.bottom&&i.top==g.top){g=!0;break a}g=!1}if(!0==g){i.top-=bump_ht;i.bottom-=bump_ht;c(i,d);e=!0;break}}if(!1==e){i.top-=i.fontsize;a.push(i);q=Math.ceil(i.height/w);a=0;for(a=1;a<=q;a++)d=n+a,l[d].push(i)}}}}})(timeglider);(function(i){function w(h){function i(a,c){return function(){return c.apply(a,arguments)}}var g=new Image,l=h.id,a=g.src=h.src;g.onerror=i(g,function(){c.reportImageSize({id:h.id,src:a,error:!0})});g.onload=i(g,function(){c.reportImageSize({id:l,src:a,width:this.width,height:this.height})})}var q=i.TG_Date,h=jQuery,s={},c;i.TG_Timeline=Backbone.Model.extend({defaults:{title:"Untitled",events:[],legend:[]},_chewTimeline:function(p){c=p.mediator;s=c.options;var n={da:[],mo:[],ye:[],de:[],ce:[],thou:[],
tenthou:[],hundredthou:[],mill:[],tenmill:[],hundredmill:[],bill:[]},g=q.units;p.startSeconds=[];p.endSeconds=[];p.spans=[];p.hasImagesAbove=!1;if(!p.color)p.color="#333333";if(p.events){for(var l,a,d,e,K=p.events.length,o=0;o<K;o++){a=p.events[o];a.id?d=a.id:a.id=d="anon"+this.anonEventId++;l=a.date_display||a.date_limit||"da";a.date_display=l.toLowerCase().substr(0,2);a.startdateObj=new q(a.startdate,a.date_display);a.enddateObj=new q(a.enddate,a.date_display);a.icon=!a.icon||"none"===a.icon?"":
s.icon_folder+a.icon;a.titleWidth=i.getStringWidth(a.title);if(a.image){l=a.image_class||"layout";if("above"==a.image_class)p.hasImagesAbove=!0;a.image={id:a.id,src:a.image,display_class:l};w(a.image);c.imagesToSize++}p.startSeconds.push(a.startdateObj.sec);p.endSeconds.push(a.enddateObj.sec);a.enddateObj.sec>a.startdateObj.sec?(a.span=!0,p.spans.push({id:a.id,start:a.startdateObj.sec,end:a.enddateObj.sec})):a.span=!1;for(var M=g.length,z=0;z<M;z++)l=g[z],e=q.getTimeUnitSerial(a.startdateObj,l),void 0!==
n[l][e]?n[l][e].push(d):n[l][e]=[d];c.eventPool["ev_"+d]=a}g=h.merge(p.startSeconds,p.endSeconds);g=timeglider.getLowHigh(g);p.bounds={first:g.low,last:g.high}}if(0<p.legend.length){g=p.legend;for(a=0;a<g.length;a++);}p.display="expanded";p.dateHash=n;delete p.events;return p},initialize:function(c){this.set(this._chewTimeline(c))},validate:function(){}})})(timeglider);(function(i){var w=i.TG_Date,q="",h="",s={},c=jQuery,p={},n="",g,l;debug.trace=function(a,d){c("#"+d).text(a)};i.TG_TimelineView=function(a,d){var e=this;h=d;s=h.options;q="#"+a._id;n=a._id;this._views={PLACE:q,CONTAINER:q+" .timeglider-container",TIMELINE_MENU:q+" .timeglider-timeline-menu",TIMELINE_MENU_UL:q+" .timeglider-timeline-menu ul",TIMELINE_LIST_BT:q+" .timeglider-list-bt",SLIDER_CONTAINER:q+" .timeglider-slider-container",SLIDER:q+" .timeglider-slider",ZOOM_DISPLAY:q+" .timeglider-zoomlevel-display",
TRUCK:q+" .timeglider-truck",CENTERLINE:q+" .timeglider-centerline",TICKS:q+" .timeglider-ticks",HANDLE:q+" .timeglider-handle",FOOTER:q+" .timeglider-footer",TOOLS_BT:q+" .timeglider-tools-bt"};g=this._views.CONTAINER;l=this._views.TICKS;this._templates={};this._templates={test:"testola",event_modal:this.getEventModalTemplate(),event_modal_video:c.template(null,"<div class='tg-modal timeglider-ev-video-modal ui-widget-content' id='${id}_modal'><div class='close-button-remove'></div><iframe width = '100%' height='300' src='${video}'></iframe></div>"),
timeline_modal:c.template(null,"<div class='tg-modal timeglider-timeline-modal ui-widget-content' id='tl_${id}_modal'><div class='close-button-remove'></div><h4 id='title'>${title}</h4><p>{{html description}}</p></div>"),filter_modal:c.template(null,"<div class='tg-modal timeglider-menu-modal timeglider-filter-box timeglider-menu-hidden'><div class='close-button'></div><h3>filter</h3><div class='timeglider-menu-modal-content'><div class='timeglider-formline'>show: <input type='text' class='timeglider-filter-include'></div><div class='timeglider-formline'>hide: <input type='text' class='timeglider-filter-exclude'></div><ul><li class='timeglider-filter-clear'>clear</li><li class='timeglider-filter-apply'>apply</li></ul></div><div class='timeglider-menu-modal-point-right'></div>"),
timeline_list_modal:c.template(null,"<div class='timeglider-menu-modal timeglider-timeline-menu timeglider-menu-hidden'><div class='close-button'></div><h3>timelines</h3><div class='timeglider-menu-modal-content'><ul></ul></div><div class='timeglider-menu-modal-point-right'></div>"),legend_modal:c.template(null,"<div class='timeglider-menu-modal timeglider-legend timeglider-menu-hidden'  id='${id}_legend'><div class='timeglider-menu-modal-content'><ul id='${id}'>{{html legend_list}}</ul><div class='timeglider-close-button-small timeglider-legend-close'></div><div class='timeglider-legend-all'>all</div></div></div>")};
c(g).css("height",c(q).height());this.basicFontSize=s.basic_fontsize;!1==s.show_footer&&c(this._views.FOOTER).css("display","none");this.dragSpeed=0;this.dimensions=this.getWidgetDimensions();this.ticksHandleOffset=this.rightside=this.leftside=this.tickNum=0;this.timeoout_id=1;this.sliderActive=!1;this.ztop=1E3;this.filterBoxActivated=!1;this.buildSlider();c.subscribe("mediator.timelineDataLoaded",function(){c(".timeglider-loading").fadeOut(500)});c.subscribe("mediator.ticksOffsetChange",function(){e.tickHangies();
e.registerTitles();e.registerDragging()});c.subscribe("mediator.zoomLevelChange",function(){e.tickNum=0;e.leftside=0;var a=h.getZoomLevel();c(e._views.SLIDER).slider("value",e.invSliderVal(a));e.displayZoomLevel(a);e.castTicks("zoomLevelChange")});c.subscribe("mediator.ticksReadySignal",function(){!0===h.ticksReady&&e.freshTimelines()});c.subscribe("mediator.refreshSignal",function(){e.tickNum=0;e.leftside=0;e.castTicks("refreshSignal")});c.subscribe("mediator.ticksArrayChange",function(){});c.subscribe("mediator.focusDateChange",
function(){});c.subscribe("mediator.timelineListChangeSignal",function(){e.buildTimelineMenu()});c.subscribe("mediator.activeTimelinesChange",function(){c(e._views.TIMELINE_MENU_UL+" li").each(function(){var a=c(this).attr("id");-1!=c.inArray(a,h.activeTimelines)?c(this).addClass("activeTimeline"):c(this).removeClass("activeTimeline")})});c.subscribe("mediator.filterChange",function(){});this.setPanButton(c(".timeglider-pan-right"),-30);this.setPanButton(c(".timeglider-pan-left"),30);c(this._views.TRUCK).dblclick(function(a){var d=
a.pageX-e.dimensions.container.offset.left-e.dimensions.container.width/2,c=h.getZoomInfo().spp,a=h.getFocusDate().sec,d=new w(Math.floor(a+d*c)),a=new w(a);debug.trace("DBLCLICK:"+a.mo+"-"+a.ye+" DBLCLICK:"+d.mo+"-"+d.ye,"note")}).bind("mousewheel",function(a,d){var c=Math.ceil(-1*3*d),e=h.getZoomLevel();h.setZoomLevel(e+c);return!1});c(l).draggable({axis:"x",drag:function(){h.setTicksOffset(c(this).position().left)},stop:function(){e.resetTicksHandle();e.registerDragging()}}).delegate(g+" .timeglider-timeline-event",
"click",function(){var a=c(this).attr("id"),d=h.eventPool[a];if(d.click_callback){var a=d.click_callback.split("."),g=a[0];if(2==a.length)window[g][a[1]](d);else window[g](d)}else e.eventModal(a)}).delegate(".timeglider-timeline-event","mouseover",function(){var a=c(this).attr("id"),a=h.eventPool[a];debug.trace("hover, title:"+a.title,"note");e.eventHover(c(this),a)}).delegate(".timeglider-timeline-event","mouseout",function(){var a=c(this).attr("id"),a=h.eventPool[a];debug.trace("hover, title:"+
a.title,"note");e.eventUnHover(c(this),a)}).delegate(".timeglider-event-collapsed","hover",function(){var a=c(this).attr("id");debug.trace("collapsed, title:"+h.eventPool[a].title,"note")});c(g).delegate(".close-button-remove","click",function(){var a=c(this).parent().attr("id");c("#"+a).remove()});c(g).delegate(".full_modal_close","click",function(){c(".full_modal").remove()});c(g).delegate(".full_modal_scrim","click",function(){c(".full_modal").remove()});c(g).delegate(".timeglider-more-plus","click",
function(){h.zoom(-1)});c(g+" .timeglider-legend-close").live("click",function(){var a=c(g+" .timeglider-legend");a.fadeOut(300,function(){a.remove()})});c(g+" .timeglider-legend-all").live("click",function(){c(g+" .timeglider-legend li").each(function(){c(this).removeClass("tg-legend-icon-selected")});h.setFilters({origin:"legend",icon:"all"})});c.tmpl(e._templates.timeline_list_modal,{}).appendTo(g);c(e._views.TIMELINE_LIST_BT).click(function(){c(e._views.TIMELINE_MENU).toggleClass("timeglider-menu-hidden").position({my:"right bottom",
at:"right top",of:c(e._views.TIMELINE_LIST_BT),offset:"-8, -12"})});c(this._views.TIMELINE_MENU+" .close-button").live("click",function(){c(e._views.TIMELINE_MENU).toggleClass("timeglider-menu-hidden")});c(this._views.TOOLS_BT).click(function(){alert("I'm just a stand-in for the tools... ")});!0===h.options.show_centerline?c(this._views.CENTERLINE).css({height:e.dimensions.container.height,left:e.dimensions.container.centerx}):c(this._views.CENTERLINE).css({display:"none"});if(c.support.touch){c("#"+
n).addTouch();var i=document.getElementById(n);i.addEventListener("gesturestart",function(a){a.preventDefault();c("#output").append("<br>gesture zoom:"+h.getZoomLevel())},!1);i.addEventListener("gestureend",function(a){a.preventDefault();c("#output").append("<br>gesture end:"+h.getZoomLevel())},!1);i.addEventListener("gesturechange",function(a){a.preventDefault();c("#output").append("[l:r]")},!1)}};i.TG_TimelineView.prototype={getWidgetDimensions:function(){var a=c(g),d=a.width(),e=Math.floor(d/2)+
1,h=a.height(),i=Math.floor(h/2),l=a.position().left,a=a.offset(),n=!0==s.show_footer?c(this._views.FOOTER).height():0;return{container:{width:d,height:h,centerx:e,centery:i,left:l,offset:a},tick:{top:h-n-30},footer:{height:n}}},getEventModalTemplate:function(){var a=this,d=!1,e="",g=c.template(null,"<div class='tg-modal timeglider-ev-modal ui-widget-content' id='ev_${id}_modal'><div class='close-button-remove'></div><div class='startdate'>${startdate}</div><h4 id='title'>${title}</h4><p>{{html description}}</p><ul class='timeglider-ev-modal-links'>{{html links}}</ul></div>");
s.event_modal.href?c.ajax({url:s.event_modal.href,success:function(g){e=g.removeWhitespace();debug.log("stripped:"+e);a._templates.event_modal=d=c.template(null,e)},error:function(){a._templates.event_modal=d=g;debug.log("Custom event modal HTML file could not be found/loaded! Reverting to default.")}}):d=g;return d},scaleToImportance:function(a,d){return a/d},displayZoomLevel:function(a){0<a&&!0==s.display_zoom_level&&c(this._views.ZOOM_DISPLAY).text(a)},doSomething:function(){alert("FOO DO, viewer")},
setPanButton:function(a,d){var e=this;c(a).live("mousedown",function(){e.intervalMachine("pan",{type:"set",fn:e.pan,args:[d],intvl:33})}).live("mouseup",function(){e.intervalMachine("pan",{type:"clear",fn:e.pan,callback:"resetTicksHandle"})}).live("mouseout",function(){e.intervalMachine("pan",{type:"clear",fn:e.pan,callback:"resetTicksHandle"})})},intervalMachine:function(a,d){var c=this;if("clear"===d.type){if(clearInterval(p[a]),d.callback)c[d.callback]()}else p[a]=setInterval(function(){d.fn.apply(c,
d.args)},d.intvl)},invSliderVal:function(a){return Math.abs(a-101)},pan:function(a){a=a||20;$t=c(l);newPos=$t.position().left+a;$t.css({left:newPos});h.setTicksOffset(newPos)},registerTitles:function(){var a,d,e,h,i,l,n,p,q,f,s,w=c(g).offset().left;c(".timeglider-event-spanning").each(function(){a=c(this).offset().left-w;d=c(this).outerWidth();n=c(".timeglider-event-title",this);e=n.outerWidth()+5;h=n.siblings(".timeglider-event-spanner").outerWidth();h>e&&0>a&&Math.abs(a)<d-e&&n.css({marginLeft:-1*
a+5})});c(".tg-timeline-envelope").each(function(){p=c(this).offset().left-w;q=c(".titleBar",this);f=c(".titleBar .timeline-title",this);i=q.position().left;s=i+p;q.outerWidth();e=q.outerWidth();l=-1*s;0>s&&f.css({marginLeft:l+5})})},registerDragging:function(){var a=h.startSec,d=c(l).position().left,e=h.getZoomInfo().spp,a=new w(a-d*e);h.setFocusDate(a)},buildTimelineMenu:function(){var a,d=h.timelinePool,e=0;c(this._views.TIMELINE_MENU_UL+" li").remove();for(a in d){if(d.hasOwnProperty(a)){var g=
d[a];c(this._views.TIMELINE_MENU_UL).append("<li class = 'timelineList' id='"+a+"'>"+g.title+"</li>");c("li#"+a).click(function(){h.toggleTimeline(c(this).attr("id"))})}e++}},buildSlider:function(){var a=h.getZoomLevel();if(s.min_zoom==s.max_zoom)c(this._views.SLIDER_CONTAINER).css("display","none");else{!0==s.display_zoom_level&&c("<div>").appendTo(this._views.SLIDER_CONTAINER).addClass("timeglider-zoomlevel-display").html("&nbsp;");var d=this,a=d.invSliderVal(a),e=h.max_zoom,g=h.min_zoom;c(this._views.SLIDER).css("height",
3*(1+e-g)).slider({steps:100,handle:c(".knob"),animate:300,orientation:"vertical",min:d.invSliderVal(e),max:d.invSliderVal(g),value:a,start:function(){d.sliderActive=!0},stop:function(){d.sliderActive=!1},change:function(){},slide:function(a,c){h.setZoomLevel(d.invSliderVal(c.value))}})}},eventHover:function(a,d){var e=c(".timeglider-event-hover-info");"no"!=d.date_display&&e.position({my:"left bottom",at:"left top",of:a,offset:"1, -10",collision:"flip flip"}).text(d.startdateObj.format("D",!0));
a.addClass("tg-event-hovered")},eventUnHover:function(a){c(".timeglider-event-hover-info").css("left","-1000px");a.removeClass("tg-event-hovered")},setupFilter:function(){var a=this;c.tmpl(a._templates.filter_modal,{}).appendTo(a._views.CONTAINER);c(a._views.FILTER_BT).click(function(){var d=c(this),e=a._views.FILTER_BOX;if(!1==a.filterBoxActivated){a.filterBoxActivated=!0;var g=c(e+" .timeglider-filter-apply"),i=c(".timeglider-filter-box .close-button"),l=c(e+" .timeglider-filter-clear"),n="",p=
"";g.click(function(){n=c(e+" .timeglider-filter-include").val();p=c(e+" .timeglider-filter-exclude").val();h.setFilters({origin:"clude",include:n,exclude:p});c(e).toggleClass("timeglider-menu-shown")});i.click(function(){c(e).toggleClass("timeglider-menu-hidden")});l.click(function(){h.setFilters({origin:"clude",include:"",exclude:""});c(e+" .timeglider-filter-include").val("");c(e+" .timeglider-filter-exclude").val("");c(e).toggleClass("timeglider-menu-shown")})}c(e).toggleClass("timeglider-menu-hidden").css("z-index",
a.ztop++).position({my:"right bottom",at:"right top",of:d,offset:"-8, -12"})})},clearTicks:function(){this.tickNum=this.leftside=0;c(l).css("left",0).html("<div class='timeglider-handle'></div>")},castTicks:function(){this.clearTicks();h.getZoomLevel();var a=h.getFocusDate(),d=h.getZoomInfo().width,d=Math.ceil(this.dimensions.container.width/d)+4,c="l";h.setTicksReady(!1);this.addTick({type:"init",focus_date:a});for(a=1;a<=d;a+=1)this.addTick({type:c}),c="l"==c?"r":"l";h.setTicksReady(!0)},addTick:function(a){var d=
0,e=0,g=e=0,i=0,n=0,p="",n={},g={},q={},s={},n={},q=h.getZoomInfo().unit,s=h.getZoomInfo().width,i=h.getFocusDate(),g=parseInt(this.dimensions.tick.top),i=h.addToTicksArray({type:a.type,unit:q},i),f="",A=0,p="";if("mo"==q)n=w.getMonthAdj(i,s),s=n.width,d=n.days;this.tickNum++;"init"==a.type?(n=this.tickOffsetFromDate(h.getZoomInfo(),h.getFocusDate(),s),this.leftside=e=Math.ceil(this.dimensions.container.centerx+n),this.rightside=e+s):"l"==a.type?this.leftside=e=Math.floor(this.leftside-s):"r"==a.type&&
(e=Math.floor(this.rightside),this.rightside+=s);h.getTickBySerial(i).width=s;h.getTickBySerial(i).left=e;p=this._views.PLACE+"_"+q+"_"+i+"-"+this.tickNum;n=c("<div class='timeglider-tick' id='"+p+"'><div class='timeglider-tick-label' id='label'></div></div>").appendTo(l);n.css({width:s,left:e,top:g});g=this.getTickMarksInfo({unit:q,width:s});g=d||g.tperu;e=s/g;if(5<e){for(var a=Raphael(p,s,30),I="",d=0;d<g;++d)p=d*e,I+="M"+p+" 20 L"+p+" 30","da"==q&&16<e&&(p=this.getHourLabelFromHour(A,e),f+="<div class='timeglider-tick-hour-label' style='width:"+
(e-4)+"px'>"+p+"</div>",A++);a.path(I).attr({stroke:"#333","stroke-width":1})}"da"==q&&32<e&&n.append("<div style='position:absolute;top:14px;left:0'>"+f+"</div>");q={unit:q,width:s,serial:i};s=this.getDateLabelForTick(q);n.children("#label").text(s);return q},getHourLabelFromHour:function(a,d){var c="",c=c="",c=12<a?a-12:a;0==c&&(c=12);return c+(60<d?":00":"")+(11<a?" pm":" am")},getTickMarksInfo:function(a){switch(a.unit){case "da":a=24;break;case "mo":a=30;break;case "ye":a=12;break;default:a=
10}return{tperu:a}},getDateLabelForTick:function(a){var d=a.serial,c=a.width;switch(a.unit){case "bill":return 0==d?"1":0<d?d+" billion":d+" b.y. bce";case "hundredmill":return 0==d?"1":0<d?d+"00 million":d+"00 m.y. bce";case "tenmill":return 0==d?"1":0<d?d+"0 million":d+"0 m.y. bce";case "mill":return 0==d?"1":0<d?d+" million":d+" m.y. bce";case "hundredthou":return 0==d?"1":0<d?d+"00,000":d+"00,000 bce";case "tenthou":return 0==d?"1":0<d?d+"0,000":d+"0,000 bce";case "thou":return 0==d?"1("+d+")":
0<d?d+"000":d+"000 bce";case "ce":return 0==d?"1("+d+")":0<d?d+"00":d+"00 bce";case "de":return 10*(d-1)+"s";case "ye":return d;case "mo":return a=w.getDateFromMonthNum(d),120>c?w.monthNamesAbbr[a.mo]+" "+a.ye:w.monthNames[a.mo]+", "+a.ye;case "da":return a=new w(w.getDateFromRD(d)),120>c?w.monthNamesAbbr[a.mo]+" "+a.da+", "+a.ye:w.monthNames[a.mo]+" "+a.da+", "+a.ye;default:return a.unit+":"+d+":"+c}},tickHangies:function(){var a=c(l).position().left,d=this.rightside+a-this.dimensions.container.width;
-100<this.leftside+a?(a=this.addTick({type:"l"}),this.appendTimelines(a)):100>d&&(a=this.addTick({type:"r"}),this.appendTimelines(a))},tickOffsetFromDate:function(a,d,c){switch(a.unit){case "da":d=d.ho/24+d.mi/1440;c*=d;break;case "mo":a=w.getMonthDays(d.mo,d.ye);d=(d.da-1)/a+d.ho/(24*a)+d.mi/(1440*a);c*=d;break;case "ye":d=(30*(d.mo-1)+d.da)/365;c*=d;break;case "de":d=d.ye%10/10+d.mo/120;c*=d;break;case "ce":d=d.ye%100/100+d.mo/1200;c*=d;break;case "thou":d=d.ye%1E3/1E3;c*=d;break;case "tenthou":d=
d.ye%1E4/1E4;c*=d;break;case "hundredthou":d=d.ye%1E5/1E5;c*=d;break;default:c=0}return-1*c},resetTicksHandle:function(){c(this._views.HANDLE).offset({left:c(g).offset().left})},easeOutTicks:function(){5<Math.abs(this.dragSpeed)&&debug.trace("ticks stopped!","note")},getTimelineEventsByTick:function(a){var d=a.tick.unit,c=a.tick.serial,a=a.timeline.dateHash;return a[d][c]&&0<a[d][c].length?a[d][c]:0},setTimelineProp:function(a,d,c){h.timelinePool[a][d]=c},getTimelineProp:function(a,d){return h.timelinePool[a][d]},
passesFilters:function(a,d){var e=!0,g="",i=[],n,g="",i=[];if(d<a.low_threshold||d>a.high_threshold)return!1;if(g=h.filters.include){i=g.split(",");e=!1;for(n=0;n<i.length;n++)g=RegExp(c.trim(i[n]),"i"),a.tags.match(g)&&(e=!0)}if(g=h.filters.exclude){i=g.split(",");for(n=0;n<i.length;n++)g=RegExp(c.trim(i[n]),"i"),a.tags.match(g)&&(e=!1)}g=a.icon;0<h.filters.legend.length&&-1==c.inArray(g,h.filters.legend)&&(e=!1);return e},freshTimelines:function(){var a,d,e,i,n=h.activeTimelines,p=h.ticksArray,
q="",s,w=this;d="";var f=w.dimensions.container.centerx,A=w.dimensions.container.width,I=h.getFocusDate().sec,r=h.getZoomInfo().spp;h.getZoomInfo();d=[];var y=[],A=I-Math.floor(r*(A/2));d="";for(var j,C=0,B=w.dimensions.container.height,u=C=0;u<n.length;u++){a=h.timelinePool[n[u]];j=a.display;C=a.top?parseInt(a.top.replace("px","")):B-120;d=0<a.legend.length?"<span class='tg-timeline-legend-bt'>legend</span>":"";$tl=c("<div class='tg-timeline-envelope' id='"+a.id+"'><div class='titleBar'><div class='timeline-title'>"+
a.title+"<div class='tg-timeline-env-buttons'><span class='timeline-info'>info</span>"+d+"</div></div></div></div>").appendTo(l);$tl.draggable({axis:"y",handle:".titleBar",stop:function(){w.setTimelineProp(a.id,"top",c(this).css("top"));h.refresh()}}).css("top",C);d=$tl.height();c(g+" .tg-timeline-envelope#"+a.id+" .titleBar .expand-collapse").click(function(){w.expandCollapseTimeline(a.id)});c(g+" .tg-timeline-envelope#"+a.id+" .titleBar .timeline-info").click(function(){w.timelineModal(a.id)});
c(g+" .tg-timeline-envelope#"+a.id+" .titleBar .tg-timeline-legend-bt").click(function(){w.legendModal(a.id)});s=$tl.children(".titleBar");e=f+(a.bounds.first-I)/r;i=f+(a.bounds.last-I)/r;s.css({top:d,left:e,width:i-e});if("expanded"==j)a.borg=q=new timeglider.TG_Org;for(e=0;e<p.length;e++)d=this.getTimelineEventsByTick({tick:p[e],timeline:a}),c.merge(y,d);for(e=0;e<a.spans.length;e++)d=a.spans[e],d.start<A&&d.end>A&&-1==c.inArray(d.id,y)&&y.unshift(d.id);d=this.compileTickEventsAsHtml(a,y,0,"sweep");
C=a.hasImagesAbove?C-56:C;if("expanded"==j)d=q.getHTML("sweep",C),a.borg=q.getBorg();"undefined"!=d&&$tl.append(d);this.registerEventImages($tl)}w.registerTitles()},appendTimelines:function(a){for(var d=h.activeTimelines,e,g="",i=0;i<d.length;i++)e=h.timelinePool[d[i]],idArr=this.getTimelineEventsByTick({tick:a,timeline:e}),g=this.compileTickEventsAsHtml(e,idArr,a.serial,"append"),"expanded"==e.display&&(g=e.borg.getHTML(a.serial,e.top)),e=c(".tg-timeline-envelope#"+e.id).append(g),this.registerEventImages(e)},
compileTickEventsAsHtml:function(a,d,c,g){var i;i=0;var n=this.dimensions.container.centerx,l=a.display,p=$tl.height();stuff="";foSec=h.startSec;spp=h.getZoomInfo().spp;zl=h.getZoomInfo().level;buffer=20;borg=a.borg;block_arg="sweep";"append"==g&&(block_arg=c);for(c=0;c<d.length;c++)if(ev=h.eventPool["ev_"+d[c]],!0===this.passesFilters(ev,zl))if(i=n+(ev.startdateObj.sec-foSec)/spp,"expanded"==l){impq=!1!==a.size_importance?this.scaleToImportance(ev.importance,zl):1;ev.width=ev.titleWidth*impq+buffer;
ev.fontsize=this.basicFontSize*impq;ev.left=i;ev.spanwidth=0;if(!0==ev.span&&(ev.spanwidth=(ev.enddateObj.sec-ev.startdateObj.sec)/spp,ev.spanwidth>ev.width))ev.width=ev.spanwidth;i=0;if(ev.image&&"layout"===ev.image.display_class)i=ev.image.height+2,ev.width=ev.image.width>ev.width?ev.image.width:ev.width;ev.height=Math.ceil(ev.fontsize)+i;ev.top=p-ev.height;borg.addBlock(ev,block_arg)}else"collapsed"==l&&(stuff+="<div id='ev_"+ev.id+"' class='timeglider-event-collapsed' style='top:"+(p-2)+"px;left:"+
i+"px'></div>");return"collapsed"==l?stuff:""},registerEventImages:function(a){c(".timeglider-event-image-bar").each(function(){c(this).position({my:"top",at:"bottom",of:a,offset:"0, 0"}).css("left",0)});c(".timeglider-event-image-above").each(function(){c(this).position({my:"top",at:"top",of:c(g),offset:"0, 12"}).css("left",0)})},expandCollapseTimeline:function(a){a=h.timelinePool[a];a.display="expanded"==a.display?"collapsed":"expanded";h.refresh()},timelineModal:function(a){c("#tl_"+a+"_modal").remove();
var d=h.timelinePool[a];c.tmpl(this._templates.timeline_modal,{title:d.title,description:d.description,id:a}).appendTo(g).css("z-index",this.ztop++).position({my:"left top",at:"left top",of:this._views.CONTAINER,offset:"32, 32",collision:"fit fit"}).draggable({stack:".timeglider-modal"})},createEventLinksMenu:function(a,d){if(!a)return"";var c="",g=0,h="",i="";"full"==d&&(c+="<li><h4>links</h4></li>");if("string"==typeof a)c="<li><a href='"+a+"' target='_blank'>link</a></li>";else if("object"==typeof a)for(g=
0;g<a.length;g++)h=a[g].url,i=a[g].label,c+="<li><a href='"+h+"' target='_blank'>"+i+"</a></li>";return c},eventModal:function(a){c("#ev_"+a+"_modal").remove();var d=this,e=s.event_modal.type,i=c("#"+a),n=d._templates.event_modal;ev=h.eventPool[a];ev_img=ev.image&&ev.image.src?"<img src='"+ev.image.src+"'>":"";ev_img_src=ev.image&&ev.image.src?ev.image.src:"";links=this.createEventLinksMenu(ev.link,e);ev_descr="default"==e?ev_img+ev.description:ev.description;templ_obj={title:ev.title,description:ev_descr,
id:a,startdate:ev.startdateObj.format("D",!0),links:links,image:ev_img_src,video:ev.video};if(ev.video)n=d._templates.event_modal_video,templ_obj.video=ev.video;a=c.tmpl(n,templ_obj);switch(e){case "full":a.appendTo(g).css({"z-index":d.ztop++}).position({my:"left top",at:"left top",of:g,offset:"0, 0",collision:"none none"});a.children(".full_modal_panel").css({width:d.dimensions.container.width-64+"px",height:d.dimensions.container.height-64+"px"});break;default:a.appendTo(l).css("z-index",d.ztop++).position({my:"right center",
at:"left center",of:i,offset:"-12, -1",collision:"flip fit"}).draggable().hover(function(){c(this).css("z-index",d.ztop++)})}},legendModal:function(a){var d=h.timelinePool[a].legend,e,i,n,l="";for(e=0;e<d.length;e++)i=s.icon_folder+d[e].icon,n=d[e].title,l+="<li><img src='"+i+"'>"+n+"</li>";a={id:a,legend_list:l};c(g+" .timeglider-legend").remove();c.tmpl(this._templates.legend_modal,a).appendTo(g).css("z-index",this.ztop++).toggleClass("timeglider-menu-hidden").position({my:"left top",at:"left top",
of:g,offset:"16, -4",collision:"none none"});c(g+" .timeglider-legend li").click(function(){c(this).parent().attr("id");var a=c(this).children("img").attr("src");c(this).toggleClass("tg-legend-icon-selected");h.setFilters({origin:"legend",icon:a})})},parseHTMLTable:function(a){var d={},e=+new Date,g=[];c("#"+a).find("tr").each(function(a){var h=c(this).children(),i;0===a?g=h.map(function(){return c(this).attr("class").replace(/^.*?\btg-(\S+)\b.*?$/,"$1")}).get():(i={},h.each(function(a){i[g[a]]=c(this).text()}),
d["prefix"+e++]=i)});return d}};i.zoomTree=[{},{unit:"da",width:35E3,level:1,label:"5 hours"},{unit:"da",width:17600,level:2,label:"7 hours"},{unit:"da",width:8800,level:3,label:"10 hours"},{unit:"da",width:4400,level:4,label:"12 hours"},{unit:"da",width:2200,level:5,label:"14 hours"},{unit:"da",width:1100,level:6,label:"17 hours"},{unit:"da",width:550,level:7,label:"22 hours"},{unit:"da",width:432,level:8,label:"1 DAY"},{unit:"da",width:343,level:9,label:"1.5 days"},{unit:"da",width:272,level:10,
label:"2 days"},{unit:"da",width:216,level:11,label:"2.5 days"},{unit:"da",width:171,level:12,label:"3 days"},{unit:"da",width:136,level:13,label:"3.5 days"},{unit:"da",width:108,level:14,label:"4 days"},{unit:"mo",width:2509,level:15,label:"6 days"},{unit:"mo",width:1945,level:16,label:"1 WEEK"},{unit:"mo",width:1508,level:17,label:"10 days"},{unit:"mo",width:1169,level:18,label:"2 weeks"},{unit:"mo",width:913,level:19,label:"2.5 weeks"},{unit:"mo",width:719,level:20,label:"3 weeks"},{unit:"mo",
width:566,level:21,label:"3.5 weeks"},{unit:"mo",width:453,level:22,label:"1 MONTH"},{unit:"mo",width:362,level:23,label:"5.5 weeks"},{unit:"mo",width:290,level:24,label:"7 weeks"},{unit:"mo",width:232,level:25,label:"2 months"},{unit:"mo",width:186,level:26,label:"2.5 months"},{unit:"mo",width:148,level:27,label:"3 months"},{unit:"mo",width:119,level:28,label:"4 months"},{unit:"mo",width:95,level:29,label:"5 months"},{unit:"mo",width:76,level:30,label:"6 months"},{unit:"ye",width:723,level:31,label:"9 months"},
{unit:"ye",width:573,level:32,label:"1 YEAR"},{unit:"ye",width:455,level:33,label:"1.25 years"},{unit:"ye",width:361,level:34,label:"1.5 years"},{unit:"ye",width:286,level:35,label:"2 years"},{unit:"ye",width:227,level:36,label:"2.5 years"},{unit:"ye",width:179,level:37,label:"3 years"},{unit:"ye",width:142,level:38,label:"4 years"},{unit:"ye",width:113,level:39,label:"5 years"},{unit:"ye",width:89,level:40,label:"6 years"},{unit:"de",width:705,level:41,label:"8 years"},{unit:"de",width:559,level:42,
label:"10 years"},{unit:"de",width:443,level:43,label:"13 years"},{unit:"de",width:302,level:44,label:"16 years"},{unit:"de",width:240,level:45,label:"20 years"},{unit:"de",width:190,level:46,label:"25 years"},{unit:"de",width:150,level:47,label:"30 years"},{unit:"de",width:120,level:48,label:"40 years"},{unit:"de",width:95,level:49,label:"50 years"},{unit:"de",width:76,level:50,label:"65 years"},{unit:"ce",width:600,level:51,label:"80 years"},{unit:"ce",width:480,level:52,label:"100 years"},{unit:"ce",
width:381,level:53,label:"130 years"},{unit:"ce",width:302,level:54,label:"160 years"},{unit:"ce",width:240,level:55,label:"200 years"},{unit:"ce",width:190,level:56,label:"250 years"},{unit:"ce",width:150,level:57,label:"300 years"},{unit:"ce",width:120,level:58,label:"400 years"},{unit:"ce",width:95,level:59,label:"500 years"},{unit:"ce",width:76,level:60,label:"600 years"},{unit:"thou",width:603,level:61,label:"1000 years"},{unit:"thou",width:478,level:62,label:"1200 years"},{unit:"thou",width:379,
level:63,label:"1800 years"},{unit:"thou",width:301,level:64,label:"160 years"},{unit:"thou",width:239,level:65,label:"xxx years"},{unit:"thou",width:190,level:66,label:"xxx years"},{unit:"thou",width:150,level:67,label:"xxx years"},{unit:"thou",width:120,level:68,label:"xxx years"},{unit:"thou",width:95,level:69,label:"8,000 years"},{unit:"thou",width:76,level:70,label:"10,000 years"},{unit:"tenthou",width:603,level:71,label:"15,000 years"},{unit:"tenthou",width:358,level:72,label:"20,000 years"},
{unit:"tenthou",width:213,level:73,label:"30,000 years"},{unit:"tenthou",width:126,level:74,label:"60,000 years"},{unit:"tenthou",width:76,level:75,label:"100,000 years"},{unit:"hundredthou",width:603,level:76,label:"180,000 years"},{unit:"hundredthou",width:358,level:77,label:"300,000 years"},{unit:"hundredthou",width:213,level:78,label:"500,000 years"},{unit:"hundredthou",width:126,level:79,label:"800,000 years"},{unit:"hundredthou",width:76,level:80,label:"1 million years"},{unit:"mill",width:603,
level:81,label:"1.2 million years"},{unit:"mill",width:358,level:82,label:"2 million years"},{unit:"mill",width:213,level:83,label:"3 million years"},{unit:"mill",width:126,level:84,label:"5 million years"},{unit:"mill",width:76,level:85,label:"10 million years"},{unit:"tenmill",width:603,level:86,label:"15 million years"},{unit:"tenmill",width:358,level:87,label:"30 million years"},{unit:"tenmill",width:213,level:88,label:"50 million years"},{unit:"tenmill",width:126,level:89,label:"80 million years"},
{unit:"tenmill",width:76,level:90,label:"100 million years"},{unit:"hundredmill",width:603,level:91,label:"120 million years"},{unit:"hundredmill",width:358,level:92,label:"200 million years"},{unit:"hundredmill",width:213,level:93,label:"300 million years"},{unit:"hundredmill",width:126,level:94,label:"500 million years"},{unit:"hundredmill",width:76,level:95,label:"1 billion years"},{unit:"bill",width:603,level:96,label:"15 million years"},{unit:"bill",width:358,level:97,label:"30 million years"},
{unit:"bill",width:213,level:98,label:"50 million years"},{unit:"bill",width:126,level:99,label:"80 million years"},{unit:"bill",width:76,level:100,label:"100 billion years"}];i.calculateSecPerPx=function(a){for(var d=1;d<a.length;d++){var c=a[d],g=0;switch(c.unit){case "da":g=86400;break;case "mo":g=2419200;break;case "ye":g=31536E3;break;case "de":g=31536E4;break;case "ce":g=31536E5;break;case "thou":g=31536E6;break;case "tenthou":g=31536E7;break;case "hundredthou":g=31536E8;break;case "mill":g=
31536E9;break;case "tenmill":g=31536E10;break;case "hundredmill":g=31536E11;break;case "bill":g=31536E12}c.spp=g/parseInt(c.width)}}(i.zoomTree);i.getStringWidth=function(a){if(a)return c("#timeglider-measure-span").html(a).width()};String.prototype.removeWhitespace=function(){return this.replace(RegExp("\\n","g"),"")}})(timeglider);(function(i){var w={},q=i.TG_Date,h={},s=jQuery;i.TimelineCollection=Backbone.Collection.extend({model:timeglider.TG_Timeline});i.TG_Mediator=function(c){this.options=h=c;this._focusDate={};this._zoomInfo={};this._zoomLevel=1;this.ticksReady=!1;this.ticksArray=[];this.startSec=0;this.activeTimelines=[];this.max_zoom=h.max_zoom;this.min_zoom=h.min_zoom;this.fixed_zoom=this.max_zoom==this.min_zoom?!0:!1;this.gesturing=!1;this.gestureStartScale=this.gestureStartZoom=0;this.filters={include:"",exclude:"",
legend:[]};this.eventPool=[];this.timelinePool={};this.imagesToSize=this.imagesSized=0;this.timelineDataLoaded=!1;this.foo="bark";this.initial_timeline_id=h.initial_timeline_id||"";this.sole_timeline_id="";if(h.max_zoom===h.min_zoom)this.fixed_zoom=h.min_zoom;w=this};i.TG_Mediator.prototype={gotoDateZoom:function(c,h){var i=!1;this.setFocusDate(new q(c));h&&(i=this.setZoomLevel(h));(!h||!1==i)&&this.refresh()},zoom:function(c){this.setZoomLevel(this.getZoomLevel()+parseInt(c))},loadTimelineData:function(c){var h=
this;c?"object"===typeof c?h.parseData(c):"#"==c.substr(0,1)?(c=[h.getTableTimelineData(c)],h.parseData(c)):s.getJSON(c,function(c){h.parseData(c)}):(this.timelineDataLoaded=!0,this.setZoomLevel(Math.floor((this.max_zoom+this.min_zoom)/2)),this.tryLoading())},getTableTimelineData:function(c){var h={},i=0,g=[],l,a,d="",e=s(c);h.id=c.substr(1);h.title=e.attr("title")||"untitled";h.description=e.attr("description")||"";h.focus_date=e.attr("focus_date")||q.getToday;h.initial_zoom=e.attr("initial_zoom")||
20;h.events=[];e.find("tr").each(function(c){var e=s(this).children(),q;0===c?g=e.map(function(){return s(this).attr("class").replace(/^.*?\btg-(\S+)\b.*?$/,"$1")}).get():(q={},e.each(function(d){l=g[d];a=s(this).text();q[l]=a}),d="ev_"+i++,q.id=d,h.events.push(q))});e.css("display","none");return h},parseData:function(c){for(var h=0,i=c.length,g={},g={},l=0;l<i;l++)g=c[l],g.mediator=this,g=(new timeglider.TG_Timeline(g)).toJSON(),0<g.id.length&&(h++,this.swallowTimeline(g));0===h?alert("ERROR loading data: Check JSON with jsonLint"):
(this.timelineDataLoaded=!0,this.tryLoading())},tryLoading:function(){var c=!0==this.timelineDataLoaded;this.imagesSized==this.imagesToSize&&c&&(this.setInitialTimelines(),s.publish("mediator.timelineDataLoaded"))},swallowTimeline:function(c){this.sole_timeline_id=c.id;this.timelinePool[c.id]=c;s.publish("mediator.timelineListChangeSignal")},setInitialTimelines:function(){var c=this.initial_timeline_id||this.sole_timeline_id;c&&setTimeout(function(){w.toggleTimeline(c)},1E3)},refresh:function(){this.startSec=
this._focusDate.sec;s.publish("mediator.refreshSignal")},setTicksReady:function(c){this.ticksReady=c;!0===c&&s.publish("mediator.ticksReadySignal")},getFocusDate:function(){return this._focusDate},setFocusDate:function(c){if(c!=this._focusDate)this._focusDate=c},getZoomLevel:function(){return parseInt(this._zoomLevel)},setZoomLevel:function(c){return c<=this.max_zoom&&c>=this.min_zoom&&(this.startSec=this._focusDate.sec,c!=this._zoomLevel)?(this._zoomLevel=c,this._zoomInfo=timeglider.zoomTree[c],
s.publish("mediator.zoomLevelChange"),!0):!1},getZoomInfo:function(){return this._zoomInfo},setFilters:function(c){switch(c.origin){case "clude":this.filters.include=c.include;this.filters.exclude=c.exclude;break;case "legend":var h=c.icon;"all"==h?(this.filters.legend=[],s.publish("mediator.legendAll")):-1==s.inArray(h,this.filters.legend)?this.filters.legend.push(h):(c=[],c=s.grep(this.filters.legend,function(c){return c!=h}),this.filters.legend=c)}s.publish("mediator.filtersChange");this.refresh()},
getTicksOffset:function(){return this._ticksOffset},setTicksOffset:function(c){this._ticksOffset=c;s.publish("mediator.ticksOffsetChange")},getTickBySerial:function(c){for(var h=this.ticksArray,i=h.length,g=0;g<i;g++){var l=h[g];if(l.serial==c)return l}return!1},addToTicksArray:function(c,h){"init"==c.type?(c.serial=q.getTimeUnitSerial(h,c.unit),this.ticksArray=[c]):"l"==c.type?(c.serial=this.ticksArray[0].serial-1,this.ticksArray.unshift(c)):(c.serial=this.ticksArray[this.ticksArray.length-1].serial+
1,this.ticksArray.push(c));s.publish("mediator.ticksArrayChange");return c.serial},toggleTimeline:function(c){var h=this.timelinePool[c],i=s.inArray(c,this.activeTimelines);-1==i?(this.activeTimelines.push(c),this.setFocusDate(new q(h.focus_date)),this.setZoomLevel(h.initial_zoom)):this.activeTimelines.splice(i,1);this.refresh();s.publish("mediator.activeTimelinesChange")},reportImageSize:function(c){var h=w.eventPool["ev_"+c.id];c.error?(h.image={},debug.log("WHOOPS: MISSING IMAGE: "+c.src)):(h.image.width=
c.width,h.image.height=c.height);this.imagesSized++;this.imagesSized==this.imagesToSize&&this.tryLoading()}};i.getLowHigh=function(c){var h,i,g=parseFloat(c[0]),l=g;for(h=0;h<c.length;h++)i=parseFloat(c[h]),i<l&&(l=i),i>g&&(g=i);return{high:g,low:l}};i.validateOptions=function(c){this.optionsMaster={initial_focus:{type:"date"},editor:{type:"string"},backgroundColor:{type:"color"},backgroundImage:{type:"color"},min_zoom:{type:"number",min:1,max:100},max_zoom:{type:"number",min:1,max:100},initial_zoom:{type:"number",
min:1,max:100},show_centerline:{type:"boolean"},display_zoom_level:{type:"boolean"},data_source:{type:"url"},basic_fontsize:{type:"number",min:9,max:100},mouse_wheel:{type:"string",possible:["zoom","pan"]},initial_timeline_id:{type:"string"},icon_folder:{type:"string"},show_footer:{type:"boolean"},display_zoom_level:{type:"boolean"},event_modal:{type:"object"}};var h=this,i="";s.each(c,function(c,l){if(h.optionsMaster[c])switch(h.optionsMaster[c].type){case "string":"string"!=typeof l&&(i+=c+" needs to be a string.\n");
h.optionsMaster[c].possible&&-1==s.inArray(l,h.optionsMaster[c].possible)&&(i+=c+" must be: "+h.optionsMaster[c].possible.join(" or "));break;case "number":"number"!=typeof l&&(i+=l+" needs to be a number.\n");h.optionsMaster[c].min&&l<h.optionsMaster[c].min&&(i+=c+" must be greater than or equal to "+h.optionsMaster[c].min+"\n");h.optionsMaster[c].max&&l>h.optionsMaster[c].max&&(i+=c+" must be less than or equal to "+h.optionsMaster[c].max+"\n");break;case "boolean":"boolean"!=typeof l&&(i+=l+" needs to be a number.\n")}});
return i}})(timeglider);(function(i){var w,q,h=timeglider,s=timeglider.TG_Date;i.widget("timeglider.timeline",{options:{initial_focus:h.TG_Date.getToday(),editor:"none",min_zoom:1,max_zoom:100,show_centerline:!0,data_source:"",culture:"en",basic_fontsize:12,mouse_wheel:"zoom",initial_timeline_id:"",icon_folder:"js/timeglider/icons/",show_footer:!0,display_zoom_level:!0,event_modal:{href:"",type:"default"}},_create:function(){this._id=i(this.element).attr("id");this.element.html("<div class='timeglider-container'><div class='timeglider-loading'>loading</div><div class='timeglider-centerline'></div><div class='timeglider-truck' id='tg-truck'><div class='timeglider-ticks'><div class='timeglider-handle'></div></div></div><div class='timeglider-slider-container'><div class='timeglider-slider'></div><div class='timeglider-pan-buttons'><div class='timeglider-pan-left'></div><div class='timeglider-pan-right'></div></div></div><div class='timeglider-footer'><div class='timeglider-logo'></div><div class='timeglider-footer-button timeglider-list-bt'></div></div><div class='timeglider-event-hover-info'></div></div><span id='timeglider-measure-span'></span>")},
_init:function(){var c=timeglider.validateOptions(this.options);""==c?(h.TG_Date.setCulture(this.options.culture),q=new h.TG_Mediator(this.options),w=new h.TG_TimelineView(this,q),q.setFocusDate(new s(this.options.initial_focus)),q.loadTimelineData(this.options.data_source)):alert("Rats. There's a problem with your widget settings:"+c)},goTo:function(c,h){q.gotoDateZoom(c,h)},zoom:function(c){switch(c){case "in":c=-1;break;case "out":c=1}if(99<c||-99>c)return!1;q.zoom(c)},panButton:function(c,h){var i=
0;switch(h){case "left":i=30;break;case "right":i=-30;break;default:i=h}w.setPanButton(c,i)},destroy:function(){i.Widget.prototype.destroy.apply(this,arguments);i(this.element).html("")}})})(jQuery);
